(function(){var a="/ud/";window.UEDITOR_CONFIG={UEDITOR_HOME_URL:a,imageUrl:a+"imageUp",imagePath:a+"/i/attachments/",fileUrl:a+"fileUp",filePath:a+"/i/attachments/",toolbars:[["fullscreen","cleardoc","|","undo","redo","|","bold","italic","underline","strikethrough","removeformat","formatmatch","autotypeset","|","pasteplain","|","insertorderedlist","insertunorderedlist","selectall","|","indent","|","rowspacingtop","rowspacingbottom","lineheight","|","justifyleft","justifycenter","justifyright","justifyjustify","|","forecolor","fontfamily","fontsize","|","link","unlink","anchor","|","imagenone","imageleft","imageright","imagecenter","|","insertimage","|","spechars","|","preview","searchreplace"]],labelMap:{anchor:"",undo:""},lang:"en",charset:"utf-8",initialFrameWidth:680,initialFrameHeight:200};})();(function(){UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var c=window.baidu||{};window.baidu=c;window.UE=c.editor={};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE.version="1.2.5.0";var h=UE.dom={};var k=UE.browser=function(){var u=navigator.userAgent.toLowerCase(),s=window.opera,t={ie:!!window.ActiveXObject,opera:(!!s&&s.version),webkit:(u.indexOf(" applewebkit/")>-1),mac:(u.indexOf("macintosh")>-1),quirks:(document.compatMode=="BackCompat")};t.gecko=(navigator.product=="Gecko"&&!t.webkit&&!t.opera);var r=0;if(t.ie){r=parseFloat(u.match(/msie (\d+)/)[1]);t.ie9Compat=document.documentMode==9;t.ie8=!!document.documentMode;t.ie8Compat=document.documentMode==8;t.ie7Compat=((r==7&&!document.documentMode)||document.documentMode==7);t.ie6Compat=(r<7||t.quirks);}if(t.gecko){var v=u.match(/rv:([\d\.]+)/);if(v){v=v[1].split(".");r=v[0]*10000+(v[1]||0)*100+(v[2]||0)*1;}}if(/chrome\/(\d+\.\d)/i.test(u)){t.chrome=+RegExp["\x241"];}if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(u)&&!/chrome/i.test(u)){t.safari=+(RegExp["\x241"]||RegExp["\x242"]);}if(t.opera){r=parseFloat(s.version());}if(t.webkit){r=parseFloat(u.match(/ applewebkit\/(\d+)/)[1]);}t.version=r;t.isCompatible=!t.mobile&&((t.ie&&r>=6)||(t.gecko&&r>=10801)||(t.opera&&r>=9.5)||(t.air&&r>=1)||(t.webkit&&r>=522)||false);return t;}();var b=k.ie,o=k.webkit,d=k.gecko,e=k.opera;var p=UE.utils={each:function(w,v,u){if(w==null){return;}if(w.length===+w.length){for(var t=0,r=w.length;t<r;t++){if(v.call(u,w[t],t,w)===false){return false;}}}else{for(var s in w){if(w.hasOwnProperty(s)){if(v.call(u,w[s],s,w)===false){return false;}}}}},makeInstance:function(s){var r=new Function();r.prototype=s;s=new r;r.prototype=null;return s;},extend:function(v,w,r){if(w){for(var u in w){if(!r||!v.hasOwnProperty(u)){v[u]=w[u];}}}return v;},inherits:function(u,s){var r=u.prototype,t=p.makeInstance(s.prototype);p.extend(t,r,true);u.prototype=t;return(t.constructor=u);},bind:function(s,r){return function(){return s.apply(r,arguments);};},defer:function(s,r,t){var u;return function(){if(t){clearTimeout(u);}u=setTimeout(s,r);};},indexOf:function(u,s,t){var r=-1;t=this.isNumber(t)?t:0;this.each(u,function(w,x){if(x>=t&&w===s){r=x;return false;}});return r;},removeItem:function(u,t){for(var s=0,r=u.length;s<r;s++){if(u[s]===t){u.splice(s,1);s--;}}},trim:function(r){return r.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"");},listToMap:function(t){if(!t){return{};}t=p.isArray(t)?t:t.split(",");for(var s=0,r,u={};r=t[s++];){u[r.toUpperCase()]=u[r]=1;}return u;},unhtml:function(s,r){return s?s.replace(r||/[&<">]/g,function(t){return{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;"}[t];}):"";},html:function(r){return r?r.replace(/&((g|l|quo)t|amp);/g,function(s){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">"}[s];}):"";},cssStyleToDomStyle:function(){var s=document.createElement("div").style,r={"float":s.cssFloat!=undefined?"cssFloat":s.styleFloat!=undefined?"styleFloat":"float"};return function(t){return r[t]||(r[t]=t.toLowerCase().replace(/-./g,function(u){return u.charAt(1).toUpperCase();}));};}(),loadFile:function(){var r=[];function s(x,w){try{for(var u=0,t;t=r[u++];){if(t.doc===x&&t.url==(w.src||w.href)){return t;}}}catch(v){return null;}}return function(z,y,v){var w=s(z,y);if(w){if(w.ready){v&&v();}else{w.funs.push(v);}return;}r.push({doc:z,url:y.src||y.href,funs:[v]});if(!z.body){var u=[];for(var x in y){if(x=="tag"){continue;}u.push(x+'="'+y[x]+'"');}z.write("<"+y.tag+" "+u.join(" ")+" ></"+y.tag+">");return;}if(y.id&&z.getElementById(y.id)){return;}var t=z.createElement(y.tag);delete y.tag;for(var x in y){t.setAttribute(x,y[x]);}t.onload=t.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){w=s(z,y);if(w.funs.length>0){w.ready=1;for(var A;A=w.funs.pop();){A();}}t.onload=t.onreadystatechange=null;}};t.onerror=function(){throw Error("The load "+(y.href||y.src)+" fails,check the url settings of file editor_config.js ");};z.getElementsByTagName("head")[0].appendChild(t);};}(),isEmptyObject:function(s){if(s==null){return true;}if(this.isArray(s)||this.isString(s)){return s.length===0;}for(var r in s){if(s.hasOwnProperty(r)){return false;}}return true;},fixColor:function(s,u){if(/color/i.test(s)&&/rgba?/.test(u)){var v=u.split(",");if(v.length>3){return"";}u="#";for(var t=0,r;r=v[t++];){r=parseInt(r.replace(/[^\d]/gi,""),10).toString(16);u+=r.length==1?"0"+r:r;}u=u.toUpperCase();}return u;},optCss:function(v){var u,t,r;v=v.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(z,x,w,y){if(y.split(" ").length==1){switch(x){case"padding":!u&&(u={});u[w]=y;return"";case"margin":!t&&(t={});t[w]=y;return"";case"border":return y=="initial"?"":z;}}return z;});function s(C,y){if(!C){return"";}var z=C.top,w=C.bottom,x=C.left,A=C.right,D="";if(!z||!x||!w||!A){for(var B in C){D+=";"+y+"-"+B+":"+C[B]+";";}}else{D+=";"+y+":"+(z==w&&w==x&&x==A?z:z==w&&x==A?(z+" "+x):x==A?(z+" "+x+" "+w):(z+" "+A+" "+w+" "+x))+";";}return D;}v+=s(u,"padding")+s(t,"margin");return v.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(x,w){return w?w+";;":";";});},clone:function(t,u){var s;u=u||{};for(var r in t){if(t.hasOwnProperty(r)){s=t[r];if(typeof s=="object"){u[r]=p.isArray(s)?[]:{};p.clone(t[r],u[r]);}else{u[r]=s;}}}return u;},transUnitToPx:function(s){if(!/(pt|cm)/.test(s)){return s;}var r;s.replace(/([\d.]+)(\w+)/,function(x,t,w){s=t;r=w;});switch(r){case"cm":s=parseFloat(s)*25;break;case"pt":s=Math.round(parseFloat(s)*96/72);}return s+(s?"px":"");},domReady:function(){var r=[];function s(u){u.isReady=true;for(var t;t=r.pop();t()){}}return function(t,v){v=v||window;var u=v.document;t&&r.push(t);if(u.readyState==="complete"){s(u);}else{u.isReady&&s(u);if(k.ie){(function(){if(u.isReady){return;}try{u.documentElement.doScroll("left");}catch(w){setTimeout(arguments.callee,0);return;}s(u);})();v.attachEvent("onload",function(){s(u);});}else{u.addEventListener("DOMContentLoaded",function(){u.removeEventListener("DOMContentLoaded",arguments.callee,false);s(u);},false);v.addEventListener("load",function(){s(u);},false);}}};}(),cssRule:k.ie?function(u,v,w){var r,t;w=w||document;if(w.indexList){r=w.indexList;}else{r=w.indexList={};}var s;if(!r[u]){if(v===undefined){return"";}s=w.createStyleSheet("",t=w.styleSheets.length);r[u]=t;}else{s=w.styleSheets[r[u]];}if(v===undefined){return s.cssText;}s.cssText=v||"";}:function(s,t,v){v=v||document;var r=v.getElementsByTagName("head")[0],u;if(!(u=v.getElementById(s))){if(t===undefined){return"";}u=v.createElement("style");u.id=s;r.appendChild(u);}if(t===undefined){return u.innerHTML;}if(t!==""){u.innerHTML=t;}else{r.removeChild(u);}}};p.each(["String","Function","Array","Number","RegExp"],function(r){UE.utils["is"+r]=function(s){return Object.prototype.toString.apply(s)=="[object "+r+"]";};});var j=UE.EventBase=function(){};j.prototype={addListener:function(s,u){s=p.trim(s).split(" ");for(var r=0,t;t=s[r++];){m(this,t,true).push(u);}},removeListener:function(s,u){s=p.trim(s).split(" ");for(var r=0,t;t=s[r++];){p.removeItem(m(this,t)||[],u);}},fireEvent:function(w){w=p.trim(w).split(" ");for(var v=0,y;y=w[v++];){var x=m(this,y),z,u,s;if(x){s=x.length;while(s--){if(!x[s]){continue;}u=x[s].apply(this,arguments);if(u===true){return u;}if(u!==undefined){z=u;}}}if(u=this["on"+y.toLowerCase()]){z=u.apply(this,arguments);}}return z;}};function m(u,s,t){var r;s=s.toLowerCase();return((r=(u.__allListeners||t&&(u.__allListeners={})))&&(r[s]||t&&(r[s]=[])));}var a=h.dtd=(function(){function an(B){for(var A in B){B[A.toUpperCase()]=B[A];}return B;}function r(E){var B=arguments;for(var D=1;D<B.length;D++){var A=B[D];for(var C in A){if(!E.hasOwnProperty(C)){E[C]=A[C];}}}return E;}var am=an({isindex:1,fieldset:1}),al=an({input:1,button:1,select:1,textarea:1,label:1}),ak=r(an({a:1}),al),aj=r({iframe:1},ak),ai=an({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),ah=an({ins:1,del:1,script:1,style:1}),ag=r(an({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),ah),af=r(an({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),ag),ae=r(an({p:1}),af),ad=r(an({iframe:1}),af,al),ab=an({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1}),aa=r(an({a:0}),ad),Y=an({tr:1}),W=an({"#":1}),z=r(an({param:1}),ab),y=r(an({form:1}),am,aj,ai,ae),x=an({li:1}),w=an({style:1,script:1}),v=an({base:1,link:1,meta:1,title:1}),u=r(v,w),t=an({head:1,body:1}),s=an({html:1});var Z=an({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),ac=an({area:1,base:1,br:1,col:1,hr:1,img:1,input:1,link:1,meta:1,param:1,embed:1});return an({$nonBodyContent:r(s,t,v),$block:Z,$inline:aa,$body:r(an({script:1,style:1}),Z),$cdata:an({script:1,style:1}),$empty:ac,$nonChild:an({iframe:1,textarea:1}),$listItem:an({dd:1,dt:1,li:1}),$list:an({ul:1,ol:1,dl:1}),$isNotEmpty:an({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:an({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:an({p:1,div:1}),$tableContent:an({caption:1,col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:an({pre:1,script:1,style:1,textarea:1}),html:t,head:u,style:W,script:W,body:y,base:{},link:{},meta:{},title:W,col:{},tr:an({td:1,th:1}),img:{},embed:{},colgroup:an({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:y,td:y,br:{},th:y,center:y,kbd:aa,button:r(ae,ai),basefont:{},h5:aa,h4:aa,samp:aa,h6:aa,ol:x,h1:aa,h3:aa,option:W,h2:aa,form:r(am,aj,ai,ae),select:an({optgroup:1,option:1}),font:aa,ins:aa,menu:x,abbr:aa,label:aa,table:an({thead:1,col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:aa,tfoot:Y,cite:aa,li:y,input:{},iframe:y,strong:aa,textarea:W,noframes:y,big:aa,small:aa,span:an({"#":1,br:1}),hr:aa,dt:aa,sub:aa,optgroup:an({option:1}),param:{},bdo:aa,"var":aa,div:y,object:z,sup:aa,dd:y,strike:aa,area:{},dir:x,map:r(an({area:1,form:1,p:1}),am,ah,ai),applet:z,dl:an({dt:1,dd:1}),del:aa,isindex:{},fieldset:r(an({legend:1}),ab),thead:Y,ul:x,acronym:aa,b:aa,a:r(an({a:1}),ad),blockquote:r(an({td:1,tr:1,tbody:1,li:1}),y),caption:aa,i:aa,u:aa,tbody:Y,s:aa,address:r(aj,ae),tt:aa,legend:aa,q:aa,pre:r(ag,ak),p:r(an({a:1}),aa),em:aa,dfn:aa});})();function g(x,y,s,r,v,w){var u=r&&x[y],t;!u&&(u=x[s]);while(!u&&(t=(t||x).parentNode)){if(t.tagName=="BODY"||w&&!w(t)){return null;}u=t[s];}if(u&&v&&!v(u)){return g(u,y,s,false,v);}return u;}var n=b&&k.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},l=p.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group","table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]);var f=h.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:b&&k.version=="6"?"\ufeff":"\u200B",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(w,u){if(w===u){return 0;}var s,v=[w],t=[u];s=w;while(s=s.parentNode){if(s===u){return 10;}v.push(s);}s=u;while(s=s.parentNode){if(s===w){return 20;}t.push(s);}v.reverse();t.reverse();if(v[0]!==t[0]){return 1;}var r=-1;while(r++,v[r]===t[r]){}w=v[r];u=t[r];while(w=w.nextSibling){if(w===u){return 4;}}return 2;},getNodeIndex:function(t,s){var u=t,r=0;while(u=u.previousSibling){if(s&&u.nodeType==3){if(u.nodeType!=u.nextSibling.nodeType){r++;}continue;}r++;}return r;},inDoc:function(r,s){return f.getPosition(r,s)==10;},findParent:function(s,t,r){if(s&&!f.isBody(s)){s=r?s:s.parentNode;while(s){if(!t||t(s)||f.isBody(s)){return t&&!t(s)&&f.isBody(s)?null:s;}s=s.parentNode;}}return null;},findParentByTagName:function(t,r,s,u){r=p.listToMap(p.isArray(r)?r:[r]);return f.findParent(t,function(v){return r[v.tagName]&&!(u&&u(v));},s);},findParents:function(u,t,v,s){var r=t&&(v&&v(u)||!v)?[u]:[];while(u=f.findParent(u,v)){r.push(u);}return s?r:r.reverse();},insertAfter:function(s,r){return s.parentNode.insertBefore(r,s.nextSibling);},remove:function(s,t){var r=s.parentNode,u;if(r){if(t&&s.hasChildNodes()){while(u=s.firstChild){r.insertBefore(u,s);}}r.removeChild(s);}return s;},getNextDomNode:function(t,r,u,s){return g(t,"firstChild","nextSibling",r,u,s);},isBookmarkNode:function(r){return r.nodeType==1&&r.id&&/^_baidu_bookmark_/i.test(r.id);},getWindow:function(r){var s=r.ownerDocument||r;return s.defaultView||s.parentWindow;},getCommonAncestor:function(w,u){if(w===u){return w;}var v=[w],t=[u],s=w,r=-1;while(s=s.parentNode){if(s===u){return s;}v.push(s);}s=u;while(s=s.parentNode){if(s===w){return s;}t.push(s);}v.reverse();t.reverse();while(r++,v[r]===t[r]){}return r==0?null:v[r-1];},clearEmptySibling:function(u,s,t){function r(x,v){var w;while(x&&!f.isBookmarkNode(x)&&(f.isEmptyInlineElement(x)||!new RegExp("[^\t\n\r"+f.fillChar+"]").test(x.nodeValue))){w=x[v];f.remove(x);x=w;}}!s&&r(u.nextSibling,"nextSibling");!t&&r(u.previousSibling,"previousSibling");},split:function(u,w){var v=u.ownerDocument;if(k.ie&&w==u.nodeValue.length){var t=v.createTextNode("");return f.insertAfter(u,t);}var r=u.splitText(w);if(k.ie8){var s=v.createTextNode("");f.insertAfter(r,s);f.remove(s);}return r;},isWhitespace:function(r){return !new RegExp("[^ \t\n\r"+f.fillChar+"]").test(r.nodeValue);},getXY:function(s){var r=0,t=0;while(s.offsetParent){t+=s.offsetTop;r+=s.offsetLeft;s=s.offsetParent;}return{x:r,y:t};},on:function(v,x,w){var u=p.isArray(x)?x:[x],r=u.length;if(r){while(r--){x=u[r];if(v.addEventListener){v.addEventListener(x,w,false);}else{if(!w._d){w._d={els:[]};}var t=x+w.toString(),s=p.indexOf(w._d.els,v);if(!w._d[t]||s==-1){if(s==-1){w._d.els.push(v);}if(!w._d[t]){w._d[t]=function(y){return w.call(y.srcElement,y||window.event);};}v.attachEvent("on"+x,w._d[t]);}}}}v=null;},un:function(v,x,w){var u=p.isArray(x)?x:[x],r=u.length;if(r){while(r--){x=u[r];if(v.removeEventListener){v.removeEventListener(x,w,false);}else{var t=x+w.toString();try{v.detachEvent("on"+x,w._d?w._d[t]:w);}catch(y){}if(w._d&&w._d[t]){var s=p.indexOf(w._d.els,v);if(s!=-1){w._d.els.splice(s,1);}w._d.els.length==0&&delete w._d[t];}}}}},isSameElement:function(u,t){if(u.tagName!=t.tagName){return false;}var v=u.attributes,x=t.attributes;if(!b&&v.length!=x.length){return false;}var r,z,y=0,s=0;for(var w=0;r=v[w++];){if(r.nodeName=="style"){if(r.specified){y++;}if(f.isSameStyle(u,t)){continue;}else{return false;}}if(b){if(r.specified){y++;z=x.getNamedItem(r.nodeName);}else{continue;}}else{z=t.attributes[r.nodeName];}if(!z.specified||r.nodeValue!=z.nodeValue){return false;}}if(b){for(w=0;z=x[w++];){if(z.specified){s++;}}if(y!=s){return false;}}return true;},isSameStyle:function(x,v){var s=x.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),r=v.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(k.opera){s=x.style;r=v.style;if(s.length!=r.length){return false;}for(var w in s){if(/^(\d+|csstext)$/i.test(w)){continue;}if(s[w]!=r[w]){return false;}}return true;}if(!s||!r){return s==r;}s=s.split(";");r=r.split(";");if(s.length!=r.length){return false;}for(var u=0,t;t=s[u++];){if(p.indexOf(r,t)==-1){return false;}}return true;},isBlockElm:function(r){return r.nodeType==1&&(a.$block[r.tagName]||l[f.getComputedStyle(r,"display")])&&!a.$nonChild[r.tagName];},isBody:function(r){return r&&r.nodeType==1&&r.tagName.toLowerCase()=="body";},breakParent:function(v,t){var s,x=v,w=v,r,u;do{x=x.parentNode;if(r){s=x.cloneNode(false);s.appendChild(r);r=s;s=x.cloneNode(false);s.appendChild(u);u=s;}else{r=x.cloneNode(false);u=r.cloneNode(false);}while(s=w.previousSibling){r.insertBefore(s,r.firstChild);}while(s=w.nextSibling){u.appendChild(s);}w=x;}while(t!==x);s=t.parentNode;s.insertBefore(r,t);s.insertBefore(u,t);s.insertBefore(v,u);f.remove(t);return v;},isEmptyInlineElement:function(r){if(r.nodeType!=1||!a.$removeEmpty[r.tagName]){return 0;}r=r.firstChild;while(r){if(f.isBookmarkNode(r)){return 0;}if(r.nodeType==1&&!f.isEmptyInlineElement(r)||r.nodeType==3&&!f.isWhitespace(r)){return 0;}r=r.nextSibling;}return 1;},trimWhiteTextNode:function(s){function r(t){var u;while((u=s[t])&&u.nodeType==3&&f.isWhitespace(u)){s.removeChild(u);}}r("firstChild");r("lastChild");},mergeChild:function(u,t,y){var x=f.getElementsByTagName(u,u.tagName.toLowerCase());for(var w=0,A;A=x[w++];){if(!A.parentNode||f.isBookmarkNode(A)){continue;}if(A.tagName.toLowerCase()=="span"){if(u===A.parentNode){f.trimWhiteTextNode(u);if(u.childNodes.length==1){u.style.cssText=A.style.cssText+";"+u.style.cssText;f.remove(A,true);continue;}}A.style.cssText=u.style.cssText+";"+A.style.cssText;if(y){var r=y.style;if(r){r=r.split(";");for(var v=0,z;z=r[v++];){A.style[p.cssStyleToDomStyle(z.split(":")[0])]=z.split(":")[1];}}}if(f.isSameStyle(A,u)){f.remove(A,true);}continue;}if(f.isSameElement(u,A)){f.remove(A,true);}}},getElementsByTagName:function(v,r,s){if(s&&p.isString(s)){var z=s;s=function(B){return f.hasClass(B,z);};}r=p.trim(r).replace(/[ ]{2,}/g," ").split(" ");var x=[];for(var u=0,t;t=r[u++];){var y=v.getElementsByTagName(t);for(var w=0,A;A=y[w++];){if(!s||s(A)){x.push(A);}}}return x;},mergeToParent:function(s){var r=s.parentNode;while(r&&a.$removeEmpty[r.tagName]){if(r.tagName==s.tagName||r.tagName=="A"){f.trimWhiteTextNode(r);if(r.tagName=="SPAN"&&!f.isSameStyle(r,s)||(r.tagName=="A"&&s.tagName=="SPAN")){if(r.childNodes.length>1||r!==s.parentNode){s.style.cssText=r.style.cssText+";"+s.style.cssText;r=r.parentNode;continue;}else{r.style.cssText+=";"+s.style.cssText;if(r.tagName=="A"){r.style.textDecoration="underline";}}}if(r.tagName!="A"){r===s.parentNode&&f.remove(s,true);break;}}r=r.parentNode;}},mergeSibling:function(t,s,r){function u(x,y,w){var v;if((v=w[x])&&!f.isBookmarkNode(v)&&v.nodeType==1&&f.isSameElement(w,v)){while(v.firstChild){if(y=="firstChild"){w.insertBefore(v.lastChild,w.firstChild);}else{w.appendChild(v.firstChild);}}f.remove(v);}}!s&&u("previousSibling","firstChild",t);!r&&u("nextSibling","lastChild",t);},unSelectable:b||k.opera?function(t){t.onselectstart=function(){return false;};t.onclick=t.onkeyup=t.onkeydown=function(){return false;};t.unselectable="on";t.setAttribute("unselectable","on");for(var s=0,r;r=t.all[s++];){switch(r.tagName.toLowerCase()){case"iframe":case"textarea":case"input":case"select":break;default:r.unselectable="on";t.setAttribute("unselectable","on");}}}:function(r){r.style.MozUserSelect=r.style.webkitUserSelect=r.style.KhtmlUserSelect="none";},removeAttributes:function(t,u){u=p.isArray(u)?u:p.trim(u).replace(/[ ]{2,}/g," ").split(" ");for(var s=0,r;r=u[s++];){r=n[r]||r;switch(r){case"className":t[r]="";break;case"style":t.style.cssText="";!k.ie&&t.removeAttributeNode(t.getAttributeNode("style"));}t.removeAttribute(r);}},createElement:function(t,r,s){return f.setAttributes(t.createElement(r),s);},setAttributes:function(t,s){for(var r in s){if(s.hasOwnProperty(r)){var u=s[r];switch(r){case"class":t.className=u;break;case"style":t.style.cssText=t.style.cssText+";"+u;break;case"innerHTML":t[r]=u;break;case"value":t.value=u;break;default:t.setAttribute(n[r]||r,u);}}}return t;},getComputedStyle:function(t,s){var w="width height top left";if(w.indexOf(s)>-1){return t["offset"+s.replace(/^\w/,function(y){return y.toUpperCase();})]+"px";}if(t.nodeType==3){t=t.parentNode;}if(k.ie&&k.version<9&&s=="font-size"&&!t.style.fontSize&&!a.$empty[t.tagName]&&!a.$nonChild[t.tagName]){var u=t.ownerDocument.createElement("span");u.style.cssText="padding:0;border:0;font-family:simsun;";u.innerHTML=".";t.appendChild(u);var r=u.offsetHeight;t.removeChild(u);u=null;return r+"px";}try{var v=f.getStyle(t,s)||(window.getComputedStyle?f.getWindow(t).getComputedStyle(t,"").getPropertyValue(s):(t.currentStyle||t.style)[p.cssStyleToDomStyle(s)]);}catch(x){return"";}return p.transUnitToPx(p.fixColor(s,v));},removeClasses:function(v,u){u=p.isArray(u)?u:p.trim(u).replace(/[ ]{2,}/g," ").split(" ");for(var t=0,s,r=v.className;s=u[t++];){r=r.replace(new RegExp("\\b"+s+"\\b"),"");}r=p.trim(r).replace(/[ ]{2,}/g," ");if(r){v.className=r;}else{f.removeAttributes(v,["class"]);}},addClass:function(v,u){if(!v){return;}u=p.trim(u).replace(/[ ]{2,}/g," ").split(" ");for(var t=0,s,r=v.className;s=u[t++];){if(!new RegExp("\\b"+s+"\\b").test(r)){v.className+=" "+s;}}},hasClass:function(u,v){if(p.isRegExp(v)){return v.test(u.className);}v=p.trim(v).replace(/[ ]{2,}/g," ").split(" ");for(var t=0,s,r=u.className;s=v[t++];){if(!new RegExp("\\b"+s+"\\b","i").test(r)){return false;}}return t-1==v.length;},preventDefault:function(r){r.preventDefault?r.preventDefault():(r.returnValue=false);},removeStyle:function(s,r){if(k.ie&&k.version>8){s.style.cssText=s.style.cssText.replace(new RegExp(r+"s*:s*[^;]+;?"),"");}else{if(s.style.removeProperty){s.style.removeProperty(r);}else{s.style.removeAttribute(p.cssStyleToDomStyle(r));}}if(!s.style.cssText){f.removeAttributes(s,["style"]);}},getStyle:function(s,r){var t=s.style[p.cssStyleToDomStyle(r)];return p.fixColor(r,t);},setStyle:function(s,r,t){s.style[p.cssStyleToDomStyle(r)]=t;},setStyles:function(s,t){for(var r in t){if(t.hasOwnProperty(r)){f.setStyle(s,r,t[r]);}}},removeDirtyAttr:function(u){for(var t=0,s,r=u.getElementsByTagName("*");s=r[t++];){s.removeAttribute("_moz_dirty");}u.removeAttribute("_moz_dirty");},getChildCount:function(t,r){var s=0,u=t.firstChild;r=r||function(){return 1;};while(u){if(r(u)){s++;}u=u.nextSibling;}return s;},isEmptyNode:function(r){return !r.firstChild||f.getChildCount(r,function(s){return !f.isBr(s)&&!f.isBookmarkNode(s)&&!f.isWhitespace(s);})==0;},clearSelectedArr:function(r){var s;while(s=r.pop()){f.removeAttributes(s,["class"]);}},scrollToView:function(t,z,r){var s=function(){var A=z.document,B=A.compatMode=="CSS1Compat";return{width:(B?A.documentElement.clientWidth:A.body.clientWidth)||0,height:(B?A.documentElement.clientHeight:A.body.clientHeight)||0};},y=function(B){if("pageXOffset" in B){return{x:B.pageXOffset||0,y:B.pageYOffset||0};}else{var A=B.document;return{x:A.documentElement.scrollLeft||A.body.scrollLeft||0,y:A.documentElement.scrollTop||A.body.scrollTop||0};}};var w=s().height,x=w*-1+r;x+=(t.offsetHeight||0);var u=f.getXY(t);x+=u.y;var v=y(z).y;if(x>v||x<v-w){z.scrollTo(0,x+(x<0?-20:20));}},isBr:function(r){return r.nodeType==1&&r.tagName=="BR";},isFillChar:function(r,s){return r.nodeType==3&&!r.nodeValue.replace(new RegExp((s?"^":"")+f.fillChar),"").length;},isStartInblock:function(s){var w=s.cloneRange(),r=0,x=w.startContainer,t;if(x.nodeType==1&&x.childNodes[w.startOffset]){x=x.childNodes[w.startOffset];var v=x.previousSibling;while(v&&f.isFillChar(v)){x=v;v=v.previousSibling;}}if(this.isFillChar(x,true)&&w.startOffset==1){w.setStartBefore(x);x=w.startContainer;}while(x&&f.isFillChar(x)){t=x;x=x.previousSibling;}if(t){w.setStartBefore(t);x=w.startContainer;}if(x.nodeType==1&&f.isEmptyNode(x)&&w.startOffset==1){w.setStart(x,0).collapse(true);}while(!w.startOffset){x=w.startContainer;if(f.isBlockElm(x)||f.isBody(x)){r=1;break;}var v=w.startContainer.previousSibling,u;if(!v){w.setStartBefore(w.startContainer);}else{while(v&&f.isFillChar(v)){u=v;v=v.previousSibling;}if(u){w.setStartBefore(u);}else{w.setStartBefore(w.startContainer);}}}return r&&!f.isBody(w.startContainer)?1:0;},isEmptyBlock:function(s){var r=new RegExp("[ \t\r\n"+f.fillChar+"]","g");if(s[k.ie?"innerText":"textContent"].replace(r,"").length>0){return 0;}for(var t in a.$isNotEmpty){if(s.getElementsByTagName(t).length){return 0;}}return 1;},setViewportOffset:function(r,x){var w=parseInt(r.style.left)|0;var v=parseInt(r.style.top)|0;var t=r.getBoundingClientRect();var u=x.left-t.left;var s=x.top-t.top;if(u){r.style.left=w+u+"px";}if(s){r.style.top=v+s+"px";}},fillNode:function(t,s){var r=k.ie?t.createTextNode(f.fillChar):t.createElement("br");s.innerHTML="";s.appendChild(r);},moveChild:function(t,r,s){while(t.firstChild){if(s&&r.firstChild){r.insertBefore(t.lastChild,r.firstChild);}else{r.appendChild(t.firstChild);}}},hasNoAttributes:function(r){return k.ie?/^<\w+\s*?>/.test(r.outerHTML):r.attributes.length==0;},isCustomeNode:function(r){return r.nodeType==1&&r.getAttribute("_ue_custom_node_");},isTagNode:function(s,r){return s.nodeType==1&&new RegExp(s.tagName,"i").test(r);},filterNodeList:function(u,t,s){var r=[];if(!p.isFunction(t)){var v=t;t=function(w){return p.indexOf(p.isArray(v)?v:v.split(" "),w.tagName.toLowerCase())!=-1;};}p.each(u,function(w){t(w)&&r.push(w);});return r.length==0?null:r.length==1||!s?r[0]:r;},isInNodeEndBoundary:function(r,s){var t=r.startContainer;if(t.nodeType==3&&r.startOffset!=t.nodeValue.length){return 0;}if(t.nodeType==1&&r.startOffset!=t.childNodes.length){return 0;}while(t!==s){if(t.nextSibling){return 0;}t=t.parentNode;}return 1;},isBoundaryNode:function(t,r){var s;while(!f.isBody(t)){s=t;t=t.parentNode;if(s!==t[r]){return false;}}return true;}};var q=new RegExp(f.fillChar,"g");(function(){var w=0,x=f.fillChar,t;function s(B){B.collapsed=B.startContainer&&B.endContainer&&B.startContainer===B.endContainer&&B.startOffset==B.endOffset;}function A(B){return !B.collapsed&&B.startContainer.nodeType==1&&B.startContainer===B.endContainer&&B.endOffset-B.startOffset==1;}function r(C,D,E,B){if(D.nodeType==1&&(a.$empty[D.tagName]||a.$nonChild[D.tagName])){E=f.getNodeIndex(D)+(C?0:1);D=D.parentNode;}if(C){B.startContainer=D;B.startOffset=E;if(!B.endContainer){B.collapse(true);}}else{B.endContainer=D;B.endOffset=E;if(!B.startContainer){B.collapse(false);}}s(B);return B;}function z(H,L){var F=H.startContainer,E=H.endContainer,N=H.startOffset,G=H.endOffset,T=H.document,B=T.createDocumentFragment(),I,K;if(F.nodeType==1){F=F.childNodes[N]||(I=F.appendChild(T.createTextNode("")));}if(E.nodeType==1){E=E.childNodes[G]||(K=E.appendChild(T.createTextNode("")));}if(F===E&&F.nodeType==3){B.appendChild(T.createTextNode(F.substringData(N,G-N)));if(L){F.deleteData(N,G-N);H.collapse(true);}return B;}var J,P,R=B,Q=f.findParents(F,true),C=f.findParents(E,true);for(var O=0;Q[O]==C[O];){O++;}for(var M=O,S;S=Q[M];M++){J=S.nextSibling;if(S==F){if(!I){if(H.startContainer.nodeType==3){R.appendChild(T.createTextNode(F.nodeValue.slice(N)));if(L){F.deleteData(N,F.nodeValue.length-N);}}else{R.appendChild(!L?F.cloneNode(true):F);}}}else{P=S.cloneNode(false);R.appendChild(P);}while(J){if(J===E||J===C[M]){break;}S=J.nextSibling;R.appendChild(!L?J.cloneNode(true):J);J=S;}R=P;}R=B;if(!Q[O]){R.appendChild(Q[O-1].cloneNode(false));R=R.firstChild;}for(var M=O,D;D=C[M];M++){J=D.previousSibling;if(D==E){if(!K&&H.endContainer.nodeType==3){R.appendChild(T.createTextNode(E.substringData(0,G)));if(L){E.deleteData(0,G);}}}else{P=D.cloneNode(false);R.appendChild(P);}if(M!=O||!Q[O]){while(J){if(J===F){break;}D=J.previousSibling;R.insertBefore(!L?J.cloneNode(true):J,R.firstChild);J=D;}}R=P;}if(L){H.setStartBefore(!C[O]?C[O-1]:!Q[O]?Q[O-1]:C[O]).collapse(true);}I&&f.remove(I);K&&f.remove(K);return B;}var u=h.Range=function(B){var C=this;C.startContainer=C.startOffset=C.endContainer=C.endOffset=null;C.document=B;C.collapsed=true;};function v(E,B){try{if(t&&f.inDoc(t,E)){if(!t.nodeValue.replace(q,"").length){var C=t.parentNode;f.remove(t);while(C&&f.isEmptyInlineElement(C)&&(k.safari?!(f.getPosition(C,B)&f.POSITION_CONTAINS):!C.contains(B))){t=C.parentNode;f.remove(C);C=t;}}else{t.nodeValue=t.nodeValue.replace(q,"");}}}catch(D){}}function y(D,B){var C;D=D[B];while(D&&f.isFillChar(D)){C=D[B];f.remove(D);D=C;}}u.prototype={cloneContents:function(){return this.collapsed?null:z(this,0);},deleteContents:function(){var B;if(!this.collapsed){z(this,1);}if(k.webkit){B=this.startContainer;if(B.nodeType==3&&!B.nodeValue.length){this.setStartBefore(B).collapse(true);f.remove(B);}}return this;},extractContents:function(){return this.collapsed?null:z(this,2);},setStart:function(B,C){return r(true,B,C,this);},setEnd:function(B,C){return r(false,B,C,this);},setStartAfter:function(B){return this.setStart(B.parentNode,f.getNodeIndex(B)+1);},setStartBefore:function(B){return this.setStart(B.parentNode,f.getNodeIndex(B));},setEndAfter:function(B){return this.setEnd(B.parentNode,f.getNodeIndex(B)+1);},setEndBefore:function(B){return this.setEnd(B.parentNode,f.getNodeIndex(B));},setStartAtFirst:function(B){return this.setStart(B,0);},setStartAtLast:function(B){return this.setStart(B,B.nodeType==3?B.nodeValue.length:B.childNodes.length);},setEndAtFirst:function(B){return this.setEnd(B,0);},setEndAtLast:function(B){return this.setEnd(B,B.nodeType==3?B.nodeValue.length:B.childNodes.length);},selectNode:function(B){return this.setStartBefore(B).setEndAfter(B);},selectNodeContents:function(B){return this.setStart(B,0).setEndAtLast(B);},cloneRange:function(){var B=this;return new u(B.document).setStart(B.startContainer,B.startOffset).setEnd(B.endContainer,B.endOffset);},collapse:function(B){var C=this;if(B){C.endContainer=C.startContainer;C.endOffset=C.startOffset;}else{C.startContainer=C.endContainer;C.startOffset=C.endOffset;}C.collapsed=true;return C;},shrinkBoundary:function(D){var C=this,F,E=C.collapsed;function B(G){return G.nodeType==1&&!f.isBookmarkNode(G)&&!a.$empty[G.tagName]&&!a.$nonChild[G.tagName];}while(C.startContainer.nodeType==1&&(F=C.startContainer.childNodes[C.startOffset])&&B(F)){C.setStart(F,0);}if(E){return C.collapse(true);}if(!D){while(C.endContainer.nodeType==1&&C.endOffset>0&&(F=C.endContainer.childNodes[C.endOffset-1])&&B(F)){C.setEnd(F,F.childNodes.length);}}return C;},getCommonAncestor:function(C,D){var E=this,F=E.startContainer,B=E.endContainer;if(F===B){if(C&&A(this)){F=F.childNodes[E.startOffset];if(F.nodeType==1){return F;}}return D&&F.nodeType==3?F.parentNode:F;}return f.getCommonAncestor(F,B);},trimBoundary:function(C){this.txtToElmBoundary();var G=this.startContainer,F=this.startOffset,E=this.collapsed,B=this.endContainer;if(G.nodeType==3){if(F==0){this.setStartBefore(G);}else{if(F>=G.nodeValue.length){this.setStartAfter(G);}else{var D=f.split(G,F);if(G===B){this.setEnd(D,this.endOffset-F);}else{if(G.parentNode===B){this.endOffset+=1;}}this.setStartBefore(D);}}if(E){return this.collapse(true);}}if(!C){F=this.endOffset;B=this.endContainer;if(B.nodeType==3){if(F==0){this.setEndBefore(B);}else{F<B.nodeValue.length&&f.split(B,F);this.setEndAfter(B);}}}return this;},txtToElmBoundary:function(){function B(D,F){var C=D[F+"Container"],E=D[F+"Offset"];if(C.nodeType==3){if(!E){D["set"+F.replace(/(\w)/,function(G){return G.toUpperCase();})+"Before"](C);}else{if(E>=C.nodeValue.length){D["set"+F.replace(/(\w)/,function(G){return G.toUpperCase();})+"After"](C);}}}}if(!this.collapsed){B(this,"start");B(this,"end");}return this;},insertNode:function(D){var F=D,C=1;if(D.nodeType==11){F=D.firstChild;C=D.childNodes.length;}this.trimBoundary(true);var G=this.startContainer,E=this.startOffset;var B=G.childNodes[E];if(B){G.insertBefore(D,B);}else{G.appendChild(D);}if(F.parentNode===this.endContainer){this.endOffset=this.endOffset+C;}return this.setStartBefore(F);},setCursor:function(C,B){return this.collapse(!C).select(B);},createBookmark:function(D,E){var B,C=this.document.createElement("span");C.style.cssText="display:none;line-height:0px;";C.appendChild(this.document.createTextNode("\u200D"));C.id="_baidu_bookmark_start_"+(E?"":w++);if(!this.collapsed){B=C.cloneNode(true);B.id="_baidu_bookmark_end_"+(E?"":w++);}this.insertNode(C);if(B){this.collapse().insertNode(B).setEndBefore(B);}this.setStartAfter(C);return{start:D?C.id:C,end:B?D?B.id:B:null,id:D};},moveToBookmark:function(C){var D=C.id?this.document.getElementById(C.start):C.start,B=C.end&&C.id?this.document.getElementById(C.end):C.end;this.setStartBefore(D);f.remove(D);if(B){this.setEndBefore(B);f.remove(B);}else{this.collapse(true);}return this;},enlarge:function(C,F){var B=f.isBody,G,E,D=this.document.createTextNode("");if(C){E=this.startContainer;if(E.nodeType==1){if(E.childNodes[this.startOffset]){G=E=E.childNodes[this.startOffset];}else{E.appendChild(D);G=E=D;}}else{G=E;}while(1){if(f.isBlockElm(E)){E=G;while((G=E.previousSibling)&&!f.isBlockElm(G)){E=G;}this.setStartBefore(E);break;}G=E;E=E.parentNode;}E=this.endContainer;if(E.nodeType==1){if(G=E.childNodes[this.endOffset]){E.insertBefore(D,G);}else{E.appendChild(D);}G=E=D;}else{G=E;}while(1){if(f.isBlockElm(E)){E=G;while((G=E.nextSibling)&&!f.isBlockElm(G)){E=G;}this.setEndAfter(E);break;}G=E;E=E.parentNode;}if(D.parentNode===this.endContainer){this.endOffset--;}f.remove(D);}if(!this.collapsed){while(this.startOffset==0){if(F&&F(this.startContainer)){break;}if(B(this.startContainer)){break;}this.setStartBefore(this.startContainer);}while(this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length)){if(F&&F(this.endContainer)){break;}if(B(this.endContainer)){break;}this.setEndAfter(this.endContainer);}}return this;},adjustmentBoundary:function(){if(!this.collapsed){while(!f.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length){this.setStartAfter(this.startContainer);}while(!f.isBody(this.endContainer)&&!this.endOffset){this.setEndBefore(this.endContainer);}}return this;},applyInlineStyle:function(D,O,K){if(this.collapsed){return this;}this.trimBoundary().enlarge(false,function(S){return S.nodeType==1&&f.isBlockElm(S);}).adjustmentBoundary();var L=this.createBookmark(),G=L.end,Q=function(S){return S.nodeType==1?S.tagName.toLowerCase()!="br":!f.isWhitespace(S);},J=f.getNextDomNode(L.start,false,Q),E,F,I=this.cloneRange();while(J&&(f.getPosition(J,G)&f.POSITION_PRECEDING)){if(J.nodeType==3||a[D][J.tagName]){I.setStartBefore(J);E=J;while(E&&(E.nodeType==3||a[D][E.tagName])&&E!==G){F=E;E=f.getNextDomNode(E,E.nodeType==1,null,function(S){return a[D][S.tagName];});}var P=I.setEndAfter(F).extractContents(),M;if(K&&K.length>0){var B,N;N=B=K[0].cloneNode(false);for(var H=1,R;R=K[H++];){B.appendChild(R.cloneNode(false));B=B.firstChild;}M=B;}else{M=I.document.createElement(D);}if(O){f.setAttributes(M,O);}M.appendChild(P);I.insertNode(K?N:M);var C;if(D=="span"&&O.style&&/text\-decoration/.test(O.style)&&(C=f.findParentByTagName(M,"a",true))){f.setAttributes(C,O);f.remove(M,true);M=C;}else{f.mergeSibling(M);f.clearEmptySibling(M);}f.mergeChild(M,O);J=f.getNextDomNode(M,false,Q);f.mergeToParent(M);if(E===G){break;}}else{J=f.getNextDomNode(J,true,Q);}}return this.moveToBookmark(L);},removeInlineStyle:function(B){if(this.collapsed){return this;}B=p.isArray(B)?B:[B];this.shrinkBoundary().adjustmentBoundary();var I=this.startContainer,C=this.endContainer;while(1){if(I.nodeType==1){if(p.indexOf(B,I.tagName.toLowerCase())>-1){break;}if(I.tagName.toLowerCase()=="body"){I=null;break;}}I=I.parentNode;}while(1){if(C.nodeType==1){if(p.indexOf(B,C.tagName.toLowerCase())>-1){break;}if(C.tagName.toLowerCase()=="body"){C=null;break;}}C=C.parentNode;}var E=this.createBookmark(),H,G;if(I){G=this.cloneRange().setEndBefore(E.start).setStartBefore(I);H=G.extractContents();G.insertNode(H);f.clearEmptySibling(I,true);I.parentNode.insertBefore(E.start,I);}if(C){G=this.cloneRange().setStartAfter(E.end).setEndAfter(C);H=G.extractContents();G.insertNode(H);f.clearEmptySibling(C,false,true);C.parentNode.insertBefore(E.end,C.nextSibling);}var F=f.getNextDomNode(E.start,false,function(J){return J.nodeType==1;}),D;while(F&&F!==E.end){D=f.getNextDomNode(F,true,function(J){return J.nodeType==1;});if(p.indexOf(B,F.tagName.toLowerCase())>-1){f.remove(F,true);}F=D;}return this.moveToBookmark(E);},getClosedNode:function(){var C;if(!this.collapsed){var B=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(A(B)){var D=B.startContainer.childNodes[B.startOffset];if(D&&D.nodeType==1&&(a.$empty[D.tagName]||a.$nonChild[D.tagName])){C=D;}}}return C;},select:k.ie?function(C,L){var H;if(!this.collapsed){this.shrinkBoundary();}var D=this.getClosedNode();if(D&&!L){try{H=this.document.body.createControlRange();H.addElement(D);H.select();}catch(I){}return this;}var J=this.createBookmark(),B=J.start,E;H=this.document.body.createTextRange();H.moveToElementText(B);H.moveStart("character",1);if(!this.collapsed){var G=this.document.body.createTextRange();E=J.end;G.moveToElementText(E);H.setEndPoint("EndToEnd",G);}else{if(!C&&this.startContainer.nodeType!=3){var K=this.document.createTextNode(x),F=this.document.createElement("span");F.appendChild(this.document.createTextNode(x));B.parentNode.insertBefore(F,B);B.parentNode.insertBefore(K,B);v(this.document,K);t=K;y(F,"previousSibling");y(B,"nextSibling");H.moveStart("character",-1);H.collapse(true);}}this.moveToBookmark(J);F&&f.remove(F);try{H.select();}catch(I){}return this;}:function(B){function C(K){function J(M,N,L){if(M.nodeType==3&&M.nodeValue.length<N){K[L+"Offset"]=M.nodeValue.length;}}J(K.startContainer,K.startOffset,"start");J(K.endContainer,K.endOffset,"end");}var G=f.getWindow(this.document),F=G.getSelection(),E;k.gecko?this.document.body.focus():G.focus();if(F){F.removeAllRanges();if(this.collapsed&&!B){var I=this.startContainer,H=I;if(I.nodeType==1){H=I.childNodes[this.startOffset];}if(!(I.nodeType==3&&this.startOffset)&&(H?(!H.previousSibling||H.previousSibling.nodeType!=3):(!I.lastChild||I.lastChild.nodeType!=3))){E=this.document.createTextNode(x);this.insertNode(E);v(this.document,E);y(E,"previousSibling");y(E,"nextSibling");t=E;this.setStart(E,k.webkit?1:0).collapse(true);}}var D=this.document.createRange();if(this.collapsed&&k.opera&&this.startContainer.nodeType==1){var H=this.startContainer.childNodes[this.startOffset];if(!H){H=this.startContainer.lastChild;if(H&&f.isBr(H)){this.setStartBefore(H).collapse(true);}}else{while(H&&f.isBlockElm(H)){if(H.nodeType==1&&H.childNodes[0]){H=H.childNodes[0];}else{break;}}H&&this.setStartBefore(H).collapse(true);}}C(this);D.setStart(this.startContainer,this.startOffset);D.setEnd(this.endContainer,this.endOffset);F.addRange(D);}return this;},scrollToView:function(D,E){D=D?window:f.getWindow(this.document);var C=this,B=C.document.createElement("span");B.innerHTML="&nbsp;";C.cloneRange().insertNode(B);f.scrollToView(B,D,E);f.remove(B);return C;},inFillChar:function(){var B=this.startContainer;if(this.collapsed&&B.nodeType==3&&B.nodeValue.replace(new RegExp("^"+f.fillChar),"").length+1==B.nodeValue.length){return true;}return false;},createAddress:function(E,D){var F={},C=this;function B(G){var I=G?C.startContainer:C.endContainer;var N=f.findParents(I,true,function(P){return !f.isBody(P);}),M=[];for(var K=0,O;O=N[K++];){M.push(f.getNodeIndex(O,D));}var H=0;if(D){if(I.nodeType==3){var J=I;while(J=J.previousSibling){if(J.nodeType==3){H+=J.nodeValue.replace(q,"").length;}else{break;}}H+=(G?C.startOffset:C.endOffset)-(q.test(I.nodeValue)?1:0);}else{I=I.childNodes[G?C.startOffset:C.endOffset];if(I){H=f.getNodeIndex(I,D);}else{I=G?C.startContainer:C.endContainer;var L=I.firstChild;while(L){if(f.isFillChar(L)){L=L.nextSibling;continue;}H++;if(L.nodeType==3){while(L&&L.nodeType==3){L=L.nextSibling;}}else{L=L.nextSibling;}}}}}else{H=G?C.startOffset:C.endOffset;}if(H<0){H=0;}M.push(H);return M;}F.startAddress=B(true);if(!E){F.endAddress=C.collapsed?[].concat(F.startAddress):B();}return F;},moveToAddress:function(E,C){var B=this;function D(I,H){var L=B.document.body,F,M;for(var K=0,J,G=I.length;K<G;K++){J=I[K];F=L;L=L.childNodes[J];if(!L){M=J;break;}}if(H){if(L){B.setStartBefore(L);}else{B.setStart(F,M);}}else{if(L){B.setEndBefore(L);}else{B.setEnd(F,M);}}}D(E.startAddress,true);!C&&E.endAddress&&D(E.endAddress);return B;},equals:function(B){for(var C in this){if(this.hasOwnProperty(C)){if(this[C]!==B[C]){return false;}}}return true;}};})();(function(){function u(E,w){var x=f.getNodeIndex;E=E.duplicate();E.collapse(w);var I=E.parentElement();if(!I.hasChildNodes()){return{container:I,offset:0};}var H=I.children,y,A=E.duplicate(),J=0,D=H.length-1,F=-1,v;while(J<=D){F=Math.floor((J+D)/2);y=H[F];A.moveToElementText(y);var C=A.compareEndPoints("StartToStart",E);if(C>0){D=F-1;}else{if(C<0){J=F+1;}else{return{container:I,offset:x(y)};}}}if(F==-1){A.moveToElementText(I);A.setEndPoint("StartToStart",E);v=A.text.replace(/(\r\n|\r)/g,"\n").length;H=I.childNodes;if(!v){y=H[H.length-1];return{container:y,offset:y.nodeValue.length};}var B=H.length;while(v>0){v-=H[--B].nodeValue.length;}return{container:H[B],offset:-v};}A.collapse(C>0);A.setEndPoint(C>0?"StartToStart":"EndToStart",E);v=A.text.replace(/(\r\n|\r)/g,"\n").length;if(!v){return a.$empty[y.tagName]||a.$nonChild[y.tagName]?{container:I,offset:x(y)+(C>0?0:1)}:{container:y,offset:C>0?0:y.childNodes.length};}while(v>0){try{var z=y;y=y[C>0?"previousSibling":"nextSibling"];v-=y.nodeValue.length;}catch(G){return{container:I,offset:x(z)};}}return{container:y,offset:C>0?-v:y.nodeValue.length+v};}function t(x,w){if(x.item){w.selectNode(x.item(0));}else{var v=u(x,true);w.setStart(v.container,v.offset);if(x.compareEndPoints("StartToEnd",x)!=0){v=u(x,false);w.setEnd(v.container,v.offset);}}return w;}function s(x){var w;try{w=x.getNative().createRange();}catch(y){return null;}var v=w.item?w.item(0):w.parentElement();if((v.ownerDocument||v)===x.document){return w;}return null;}var r=h.Selection=function(x){var w=this,v;w.document=x;if(b){v=f.getWindow(x).frameElement;f.on(v,"beforedeactivate",function(){w._bakIERange=w.getIERange();});f.on(v,"activate",function(){try{if(!s(w)&&w._bakIERange){w._bakIERange.select();}}catch(y){}w._bakIERange=null;});}v=x=null;};r.prototype={getNative:function(){var w=this.document;try{return !w?null:b?w.selection:f.getWindow(w).getSelection();}catch(v){return null;}},getIERange:function(){var v=s(this);if(!v){if(this._bakIERange){return this._bakIERange;}}return v;},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();this._cachedStartElementPath=this.getStartElementPath();},getStartElementPath:function(){if(this._cachedStartElementPath){return this._cachedStartElementPath;}var v=this.getStart();if(v){return f.findParents(v,true,null,true);}return[];},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null;},isFocus:function(){try{return k.ie&&s(this)||!k.ie&&this.getNative().rangeCount?true:false;}catch(v){return false;}},getRange:function(){var y=this;function x(D){var F=y.document.body.firstChild,E=D.collapsed;while(F&&F.firstChild){D.setStart(F,0);F=F.firstChild;}if(!D.startContainer){D.setStart(y.document.body,0);}if(E){D.collapse(true);}}if(y._cachedRange!=null){return this._cachedRange;}var w=new c.editor.dom.Range(y.document);if(b){var A=y.getIERange();if(A){try{t(A,w);}catch(B){x(w);}}else{x(w);}}else{var z=y.getNative();if(z&&z.rangeCount){var v=z.getRangeAt(0);var C=z.getRangeAt(z.rangeCount-1);w.setStart(v.startContainer,v.startOffset).setEnd(C.endContainer,C.endOffset);if(w.collapsed&&f.isBody(w.startContainer)&&!w.startOffset){x(w);}}else{if(this._bakRange&&f.inDoc(this._bakRange.startContainer,this.document)){return this._bakRange;}x(w);}}return this._bakRange=w;},getStart:function(){if(this._cachedStartElement){return this._cachedStartElement;}var v=b?this.getIERange():this.getRange(),y,z,w,x;if(b){if(!v){return this.document.body.firstChild;}if(v.item){return v.item(0);}y=v.duplicate();y.text.length>0&&y.moveStart("character",1);y.collapse(1);z=y.parentElement();x=w=v.parentElement();while(w=w.parentNode){if(w==z){z=x;break;}}}else{v.shrinkBoundary();z=v.startContainer;if(z.nodeType==1&&z.hasChildNodes()){z=z.childNodes[Math.min(z.childNodes.length-1,v.startOffset)];}if(z.nodeType==3){return z.parentNode;}}return z;},getText:function(){var v,w;if(this.isFocus()&&(v=this.getNative())){w=k.ie?v.createRange():v.getRangeAt(0);return k.ie?w.text:w.toString();}return"";},clearRange:function(){this.getNative()[k.ie?"empty":"removeAllRanges"]();}};})();(function(){var u=0,s;function t(C){var B=C.getElementsByTagName("img"),A;for(var z=0,y;y=B[z++];){if(A=y.getAttribute("orgSrc")){y.src=A;y.removeAttribute("orgSrc");}}var x=C.getElementsByTagName("a");for(var z=0,w;w=x[z++];z++){if(w.getAttribute("data_ue_src")){w.setAttribute("href",w.getAttribute("data_ue_src"));}}}function v(B,A){var w;if(A.textarea){if(p.isString(A.textarea)){for(var y=0,z,x=f.getElementsByTagName(B,"textarea");z=x[y++];){if(z.id=="ueditor_textarea_"+A.options.textarea){w=z;break;}}}else{w=A.textarea;}}if(!w){B.appendChild(w=f.createElement(document,"textarea",{name:A.options.textarea,id:"ueditor_textarea_"+A.options.textarea,style:"display:none"}));A.textarea=w;}w.value=A.hasContents()?(A.options.allHtmlEnabled?A.getAllHtml():A.getContent(null,null,true)):"";}var r=UE.Editor=function(w){var x=this;x.uid=u++;j.call(x);x.commands={};x.options=p.extend(p.clone(w||{}),UEDITOR_CONFIG,true);x.shortcutkeys={};x.setOpt({isShow:true,initialContent:"",autoClearinitialContent:false,iframeCssUrl:x.options.UEDITOR_HOME_URL+"themes/iframe.css",textarea:"editorValue",focus:false,initialFrameWidth:1000,initialFrameHeight:x.options.minFrameHeight||320,minFrameWidth:800,minFrameHeight:220,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",pageBreakTag:"_baidu_page_break_tag_",customDomain:false,lang:"zh-cn",langPath:x.options.UEDITOR_HOME_URL+"lang/",theme:"default",themePath:x.options.UEDITOR_HOME_URL+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false});p.loadFile(document,{src:x.options.langPath+x.options.lang+"/"+x.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){for(var y in UE.plugins){UE.plugins[y].call(x);}x.langIsReady=true;x.fireEvent("langReady");});UE.instants["ueditorInstant"+x.uid]=x;};r.prototype={ready:function(w){var x=this;if(w){x.isReady?w.apply(x):x.addListener("ready",w);}},setOpt:function(w,y){var x={};if(p.isString(w)){x[w]=y;}else{x=w;}p.extend(this.options,x,true);},destroy:function(){var z=this;z.fireEvent("destroy");var x=z.container.parentNode;var w=z.textarea;if(!w){w=document.createElement("textarea");x.parentNode.insertBefore(w,x);}else{w.style.display="";}w.style.width=x.offsetWidth+"px";w.style.height=x.offsetHeight+"px";w.value=z.getContent();w.id=z.key;x.innerHTML="";f.remove(x);var y=z.key;for(var A in z){if(z.hasOwnProperty(A)){delete this[A];}}UE.delEditor(y);},render:function(x){var A=this,y=A.options;if(p.isString(x)){x=document.getElementById(x);}if(x){var w=b&&k.version<9,z=(b&&k.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml'"+(!w?" class='view'":"")+"><head>"+(y.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+p.unhtml(y.iframeCssUrl)+"'/>":"")+"<style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:100%;}\nbody{margin:8px;font-family:sans-serif;font-size:16px;}p{margin:5px 0;}"+(y.initialStyle||"")+"</style></head><body"+(w?" class='view'":"")+"></body>";if(y.customDomain&&document.domain!=location.hostname){z+="<script>window.parent.UE.instants['ueditorInstant"+A.uid+"']._setup(document);<\/script></html>";x.appendChild(f.createElement(document,"iframe",{id:"baidu_editor_"+A.uid,width:"100%",height:"100%",frameborder:"0",src:'javascript:void(function(){document.open();document.domain="'+document.domain+'";document.write("'+z+'");document.close();}())'}));}else{x.innerHTML='<iframe id="baidu_editor_'+this.uid+'"width="100%" height="100%" scroll="no" frameborder="0" ></iframe>';var B=x.firstChild.contentWindow.document;B.open();B.write(z+"</html>");B.close();A._setup(B);}x.style.overflow="hidden";}},_setup:function(B){var z=this,w=z.options;if(b){B.body.disabled=true;B.body.contentEditable=true;B.body.disabled=false;}else{B.body.contentEditable=true;B.body.spellcheck=false;}z.document=B;z.window=B.defaultView||B.parentWindow;z.iframe=z.window.frameElement;z.body=B.body;z.setHeight(Math.max(w.minFrameHeight,w.initialFrameHeight));z.selection=new h.Selection(B);var C;if(k.gecko&&(C=this.selection.getNative())){C.removeAllRanges();}this._initEvents();if(w.initialContent){if(w.autoClearinitialContent){var x=z.execCommand;z.execCommand=function(){z.fireEvent("firstBeforeExecCommand");return x.apply(z,arguments);};this._setDefaultContent(w.initialContent);}else{this.setContent(w.initialContent,false,true);}}for(var y=this.iframe.parentNode;!f.isBody(y);y=y.parentNode){if(y.tagName=="FORM"){f.on(y,"submit",function(){v(this,z);});break;}}if(f.isEmptyNode(z.body)){z.body.innerHTML="<p>"+(k.ie?"":"<br/>")+"</p>";}if(w.focus){setTimeout(function(){z.focus();!z.options.autoClearinitialContent&&z._selectionChange();},0);}if(!z.container){z.container=this.iframe.parentNode;}if(w.fullscreen&&z.ui){z.ui.setFullScreen(true);}try{z.document.execCommand("2D-position",false,false);}catch(A){}try{z.document.execCommand("enableInlineTableEditing",false,false);}catch(A){}try{z.document.execCommand("enableObjectResizing",false,false);}catch(A){}z._bindshortcutKeys();z.isReady=1;z.fireEvent("ready");w.onready&&w.onready.call(z);if(!k.ie){f.on(z.window,["blur","focus"],function(D){if(D.type=="blur"){z._bakRange=z.selection.getRange();try{z.selection.getNative().removeAllRanges();}catch(D){}}else{try{z._bakRange&&z._bakRange.select();}catch(D){}}});}if(k.gecko&&k.version<=10902){z.body.contentEditable=false;setTimeout(function(){z.body.contentEditable=true;},100);setInterval(function(){z.body.style.height=z.iframe.offsetHeight-20+"px";},100);}!w.isShow&&z.setHide();w.readonly&&z.setDisabled();},sync:function(y){var x=this,w=y?document.getElementById(y):f.findParent(x.iframe.parentNode,function(z){return z.tagName=="FORM";},true);w&&v(w,x);},setHeight:function(w){if(w!==parseInt(this.iframe.parentNode.style.height)){this.iframe.parentNode.style.height=w+"px";}this.document.body.style.height=w-20+"px";},addshortcutkey:function(x,w){var y={};if(w){y[x]=w;}else{y=x;}p.extend(this.shortcutkeys,y);},_bindshortcutKeys:function(){var x=this,w=this.shortcutkeys;x.addListener("keydown",function(D,C){var F=C.keyCode||C.which;for(var A in w){var B=w[A].split(",");for(var G=0,y;y=B[G++];){y=y.split(":");var E=y[0],z=y[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(E.toLowerCase())||/^(\d+)$/.test(E)){if(((RegExp.$1=="ctrl"?(C.ctrlKey||C.metaKey):0)&&(RegExp.$2!=""?C[RegExp.$2.slice(1)+"Key"]:1)&&F==RegExp.$3)||F==RegExp.$1){x.execCommand(A,z);f.preventDefault(C);}}}}});},getContent:function(z,E,w){var D=this;if(z&&p.isFunction(z)){E=z;z="";}if(E?!E():!this.hasContents()){return"";}var B=D.selection.getRange(),F=B.createAddress();D.fireEvent("beforegetcontent",z);var x=new RegExp(f.fillChar,"g"),A=D.body.innerHTML.replace(x,"").replace(/>[\t\r\n]*?</g,"><");D.fireEvent("aftergetcontent",z);try{B.moveToAddress(F).select(true);}catch(C){}if(D.serialize){var y=D.serialize.parseHTML(A);y=D.serialize.transformOutput(y);A=D.serialize.toHTML(y);}if(b&&w){A=A.replace(/<p>\s*?<\/p>/g,"<p>&nbsp;</p>");}else{A=A.replace(/(&nbsp;)+/g,function(I){for(var H=0,J=[],G=I.split(";").length-1;H<G;H++){J.push(H%2==0?" ":"&nbsp;");}return J.join("");});}return A;},getAllHtml:function(){var y=this,x=[],w="";y.fireEvent("getAllHtml",x);if(k.ie&&k.version>8){var z="";p.each(y.document.styleSheets,function(A){z+=(A.href?'<link rel="stylesheet" type="text/css" href="'+A.href+'" />':"<style>"+A.cssText+"</style>");});p.each(y.document.getElementsByTagName("script"),function(A){z+=A.outerHTML;});}return"<html><head>"+(y.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+y.options.charset+'"/>':"")+(z||y.document.getElementsByTagName("head")[0].innerHTML)+x.join("\n")+"</head><body "+(b&&k.version<9?'class="view"':"")+">"+y.getContent(null,null,true)+"</body></html>";},getPlainTxt:function(){var x=new RegExp(f.fillChar,"g"),w=this.body.innerHTML.replace(/[\n\r]/g,"");w=w.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(z,y,A){return a.$block[A]?"\n":y?y:"";});return w.replace(x,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ");},getContentTxt:function(){var w=new RegExp(f.fillChar,"g");return this.body[k.ie?"innerText":"textContent"].replace(w,"").replace(/\u00a0/g," ");},setContent:function(C,F,A){var G=this,E=p.extend({a:1,A:1},a.$inline,true),B;C=C.replace(/^[ \t\r\n]*?</,"<").replace(/>[ \t\r\n]*?$/,">").replace(/>(?:(\s|&nbsp;)*?)</g,"><").replace(/[\s\/]?(\w+)?>[ \t\r\n]*?<\/?(\w+)/gi,function(J,I,K){if(I){B=K;}else{I=B;}return !E[I]&&!E[K]?J.replace(/>[ \t\r\n]*?</,"><"):J;});C={html:C};G.fireEvent("beforesetcontent",C);C=C.html;var H=this.serialize;if(H){var z=H.parseHTML(C);z=H.transformInput(z);z=H.filter(z);C=H.toHTML(z);}this.body.innerHTML=(F?this.getContent():"")+C.replace(new RegExp("[\r"+f.fillChar+"]*","g"),"");if(k.ie&&k.version<7){t(this.document.body);}if(G.options.enterTag=="p"){var x=this.body.firstChild,y;if(!x||x.nodeType==1&&(a.$cdata[x.tagName]||f.isCustomeNode(x))&&x===this.body.lastChild){this.body.innerHTML="<p>"+(k.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;}else{var w=G.document.createElement("p");while(x){while(x&&(x.nodeType==3||x.nodeType==1&&a.p[x.tagName]&&!a.$cdata[x.tagName])){y=x.nextSibling;w.appendChild(x);x=y;}if(w.firstChild){if(!x){G.body.appendChild(w);break;}else{x.parentNode.insertBefore(w,x);w=G.document.createElement("p");}}x=x.nextSibling;}}}G.fireEvent("aftersetcontent");G.fireEvent("contentchange");!A&&G._selectionChange();G._bakRange=G._bakIERange=null;var D;if(k.gecko&&(D=this.selection.getNative())){D.removeAllRanges();}},focus:function(z){try{var x=this,w=x.selection.getRange();if(z){w.setStartAtLast(x.body.lastChild).setCursor(false,true);}else{w.select(true);}}catch(y){}},_initEvents:function(){var x=this,B=x.document,A=x.window;x._proxyDomEvent=p.bind(x._proxyDomEvent,x);f.on(B,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],x._proxyDomEvent);f.on(A,["focus","blur"],x._proxyDomEvent);f.on(B,["mouseup","keydown"],function(C){if(C.type=="keydown"&&(C.ctrlKey||C.metaKey||C.shiftKey||C.altKey)){return;}if(C.button==2){return;}x._selectionChange(250,C);});var w=0,y=k.ie?x.body:x.document,z;f.on(y,"dragstart",function(){w=1;});f.on(y,k.webkit?"dragover":"drop",function(){return k.webkit?function(){clearTimeout(z);z=setTimeout(function(){if(!w){var G=x.selection,C=G.getRange();if(C){var D=C.getCommonAncestor();if(D&&x.serialize){var F=x.serialize,E=F.filter(F.transformInput(F.parseHTML(F.word(D.innerHTML))));D.innerHTML=F.toHTML(E);}}}w=0;},200);}:function(C){if(!w){C.preventDefault?C.preventDefault():(C.returnValue=false);}w=0;};}());},_proxyDomEvent:function(w){return this.fireEvent(w.type.replace(/^on/,""),w);},_selectionChange:function(z,w){var C=this;var B=false;var A,y;if(k.ie&&k.version<9&&w&&w.type=="mouseup"){var x=this.selection.getRange();if(!x.collapsed){B=true;A=w.clientX;y=w.clientY;}}clearTimeout(s);s=setTimeout(function(){if(!C.selection.getNative()){return;}var E;if(B&&C.selection.getNative().type=="None"){E=C.document.body.createTextRange();try{E.moveToPoint(A,y);}catch(D){E=null;}}var F;if(E){F=C.selection.getIERange;C.selection.getIERange=function(){return E;};}C.selection.cache();if(F){C.selection.getIERange=F;}if(C.selection._cachedRange&&C.selection._cachedStartElement){C.fireEvent("beforeselectionchange");C.fireEvent("selectionchange",!!w);C.fireEvent("afterselectionchange");C.selection.clear();}},z||50);},_callCmdFn:function(A,x){var w=x[0].toLowerCase(),z,y;z=this.commands[w]||UE.commands[w];y=z&&z[A];if((!z||!y)&&A=="queryCommandState"){return 0;}else{if(y){return y.apply(this,x);}}},execCommand:function(x){x=x.toLowerCase();var y=this,w,z=y.commands[x]||UE.commands[x];if(!z||!z.execCommand){return null;}if(!z.notNeedUndo&&!y.__hasEnterExecCommand){y.__hasEnterExecCommand=true;if(y.queryCommandState(x)!=-1){y.fireEvent("beforeexeccommand",x);w=this._callCmdFn("execCommand",arguments);!y._ignoreContentChange&&y.fireEvent("contentchange");y.fireEvent("afterexeccommand",x);}y.__hasEnterExecCommand=false;}else{w=this._callCmdFn("execCommand",arguments);!y._ignoreContentChange&&y.fireEvent("contentchange");}!y._ignoreContentChange&&y._selectionChange();return w;},queryCommandState:function(w){return this._callCmdFn("queryCommandState",arguments);},queryCommandValue:function(w){return this._callCmdFn("queryCommandValue",arguments);},hasContents:function(x){if(x){for(var z=0,y;y=x[z++];){if(this.document.getElementsByTagName(y).length>0){return true;}}}if(!f.isEmptyBlock(this.body)){return true;}x=["div"];for(z=0;y=x[z++];){var w=f.getElementsByTagName(this.document,y);for(var B=0,A;A=w[B++];){if(f.isCustomeNode(A)){return true;}}}return false;},reset:function(){this.fireEvent("reset");},setEnabled:function(){var x=this,w;if(x.body.contentEditable=="false"){x.body.contentEditable=true;w=x.selection.getRange();try{w.moveToBookmark(x.lastBk);delete x.lastBk;}catch(y){w.setStartAtFirst(x.body).collapse(true);}w.select(true);if(x.bkqueryCommandState){x.queryCommandState=x.bkqueryCommandState;delete x.bkqueryCommandState;}x.fireEvent("selectionchange");}},enable:function(){return this.setEnabled();},setDisabled:function(w){var x=this;w=w?p.isArray(w)?w:[w]:[];if(x.body.contentEditable=="true"){if(!x.lastBk){x.lastBk=x.selection.getRange().createBookmark(true);}x.body.contentEditable=false;x.bkqueryCommandState=x.queryCommandState;x.queryCommandState=function(y){if(p.indexOf(w,y)!=-1){return x.bkqueryCommandState.apply(x,arguments);}return -1;};x.fireEvent("selectionchange");}},disable:function(w){return this.setDisabled(w);},_setDefaultContent:function(){function w(){var x=this;if(x.document.getElementById("initContent")){x.body.innerHTML="<p>"+(b?"":"<br/>")+"</p>";x.removeListener("firstBeforeExecCommand focus",w);setTimeout(function(){x.focus();x._selectionChange();},0);}}return function(x){var y=this;y.body.innerHTML='<p id="initContent">'+x+"</p>";if(k.ie&&k.version<7){t(y.body);}y.addListener("firstBeforeExecCommand focus",w);};}(),setShow:function(){var x=this,w=x.selection.getRange();if(x.container.style.display=="none"){try{w.moveToBookmark(x.lastBk);delete x.lastBk;}catch(y){w.setStartAtFirst(x.body).collapse(true);}setTimeout(function(){w.select(true);},100);x.container.style.display="";}},show:function(){return this.setShow();},setHide:function(){var w=this;if(!w.lastBk){w.lastBk=w.selection.getRange().createBookmark(true);}w.container.style.display="none";},hide:function(){return this.setHide();},getLang:function(y){var z=UE.I18N[this.options.lang];if(!z){throw Error("not import language file");}y=(y||"").split(".");for(var x=0,w;w=y[x++];){z=z[w];if(!z){break;}}return z;},getContentLength:function(x,w){var A=this.getContent().length;if(x){w=(w||[]).concat(["hr","img","iframe"]);A=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;for(var z=0,y;y=w[z++];){A+=this.document.getElementsByTagName(y).length;}}return A;}};p.inherits(r,j);})();UE.ajax=function(){var r="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");r="ActiveXObject('Msxml2.XMLHTTP')";}catch(u){try{new ActiveXObject("Microsoft.XMLHTTP");r="ActiveXObject('Microsoft.XMLHTTP')";}catch(u){}}var t=new Function("return new "+r);function s(w){var x=[];for(var v in w){if(v=="method"||v=="timeout"||v=="async"){continue;}if(!((typeof w[v]).toLowerCase()=="function"||(typeof w[v]).toLowerCase()=="object")){x.push(encodeURIComponent(v)+"="+encodeURIComponent(w[v]));}}return x.join("&");}return{request:function(w,y){var C=t(),z=false,x={method:"POST",timeout:5000,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof w==="object"){y=w;w=y.url;}if(!C||!w){return;}var B=y?p.extend(x,y):x;var E=s(B);if(!p.isEmptyObject(B.data)){E+=(E?"&":"")+s(B.data);}var D=setTimeout(function(){if(C.readyState!=4){z=true;C.abort();clearTimeout(D);}},B.timeout);var v=B.method.toUpperCase();var A=w+(w.indexOf("?")==-1?"?":"&")+(v=="POST"?"":E+"&noCache="+ +new Date);C.open(v,A,B.async);C.onreadystatechange=function(){if(C.readyState==4){if(!z&&C.status==200){B.onsuccess(C);}else{B.onerror(C);}}};if(v=="POST"){C.setRequestHeader("Content-Type","application/x-www-form-urlencoded");C.send(E);}else{C.send(null);}}};}();var i=UE.filterWord=function(){function t(u){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<v:)/ig.test(u);}function r(u){u=u.replace(/[\d.]+\w+/g,function(v){return p.transUnitToPx(v);});return u;}function s(u){return u.replace(/[\t\r\n]+/g,"").replace(/<!--[\s\S]*?-->/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(z){if(k.opera){return"";}try{var w=z.match(/width:([ \d.]*p[tx])/i)[1],v=z.match(/height:([ \d.]*p[tx])/i)[1],y=z.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+r(w)+'" height="'+r(v)+'" src="'+y+'" />';}catch(x){return"";}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)[\w-]+\2/ig,"").replace(/<(font|span)[^>]*>\s*<\/\1>/gi,"").replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(C,G,A,x){var y=[],F=x.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").split(/;\s*/g);for(var B=0,E;E=F[B];B++){var w,D,z=E.split(":");if(z.length==2){w=z[0].toLowerCase();D=z[1].toLowerCase();if(/^(background)\w*/.test(w)&&D.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(w)&&/^0\w+$/.test(D)){continue;}switch(w){case"mso-padding-alt":case"mso-padding-top-alt":case"mso-padding-right-alt":case"mso-padding-bottom-alt":case"mso-padding-left-alt":case"mso-margin-alt":case"mso-margin-top-alt":case"mso-margin-right-alt":case"mso-margin-bottom-alt":case"mso-margin-left-alt":case"mso-height":case"mso-width":case"mso-vertical-align-alt":if(!/<table/.test(G)){y[B]=w.replace(/^mso-|-alt$/g,"")+":"+r(D);}continue;case"horiz-align":y[B]="text-align:"+D;continue;case"vert-align":y[B]="vertical-align:"+D;continue;case"font-color":case"mso-foreground":y[B]="color:"+D;continue;case"mso-background":case"mso-highlight":y[B]="background:"+D;continue;case"mso-default-height":y[B]="min-height:"+r(D);continue;case"mso-default-width":y[B]="min-width:"+r(D);continue;case"mso-padding-between-alt":y[B]="border-collapse:separate;border-spacing:"+r(D);continue;case"text-line-through":if((D=="single")||(D=="double")){y[B]="text-decoration:line-through";}continue;case"mso-zero-height":if(D=="yes"){y[B]="display:none";}continue;case"background":if(D=="initial"){}break;case"margin":if(!/[1-9]/.test(D)){continue;}}if(/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(w)||/text\-indent|padding|margin/.test(w)&&/\-[\d.]+/.test(D)){continue;}y[B]=w+":"+z[1];}}return G+(y.length?' style="'+y.join(";").replace(/;{2,}/g,";")+'"':"");}).replace(/[\d.]+(cm|pt)/g,function(v){return p.transUnitToPx(v);});}return function(u){return(t(u)?s(u):u).replace(/>[ \t\r\n]*</g,"><");};}();UE.commands.inserthtml={execCommand:function(y,B,s){var E=this,C,r;if(!B){return;}C=E.selection.getRange();r=C.document.createElement("div");r.style.display="inline";var G=E.serialize;if(!s&&G){var v=G.parseHTML(B);v=G.transformInput(v);v=G.filter(v);B=G.toHTML(v);}r.innerHTML=p.trim(B);if(!C.collapsed){var u=C.startContainer;if(f.isFillChar(u)){C.setStartBefore(u);}u=C.endContainer;if(f.isFillChar(u)){C.setEndAfter(u);}C.txtToElmBoundary();if(C.endContainer&&C.endContainer.nodeType==1){u=C.endContainer.childNodes[C.endOffset];if(u&&f.isBr(u)){C.setEndAfter(u);}}if(C.startOffset==0){u=C.startContainer;if(f.isBoundaryNode(u,"firstChild")){u=C.endContainer;if(C.endOffset==(u.nodeType==3?u.nodeValue.length:u.childNodes.length)&&f.isBoundaryNode(u,"lastChild")){E.body.innerHTML="<p>"+(k.ie?"":"<br/>")+"</p>";C.setStart(E.body.firstChild,0).collapse(true);}}}!C.collapsed&&C.deleteContents();if(C.startContainer.nodeType==1){var t=C.startContainer.childNodes[C.startOffset],w;if(t&&f.isBlockElm(t)&&(w=t.previousSibling)&&f.isBlockElm(w)){C.setEnd(w,w.childNodes.length).collapse();while(t.firstChild){w.appendChild(t.firstChild);}f.remove(t);}}}var t,F,w,z,D=0,x;if(C.inFillChar()){t=C.startContainer;C.setStartBefore(t).collapse(true);f.remove(t);}while(t=r.firstChild){C.insertNode(t);x=t.nextSibling;if(!D&&t.nodeType==f.NODE_ELEMENT&&f.isBlockElm(t)){F=f.findParent(t,function(H){return f.isBlockElm(H);});if(F&&F.tagName.toLowerCase()!="body"&&!(a[F.tagName][t.nodeName]&&t.parentNode===F)){if(!a[F.tagName][t.nodeName]){w=F;}else{z=t.parentNode;while(z!==F){w=z;z=z.parentNode;}}f.breakParent(t,w||z);var w=t.previousSibling;f.trimWhiteTextNode(w);if(!w.childNodes.length){f.remove(w);}if(!k.ie&&(A=t.nextSibling)&&f.isBlockElm(A)&&A.lastChild&&!f.isBr(A.lastChild)){A.appendChild(E.document.createElement("br"));}D=1;}}var A=t.nextSibling;if(!r.firstChild&&A&&f.isBlockElm(A)){C.setStart(A,0).collapse(true);break;}C.setEndAfter(t).collapse();}t=C.startContainer;if(x&&f.isBr(x)){f.remove(x);}if(f.isBlockElm(t)&&f.isEmptyNode(t)){if(x=t.nextSibling){f.remove(t);if(x.nodeType==1&&a.$block[x.tagName]){C.setStart(x,0).collapse(true).shrinkBoundary();}}else{t.innerHTML=k.ie?f.fillChar:"<br/>";}}C.select(true);setTimeout(function(){C=E.selection.getRange();C.scrollToView(E.autoHeightEnabled,E.autoHeightEnabled?f.getXY(E.iframe).y:0);E.fireEvent("afterinserthtml");},200);}};UE.plugins.autotypeset=function(){this.setOpt({autotypeset:{mergeEmptyline:true,removeClass:true,removeEmptyline:false,textAlign:"left",imageBlockLine:"center",pasteFilter:false,clearFontSize:false,clearFontFamily:false,removeEmptyNode:false,removeTagNames:p.extend({div:1},a.$removeEmpty),indent:false,indentValue:"2em"}});var y=this,r=y.options.autotypeset,s={selectTdClass:1,pagebreak:1,anchorclass:1},t={li:1},z={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},v;if(!r){return;}function u(B,A){if(!B||B.nodeType==3){return 0;}if(f.isBr(B)){return 1;}if(B&&B.parentNode&&z[B.tagName.toLowerCase()]){if(v&&v.contains(B)||B.getAttribute("pagebreak")){return 0;}return A?!f.isEmptyBlock(B):f.isEmptyBlock(B);}}function w(A){if(!A.style.cssText){f.removeAttributes(A,["style"]);if(A.tagName.toLowerCase()=="span"&&f.hasNoAttributes(A)){f.remove(A,true);}}}function x(L,H){var K=this,O;if(H){if(!r.pasteFilter){return;}O=K.document.createElement("div");O.innerHTML=H.html;}else{O=K.document.body;}var A=f.getElementsByTagName(O,"*");for(var E=0,N;N=A[E++];){if(K.fireEvent("excludeNodeinautotype",N)===true){continue;}if(r.clearFontSize&&N.style.fontSize){f.removeStyle(N,"font-size");w(N);}if(r.clearFontFamily&&N.style.fontFamily){f.removeStyle(N,"font-family");w(N);}if(u(N)){if(r.mergeEmptyline){var G=N.nextSibling,B,J=f.isBr(N);while(u(G)){B=G;G=B.nextSibling;if(J&&(!G||G&&!f.isBr(G))){break;}f.remove(B);}}if(r.removeEmptyline&&f.inDoc(N,O)&&!t[N.parentNode.tagName.toLowerCase()]){if(f.isBr(N)){G=N.nextSibling;if(G&&!f.isBr(G)){continue;}}f.remove(N);continue;}}if(u(N,true)&&N.tagName!="SPAN"){if(r.indent){N.style.textIndent=r.indentValue;}if(r.textAlign){N.style.textAlign=r.textAlign;}}if(r.removeClass&&N.className&&!s[N.className.toLowerCase()]){if(v&&v.contains(N)){continue;}f.removeAttributes(N,["class"]);}if(r.imageBlockLine&&N.tagName.toLowerCase()=="img"&&!N.getAttribute("emotion")){if(H){var D=N;switch(r.imageBlockLine){case"left":case"right":case"none":var I=D.parentNode,B,C,G;while(a.$inline[I.tagName]||I.tagName=="A"){I=I.parentNode;}B=I;if(B.tagName=="P"&&f.getStyle(B,"text-align")=="center"){if(!f.isBody(B)&&f.getChildCount(B,function(P){return !f.isBr(P)&&!f.isWhitespace(P);})==1){C=B.previousSibling;G=B.nextSibling;if(C&&G&&C.nodeType==1&&G.nodeType==1&&C.tagName==G.tagName&&f.isBlockElm(C)){C.appendChild(B.firstChild);while(G.firstChild){C.appendChild(G.firstChild);}f.remove(B);f.remove(G);}else{f.setStyle(B,"text-align","");}}}f.setStyle(D,"float",r.imageBlockLine);break;case"center":if(K.queryCommandValue("imagefloat")!="center"){I=D.parentNode;f.setStyle(D,"float","none");B=D;while(I&&f.getChildCount(I,function(P){return !f.isBr(P)&&!f.isWhitespace(P);})==1&&(a.$inline[I.tagName]||I.tagName=="A")){B=I;I=I.parentNode;}var M=K.document.createElement("p");f.setAttributes(M,{style:"text-align:center"});B.parentNode.insertBefore(M,B);M.appendChild(B);f.setStyle(B,"float","");}}}else{var F=K.selection.getRange();F.selectNode(N).select();K.execCommand("imagefloat",r.imageBlockLine);}}if(r.removeEmptyNode){if(r.removeTagNames[N.tagName.toLowerCase()]&&f.hasNoAttributes(N)&&f.isEmptyBlock(N)){f.remove(N);}}}if(H){H.html=O.innerHTML;}}if(r.pasteFilter){y.addListener("beforepaste",x);}y.commands.autotypeset={execCommand:function(){y.removeListener("beforepaste",x);if(r.pasteFilter){y.addListener("beforepaste",x);}x.call(y);}};};UE.plugins.autosubmit=function(){var r=this;r.commands.autosubmit={execCommand:function(){var t=this,s=f.findParentByTagName(t.iframe,"form",false);if(s){if(t.fireEvent("beforesubmit")===false){return;}t.sync();s.submit();}}};r.addshortcutkey({autosubmit:"ctrl+13"});};UE.commands.imagefloat={execCommand:function(r,x){var z=this,w=z.selection.getRange();if(!w.collapsed){var u=w.getClosedNode();if(u&&u.tagName=="IMG"){switch(x){case"left":case"right":case"none":var y=u.parentNode,s,t,v;while(a.$inline[y.tagName]||y.tagName=="A"){y=y.parentNode;}s=y;if(s.tagName=="P"&&f.getStyle(s,"text-align")=="center"){if(!f.isBody(s)&&f.getChildCount(s,function(A){return !f.isBr(A)&&!f.isWhitespace(A);})==1){t=s.previousSibling;v=s.nextSibling;if(t&&v&&t.nodeType==1&&v.nodeType==1&&t.tagName==v.tagName&&f.isBlockElm(t)){t.appendChild(s.firstChild);while(v.firstChild){t.appendChild(v.firstChild);}f.remove(s);f.remove(v);}else{f.setStyle(s,"text-align","");}}w.selectNode(u).select();}f.setStyle(u,"float",x=="none"?"":x);if(x=="none"){f.removeAttributes(u,"align");}break;case"center":if(z.queryCommandValue("imagefloat")!="center"){y=u.parentNode;f.setStyle(u,"float","");f.removeAttributes(u,"align");s=u;while(y&&f.getChildCount(y,function(A){return !f.isBr(A)&&!f.isWhitespace(A);})==1&&(a.$inline[y.tagName]||y.tagName=="A")){s=y;y=y.parentNode;}w.setStartBefore(s).setCursor(false);y=z.document.createElement("div");y.appendChild(s);f.setStyle(s,"float","");z.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+y.innerHTML+"</p>");s=z.document.getElementById("_img_parent_tmp");s.removeAttribute("id");s=s.firstChild;w.selectNode(s).select();v=s.parentNode.nextSibling;if(v&&f.isEmptyNode(v)){f.remove(v);}}break;}}}},queryCommandValue:function(){var r=this.selection.getRange(),s,t;if(r.collapsed){return"none";}s=r.getClosedNode();if(s&&s.nodeType==1&&s.tagName=="IMG"){t=s.getAttribute("align")||f.getComputedStyle(s,"float");if(t=="none"){t=f.getComputedStyle(s.parentNode,"text-align")=="center"?"center":t;}return{left:1,right:1,center:1}[t]?t:"none";}return"none";},queryCommandState:function(){var r=this.selection.getRange(),s;if(r.collapsed){return -1;}s=r.getClosedNode();if(s&&s.nodeType==1&&s.tagName=="IMG"){return 0;}return -1;}};UE.commands.insertimage={execCommand:function(s,r){r=p.isArray(r)?r:[r];if(!r.length){return;}var z=this,x=z.selection.getRange(),u=x.getClosedNode();if(u&&/img/i.test(u.tagName)&&u.className!="edui-faked-video"&&!u.getAttribute("word_img")){var v=r.shift();var A=v.floatStyle;delete v.floatStyle;f.setAttributes(u,v);z.execCommand("imagefloat",A);if(r.length>0){x.setStartAfter(u).setCursor(false,true);z.execCommand("insertimage",r);}}else{var w=[],y="",B;B=r[0];if(r.length==1){y='<img src="'+B.src+'" '+(B.data_ue_src?' data_ue_src="'+B.data_ue_src+'" ':"")+(B.width?'width="'+B.width+'" ':"")+(B.height?' height="'+B.height+'" ':"")+(B.floatStyle=="left"||B.floatStyle=="right"?' style="float:'+B.floatStyle+';"':"")+(B.title&&B.title!=""?' title="'+B.title+'"':"")+(B.border&&B.border!="0"?' border="'+B.border+'"':"")+(B.alt&&B.alt!=""?' alt="'+B.alt+'"':"")+(B.hspace&&B.hspace!="0"?' hspace = "'+B.hspace+'"':"")+(B.vspace&&B.vspace!="0"?' vspace = "'+B.vspace+'"':"")+"/>";if(B.floatStyle=="center"){y='<p style="text-align: center">'+y+"</p>";}w.push(y);}else{for(var t=0;B=r[t++];){y="<p "+(B.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+B.src+'" '+(B.width?'width="'+B.width+'" ':"")+(B.data_ue_src?' data_ue_src="'+B.data_ue_src+'" ':"")+(B.height?' height="'+B.height+'" ':"")+' style="'+(B.floatStyle&&B.floatStyle!="center"?"float:"+B.floatStyle+";":"")+(B.border||"")+'" '+(B.title?' title="'+B.title+'"':"")+" /></p>";w.push(y);}}z.execCommand("insertHtml",w.join(""));}}};UE.plugins.justify=function(){var t=this,u=f.isBlockElm,s={left:1,right:1,center:1,justify:1},r=function(y,v){var B=y.createBookmark(),E=function(G){return G.nodeType==1?G.tagName.toLowerCase()!="br"&&!f.isBookmarkNode(G):!f.isWhitespace(G);};y.enlarge(true);var F=y.createBookmark(),A=f.getNextDomNode(F.start,false,E),C=y.cloneRange(),x;while(A&&!(f.getPosition(A,F.end)&f.POSITION_FOLLOWING)){if(A.nodeType==3||!u(A)){C.setStartBefore(A);while(A&&A!==F.end&&!u(A)){x=A;A=f.getNextDomNode(A,false,null,function(G){return !u(G);});}C.setEndAfter(x);var z=C.getCommonAncestor();if(!f.isBody(z)&&u(z)){f.setStyles(z,p.isString(v)?{"text-align":v}:v);A=z;}else{var w=y.document.createElement("p");f.setStyles(w,p.isString(v)?{"text-align":v}:v);var D=C.extractContents();w.appendChild(D);C.insertNode(w);A=w;}A=f.getNextDomNode(A,false,E);}else{A=f.getNextDomNode(A,true,E);}}return y.moveToBookmark(F).moveToBookmark(B);};UE.commands.justify={execCommand:function(x,y){var w=this.selection.getRange(),v;if(w.collapsed){v=this.document.createTextNode("p");w.insertNode(v);}r(w,y);if(v){w.setStartBefore(v).collapse(true);f.remove(v);}w.select();return true;},queryCommandValue:function(){var v=this.selection.getStart(),w=f.getComputedStyle(v,"text-align");return s[w]?w:"left";},queryCommandState:function(){var w=this.selection.getStart(),v=w&&f.findParentByTagName(w,["td","th","caption"],true);return v?-1:0;}};};UE.plugins.font=function(){var r=this,t={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",underline:"text-decoration",strikethrough:"text-decoration"};r.setOpt({fontfamily:[{name:"songti",val:",SimSun"},{name:"yahei",val:",Microsoft YaHei"},{name:"kaiti",val:",_GB2312, SimKai"},{name:"heiti",val:", SimHei"},{name:"lishu",val:", SimLi"},{name:"andaleMono",val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});for(var s in t){(function(v,u){UE.commands[v]={execCommand:function(x,A){A=A||(this.queryCommandState(x)?"none":x=="underline"?"underline":"line-through");var z=this,w=this.selection.getRange(),C;if(A=="default"){if(w.collapsed){C=z.document.createTextNode("font");w.insertNode(C).select();}z.execCommand("removeFormat","span,a",u);if(C){w.setStartBefore(C).setCursor();f.remove(C);}}else{if(!w.collapsed){if((v=="underline"||v=="strikethrough")&&z.queryCommandValue(v)){z.execCommand("removeFormat","span,a",u);}w=z.selection.getRange();w.applyInlineStyle("span",{style:u+":"+A}).select();}else{var y=f.findParentByTagName(w.startContainer,"span",true);C=z.document.createTextNode("font");if(y&&!y.children.length&&!y[k.ie?"innerText":"textContent"].replace(q,"").length){w.insertNode(C);if(v=="underline"||v=="strikethrough"){w.selectNode(C).select();z.execCommand("removeFormat","span,a",u,null);y=f.findParentByTagName(C,"span",true);w.setStartBefore(C);}y.style.cssText+=";"+u+":"+A;w.collapse(true).select();}else{w.insertNode(C);w.selectNode(C).select();y=w.document.createElement("span");if(v=="underline"||v=="strikethrough"){if(f.findParentByTagName(C,"a",true)){w.setStartBefore(C).setCursor();f.remove(C);return;}z.execCommand("removeFormat","span,a",u);}y.style.cssText=u+":"+A;C.parentNode.insertBefore(y,C);if(!k.ie||k.ie&&k.version==9){var B=y.parentNode;while(!f.isBlockElm(B)){if(B.tagName=="SPAN"){y.style.cssText=B.style.cssText+";"+y.style.cssText;}B=B.parentNode;}}if(e){setTimeout(function(){w.setStart(y,0).setCursor();});}else{w.setStart(y,0).setCursor();}}f.remove(C);}}return true;},queryCommandValue:function(x){var w=this.selection.getStart();if(x=="underline"||x=="strikethrough"){var y=w,z;while(y&&!f.isBlockElm(y)&&!f.isBody(y)){if(y.nodeType==1){z=f.getComputedStyle(y,u);if(z!="none"){return z;}}y=y.parentNode;}return"none";}return f.getComputedStyle(w,u);},queryCommandState:function(w){if(!(w=="underline"||w=="strikethrough")){return 0;}return this.queryCommandValue(w)==(w=="underline"?"underline":"line-through");}};})(s,t[s]);}};(function(){function r(u){var v=u.startContainer,t=u.endContainer;if(v=f.findParentByTagName(v,"a",true)){u.setStartBefore(v);}if(t=f.findParentByTagName(t,"a",true)){u.setEndAfter(t);}}UE.commands.unlink={execCommand:function(){var t=this.selection.getRange(),u;if(t.collapsed&&!f.findParentByTagName(t.startContainer,"a",true)){return;}u=t.createBookmark();r(t);t.removeInlineStyle("a").moveToBookmark(u).select();},queryCommandState:function(){return !this.highlight&&this.queryCommandValue("link")?0:-1;}};function s(u,v,x){var y=u.cloneRange(),w=x.queryCommandValue("link");r(u=u.adjustmentBoundary());var A=u.startContainer;if(A.nodeType==1&&w){A=A.childNodes[u.startOffset];if(A&&A.nodeType==1&&A.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(A[k.ie?"innerText":"textContent"])){A[k.ie?"innerText":"textContent"]=p.html(v.textValue||v.href);}}if(!y.collapsed||w){u.removeInlineStyle("a");y=u.cloneRange();}if(y.collapsed){var t=u.document.createElement("a"),z="";if(v.textValue){z=p.html(v.textValue);delete v.textValue;}else{z=p.html(v.href);}f.setAttributes(t,v);A=f.findParentByTagName(y.startContainer,"a",true);if(A&&f.isInNodeEndBoundary(y,A)){u.setStartAfter(A).collapse(true);}t[k.ie?"innerText":"textContent"]=z;u.insertNode(t).selectNode(t);}else{u.applyInlineStyle("a",v);}}UE.commands.link={execCommand:function(u,v){var t;v.data_ue_src&&(v.data_ue_src=p.unhtml(v.data_ue_src,/[<">]/g));v.href&&(v.href=p.unhtml(v.href,/[<">]/g));v.textValue&&(v.textValue=p.unhtml(v.textValue,/[<">]/g));s(t=this.selection.getRange(),v,this);t.collapse().select(true);},queryCommandValue:function(){var z=this.selection.getRange(),v;if(z.collapsed){v=z.startContainer;v=v.nodeType==1?v:v.parentNode;if(v&&(v=f.findParentByTagName(v,"a",true))&&!f.isInNodeEndBoundary(z,v)){return v;}}else{z.shrinkBoundary();var u=z.startContainer.nodeType==3||!z.startContainer.childNodes[z.startOffset]?z.startContainer:z.startContainer.childNodes[z.startOffset],x=z.endContainer.nodeType==3||z.endOffset==0?z.endContainer:z.endContainer.childNodes[z.endOffset-1],A=z.getCommonAncestor();v=f.findParentByTagName(A,"a",true);if(!v&&A.nodeType==1){var w=A.getElementsByTagName("a"),t,B;for(var y=0,C;C=w[y++];){t=f.getPosition(C,u),B=f.getPosition(C,x);if((t&f.POSITION_FOLLOWING||t&f.POSITION_CONTAINS)&&(B&f.POSITION_PRECEDING||B&f.POSITION_CONTAINS)){v=C;break;}}}return v;}},queryCommandState:function(){var u=this.selection.getRange().getClosedNode(),t=u&&(u.className=="edui-faked-video");return t?-1:0;}};})();UE.plugins.removeformat=function(){var r=this;r.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});r.commands.removeformat={execCommand:function(D,F,s,B,C){var x=new RegExp("^(?:"+(F||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),w=s?[]:(B||this.options.removeFormatAttributes).split(","),y=new h.Range(this.document),z,v,A,t=function(G){return G.nodeType==1;};function u(J){if(J.nodeType==3||J.tagName.toLowerCase()!="span"){return 0;}if(k.ie){var H=J.attributes;if(H.length){for(var I=0,G=H.length;I<G;I++){if(H[I].specified){return 0;}}return 1;}}return !J.attributes.length;}function E(M){var G=M.createBookmark();if(M.collapsed){M.enlarge(true);}if(!C){var H=f.findParentByTagName(M.startContainer,"a",true);if(H){M.setStartBefore(H);}H=f.findParentByTagName(M.endContainer,"a",true);if(H){M.setEndAfter(H);}}z=M.createBookmark();I=z.start;while((A=I.parentNode)&&!f.isBlockElm(A)){f.breakParent(I,A);f.clearEmptySibling(I);}if(z.end){I=z.end;while((A=I.parentNode)&&!f.isBlockElm(A)){f.breakParent(I,A);f.clearEmptySibling(I);}var N=f.getNextDomNode(z.start,false,t),L;while(N){if(N==z.end){break;}L=f.getNextDomNode(N,true,t);if(!a.$empty[N.tagName.toLowerCase()]&&!f.isBookmarkNode(N)){if(x.test(N.tagName)){if(s){f.removeStyle(N,s);if(u(N)&&s!="text-decoration"){f.remove(N,true);}}else{f.remove(N,true);}}else{if(!a.$tableContent[N.tagName]&&!a.$list[N.tagName]){f.removeAttributes(N,w);if(u(N)){f.remove(N,true);}}}}N=L;}}var O=z.start.parentNode;if(f.isBlockElm(O)&&!a.$tableContent[O.tagName]&&!a.$list[O.tagName]){f.removeAttributes(O,w);}O=z.end.parentNode;if(z.end&&f.isBlockElm(O)&&!a.$tableContent[O.tagName]&&!a.$list[O.tagName]){f.removeAttributes(O,w);}M.moveToBookmark(z).moveToBookmark(G);var I=M.startContainer,K,J=M.collapsed;while(I.nodeType==1&&f.isEmptyNode(I)&&a.$removeEmpty[I.tagName]){K=I.parentNode;M.setStartBefore(I);if(M.startContainer===M.endContainer){M.endOffset--;}f.remove(I);I=K;}if(!J){I=M.endContainer;while(I.nodeType==1&&f.isEmptyNode(I)&&a.$removeEmpty[I.tagName]){K=I.parentNode;M.setEndBefore(I);f.remove(I);I=K;}}}y=this.selection.getRange();E(y);y.select();}};};UE.plugins.blockquote=function(){var r=this;function s(t){return f.filterNodeList(t.selection.getStartElementPath(),"blockquote");}r.commands.blockquote={execCommand:function(D,H){var G=this.selection.getRange(),F=s(this),u=a.blockquote,C=G.createBookmark();if(F){var A=G.startContainer,B=f.isBlockElm(A)?A:f.findParent(A,function(M){return f.isBlockElm(M);}),w=G.endContainer,x=f.isBlockElm(w)?w:f.findParent(w,function(M){return f.isBlockElm(M);});B=f.findParentByTagName(B,"li",true)||B;x=f.findParentByTagName(x,"li",true)||x;if(B.tagName=="LI"||B.tagName=="TD"||B===F){f.remove(F,true);}else{f.breakParent(B,F);}if(B!==x){F=f.findParentByTagName(x,"blockquote");if(F){if(x.tagName=="LI"||x.tagName=="TD"){f.remove(F,true);}else{f.breakParent(x,F);}}}var z=f.getElementsByTagName(this.document,"blockquote");for(var K=0,v;v=z[K++];){if(!v.childNodes.length){f.remove(v);}else{if(f.getPosition(v,B)&f.POSITION_FOLLOWING&&f.getPosition(v,x)&f.POSITION_PRECEDING){f.remove(v,true);}}}}else{var L=G.cloneRange(),I=L.startContainer.nodeType==1?L.startContainer:L.startContainer.parentNode,t=I,J=1;while(1){if(f.isBody(I)){if(t!==I){if(G.collapsed){L.selectNode(t);J=0;}else{L.setStartBefore(t);}}else{L.setStart(I,0);}break;}if(!u[I.tagName]){if(G.collapsed){L.selectNode(t);}else{L.setStartBefore(t);}break;}t=I;I=I.parentNode;}if(J){t=I=I=L.endContainer.nodeType==1?L.endContainer:L.endContainer.parentNode;while(1){if(f.isBody(I)){if(t!==I){L.setEndAfter(t);}else{L.setEnd(I,I.childNodes.length);}break;}if(!u[I.tagName]){L.setEndAfter(t);break;}t=I;I=I.parentNode;}}I=G.document.createElement("blockquote");f.setAttributes(I,H);I.appendChild(L.extractContents());L.insertNode(I);var y=f.getElementsByTagName(I,"blockquote");for(var K=0,E;E=y[K++];){if(E.parentNode){f.remove(E,true);}}}G.moveToBookmark(C).select();},queryCommandState:function(){return s(this)?1:0;}};};UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(w){var v=this;var t=v.selection.getRange();if(t.collapsed){return t;}var s=t.createBookmark(),r=s.end,x=function(y){return !f.isBr(y)&&!f.isWhitespace(y);},u=f.getNextDomNode(s.start,false,x);while(u&&(f.getPosition(u,r)&f.POSITION_PRECEDING)){if(u.nodeType==3){u.nodeValue=u.nodeValue[w=="touppercase"?"toUpperCase":"toLowerCase"]();}u=f.getNextDomNode(u,true,x);if(u===r){break;}}t.moveToBookmark(s).select();}};UE.commands.indent={execCommand:function(){var r=this,s=r.queryCommandState("indent")?"0em":(r.options.indentValue||"2em");r.execCommand("Paragraph","p",{style:"text-indent:"+s});},queryCommandState:function(){var r=f.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return r&&r.style.textIndent&&parseInt(r.style.textIndent)?1:0;}};UE.commands.print={execCommand:function(){this.window.print();},notNeedUndo:1};UE.commands.preview={execCommand:function(){var r=window.open("","_blank",""),s=r.document;s.open();s.write('<html><head><script src="'+this.options.UEDITOR_HOME_URL+"uparse.js\"><\/script><script>setTimeout(function(){uParse('div',{    'highlightJsUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js',    'highlightCssUrl':'"+this.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css'})},300)<\/script></head><body><div>"+this.getContent(null,null,true)+"</div></body></html>");s.close();},notNeedUndo:1};UE.plugins.selectall=function(){var r=this;r.commands.selectall={execCommand:function(){var v=this,t=v.body,u=v.selection.getRange();u.selectNodeContents(t);if(f.isEmptyBlock(t)){if(k.opera&&t.firstChild&&t.firstChild.nodeType==1){u.setStartAtFirst(t.firstChild);}u.collapse(true);}u.select(true);},notNeedUndo:1};function s(v,t){var u;while(!f.isBody(v)){u=v;v=v.parentNode;if(u!==v[t]){return false;}}return true;}r.addListener("keydown",function(w,u){var t=r.selection.getRange();if(!t.collapsed&&!(u.ctrlKey||u.metaKey||u.shiftKey||u.altKey)){var v=t.startContainer;if(f.isFillChar(v)){t.setStartBefore(v);}v=t.endContainer;if(f.isFillChar(v)){t.setEndAfter(v);}t.txtToElmBoundary();if(t.startOffset==0){v=t.startContainer;if(s(v,"firstChild")){v=t.endContainer;if(t.endOffset==t.endContainer.childNodes.length&&s(v,"lastChild")){r.fireEvent("saveScene");r.body.innerHTML="<p>"+(k.ie?"":"<br/>")+"</p>";t.setStart(r.body.firstChild,0).setCursor(false,true);r.fireEvent("saveScene");k.ie&&r._selectionChange();return;}}}}});r.addshortcutkey({selectAll:"ctrl+65"});};UE.plugins.paragraph=function(){var s=this,u=f.isBlockElm,t=["TD","LI","PRE"],r=function(x,v,D,A){var z=x.createBookmark(),E=function(H){return H.nodeType==1?H.tagName.toLowerCase()!="br"&&!f.isBookmarkNode(H):!f.isWhitespace(H);},G;x.enlarge(true);var F=x.createBookmark(),y=f.getNextDomNode(F.start,false,E),C=x.cloneRange(),w;while(y&&!(f.getPosition(y,F.end)&f.POSITION_FOLLOWING)){if(y.nodeType==3||!u(y)){C.setStartBefore(y);while(y&&y!==F.end&&!u(y)){w=y;y=f.getNextDomNode(y,false,null,function(H){return !u(H);});}C.setEndAfter(w);G=x.document.createElement(v);if(D){f.setAttributes(G,D);if(A&&A=="customstyle"&&D.style){G.style.cssText=D.style;}}G.appendChild(C.extractContents());if(f.isEmptyNode(G)){f.fillChar(x.document,G);}C.insertNode(G);var B=G.parentNode;if(u(B)&&!f.isBody(G.parentNode)&&p.indexOf(t,B.tagName)==-1){if(!(A&&A=="customstyle")){B.getAttribute("dir")&&G.setAttribute("dir",B.getAttribute("dir"));B.style.cssText&&(G.style.cssText=B.style.cssText+";"+G.style.cssText);B.style.textAlign&&!G.style.textAlign&&(G.style.textAlign=B.style.textAlign);B.style.textIndent&&!G.style.textIndent&&(G.style.textIndent=B.style.textIndent);B.style.padding&&!G.style.padding&&(G.style.padding=B.style.padding);}if(D&&/h\d/i.test(B.tagName)&&!/h\d/i.test(G.tagName)){f.setAttributes(B,D);if(A&&A=="customstyle"&&D.style){B.style.cssText=D.style;}f.remove(G,true);G=B;}else{f.remove(G.parentNode,true);}}if(p.indexOf(t,B.tagName)!=-1){y=B;}else{y=G;}y=f.getNextDomNode(y,false,E);}else{y=f.getNextDomNode(y,true,E);}}return x.moveToBookmark(F).moveToBookmark(z);};s.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});s.commands.paragraph={execCommand:function(z,A,y,x){var w=this.selection.getRange();if(w.collapsed){var v=this.document.createTextNode("p");w.insertNode(v);if(k.ie){var B=v.previousSibling;if(B&&f.isWhitespace(B)){f.remove(B);}B=v.nextSibling;if(B&&f.isWhitespace(B)){f.remove(B);}}}w=r(w,A,y,x);if(v){w.setStartBefore(v).collapse(true);pN=v.parentNode;f.remove(v);if(f.isBlockElm(pN)&&f.isEmptyNode(pN)){f.fillNode(this.document,pN);}}if(k.gecko&&w.collapsed&&w.startContainer.nodeType==1){var C=w.startContainer.childNodes[w.startOffset];if(C&&C.nodeType==1&&C.tagName.toLowerCase()==A){w.setStart(C,0).collapse(true);}}w.select();return true;},queryCommandValue:function(){var v=f.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return v?v.tagName.toLowerCase():"";}};};(function(){var t=f.isBlockElm,s=function(u){return f.filterNodeList(u.selection.getStartElementPath(),function(v){return v.getAttribute("dir");});},r=function(y,z,x){var C,F=function(H){return H.nodeType==1?!f.isBookmarkNode(H):!f.isWhitespace(H);},w=s(z);if(w&&y.collapsed){w.setAttribute("dir",x);return y;}C=y.createBookmark();y.enlarge(true);var G=y.createBookmark(),B=f.getNextDomNode(G.start,false,F),D=y.cloneRange(),v;while(B&&!(f.getPosition(B,G.end)&f.POSITION_FOLLOWING)){if(B.nodeType==3||!t(B)){D.setStartBefore(B);while(B&&B!==G.end&&!t(B)){v=B;B=f.getNextDomNode(B,false,null,function(H){return !t(H);});}D.setEndAfter(v);var A=D.getCommonAncestor();if(!f.isBody(A)&&t(A)){A.setAttribute("dir",x);B=A;}else{var u=y.document.createElement("p");u.setAttribute("dir",x);var E=D.extractContents();u.appendChild(E);D.insertNode(u);B=u;}B=f.getNextDomNode(B,false,F);}else{B=f.getNextDomNode(B,true,F);}}return y.moveToBookmark(G).moveToBookmark(C);};UE.commands.directionality={execCommand:function(x,w){var v=this.selection.getRange();if(v.collapsed){var u=this.document.createTextNode("d");v.insertNode(u);}r(v,this,w);if(u){v.setStartBefore(u).collapse(true);f.remove(u);}v.select();return true;},queryCommandValue:function(){var u=s(this);return u?u.getAttribute("dir"):"ltr";}};})();UE.commands.horizontal={execCommand:function(s){var u=this;if(u.queryCommandState(s)!==-1){u.execCommand("insertHtml","<hr>");var r=u.selection.getRange(),v=r.startContainer;if(v.nodeType==1&&!v.childNodes[r.startOffset]){var t;if(t=v.childNodes[r.startOffset-1]){if(t.nodeType==1&&t.tagName=="HR"){if(u.options.enterTag=="p"){t=u.document.createElement("p");r.insertNode(t);r.setStart(t,0).setCursor();}else{t=u.document.createElement("br");r.insertNode(t);r.setStartBefore(t).setCursor();}}}}return true;}},queryCommandState:function(){return f.filterNodeList(this.selection.getStartElementPath(),"table")?-1:0;}};UE.commands.time=UE.commands.date={execCommand:function(s){var r=new Date;this.execCommand("insertHtml",s=="time"?(r.getHours()+":"+(r.getMinutes()<10?"0"+r.getMinutes():r.getMinutes())+":"+(r.getSeconds()<10?"0"+r.getSeconds():r.getSeconds())):(r.getFullYear()+"-"+((r.getMonth()+1)<10?"0"+(r.getMonth()+1):r.getMonth()+1)+"-"+(r.getDate()<10?"0"+r.getDate():r.getDate())));}};UE.plugins.rowspacing=function(){var r=this;r.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});r.commands.rowspacing={execCommand:function(t,u,s){this.execCommand("paragraph","p",{style:"margin-"+s+":"+u+"px"});return true;},queryCommandValue:function(u,t){var s=f.filterNodeList(this.selection.getStartElementPath(),function(w){return f.isBlockElm(w);}),v;if(s){v=f.getComputedStyle(s,"margin-"+t).replace(/[^\d]/g,"");return !v?0:v;}return 0;}};};UE.plugins.lineheight=function(){var r=this;r.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});r.commands.lineheight={execCommand:function(s,t){this.execCommand("paragraph","p",{style:"line-height:"+(t=="1"?"normal":t+"em")});return true;},queryCommandValue:function(){var s=f.filterNodeList(this.selection.getStartElementPath(),function(u){return f.isBlockElm(u);});if(s){var t=f.getComputedStyle(s,"line-height");return t=="normal"?1:t.replace(/[^\d.]*/ig,"");}}};};UE.commands.cleardoc={execCommand:function(t){var u=this,s=u.options.enterTag,r=u.selection.getRange();if(s=="br"){u.body.innerHTML="<br/>";r.setStart(u.body,0).setCursor();}else{u.body.innerHTML="<p>"+(b?"":"<br/>")+"</p>";r.setStart(u.body.firstChild,0).setCursor(false,true);}u.fireEvent("clearDoc");}};UE.plugins.anchor=function(){var r=this;r.ready(function(){p.cssRule("anchor",".anchorclass{background: url('"+r.options.UEDITOR_HOME_URL+"themes/default/images/anchor.gif') no-repeat scroll left center transparent;border: 1px dotted #0000FF;cursor: auto;display: inline-block;height: 16px;width: 15px;}",r.document);});r.commands.anchor={execCommand:function(w,v){var t=this.selection.getRange(),s=t.getClosedNode();if(s&&s.getAttribute("anchorname")){if(v){s.setAttribute("anchorname",v);}else{t.setStartBefore(s).setCursor();f.remove(s);}}else{if(v){var u=this.document.createElement("img");t.collapse(true);f.setAttributes(u,{anchorname:v,"class":"anchorclass"});t.insertNode(u).setStartAfter(u).setCursor(false,true);}}}};};UE.plugins.wordcount=function(){var r=this;r.addListener("contentchange",function(){r.fireEvent("wordcount");});var s;r.addListener("keyup",function(){clearTimeout(s);var t=this;s=setTimeout(function(){t.fireEvent("wordcount");},200);});};UE.plugins.pagebreak=function(){var u=this,s=["td"];function r(w){if(f.isEmptyBlock(w)){var x=w.firstChild,v;while(x&&x.nodeType==1&&f.isEmptyBlock(x)){v=x;x=x.firstChild;}!v&&(v=w);f.fillNode(u.document,v);}}u.ready(function(){p.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",u.document);});function t(v){return v&&v.nodeType==1&&v.tagName=="HR"&&v.className=="pagebreak";}u.commands.pagebreak={execCommand:function(){var A=u.selection.getRange(),D=u.document.createElement("hr");f.setAttributes(D,{"class":"pagebreak",noshade:"noshade",size:"5"});f.unSelectable(D);var x=f.findParentByTagName(A.startContainer,s,true),C=[],B;if(x){switch(x.tagName){case"TD":B=x.parentNode;if(!B.previousSibling){var E=f.findParentByTagName(B,"table");E.parentNode.insertBefore(D,E);C=f.findParents(D,true);}else{B.parentNode.insertBefore(D,B);C=f.findParents(D);}B=C[1];if(D!==B){f.breakParent(D,B);}u.fireEvent("afteradjusttable",u.document);}}else{if(!A.collapsed){A.deleteContents();var w=A.startContainer;while(!f.isBody(w)&&f.isBlockElm(w)&&f.isEmptyNode(w)){A.setStartBefore(w).collapse(true);f.remove(w);w=A.startContainer;}}A.insertNode(D);var B=D.parentNode,z;while(!f.isBody(B)){f.breakParent(D,B);z=D.nextSibling;if(z&&f.isEmptyBlock(z)){f.remove(z);}B=D.parentNode;}z=D.nextSibling;var y=D.previousSibling;if(t(y)){f.remove(y);}else{y&&r(y);}if(!z){var v=u.document.createElement("p");D.parentNode.appendChild(v);f.fillNode(u.document,v);A.setStart(v,0).collapse(true);}else{if(t(z)){f.remove(z);}else{r(z);}A.setEndAfter(D).collapse(false);}A.select(true);}}};};UE.plugins.undo=function(){var z=this,D=z.options.maxUndoCount||20,y=z.options.maxInputCount||20,u=new RegExp(f.fillChar+"|</hr>","gi");function w(H,G){if(H.length!=G.length){return 0;}for(var F=0,E=H.length;F<E;F++){if(H[F]!=G[F]){return 0;}}return 1;}function A(F,E){if(F.collapsed!=E.collapsed){return 0;}if(!w(F.startAddress,E.startAddress)||!w(F.endAddress,E.endAddress)){return 0;}return 1;}function B(E){var F=/\b(?:href|src|name)="[^"]*?"/gi;return E.replace(F,"").replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(H,G,I){return G.toLowerCase()+"="+I.replace(/['"]/g,"").toLowerCase();}).replace(/(<[\w\-]+)|([\w\-]+>)/gi,function(H,G,I){return(G||I).toLowerCase();});}function s(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.undo=function(){if(this.hasUndo){var H=this.getScene(),F=this.list[this.index],E=B(F.content),G=B(H.content);if(E!=G){this.save();}if(!this.list[this.index-1]&&this.list.length==1){this.reset();return;}while(this.list[this.index].content==this.list[this.index-1].content){this.index--;if(this.index==0){return this.restore(0);}}this.restore(--this.index);}};this.redo=function(){if(this.hasRedo){while(this.list[this.index].content==this.list[this.index+1].content){this.index++;if(this.index==this.list.length-1){return this.restore(this.index);}}this.restore(++this.index);}};this.restore=function(){var E=this.list[this.index];z.document.body.innerHTML=E.content.replace(u,"");if(k.ie){p.each(f.getElementsByTagName(z.document,"td th caption p"),function(F){if(f.isEmptyNode(F)){f.fillNode(z.document,F);}});}new h.Range(z.document).moveToAddress(E.address).select();this.update();this.clearKey();z.fireEvent("reset",true);};this.getScene=function(){var F=z.selection.getRange(),G=F.createAddress(),I=F.createAddress(false,true);z.fireEvent("beforegetscene");var E=z.body.innerHTML.replace(u,"");k.ie&&(E=E.replace(/>&nbsp;</g,"><").replace(/\s*</g,"<").replace(/>\s*/g,">"));z.fireEvent("aftergetscene");try{F.moveToAddress(G).select(true);}catch(H){}return{address:I,content:E};};this.save=function(G){var F=this.getScene(),E=this.list[this.index];if(E&&E.content==F.content&&(G?1:A(E.address,F.address))){return;}this.list=this.list.slice(0,this.index+1);this.list.push(F);if(this.list.length>D){this.list.shift();}this.index=this.list.length-1;this.clearKey();this.update();};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1];};this.reset=function(){this.list=[];this.index=0;this.hasUndo=false;this.hasRedo=false;this.clearKey();};this.clearKey=function(){v=0;r=null;};}z.undoManger=new s();function x(){this.undoManger.save();}z.addListener("saveScene",function(){z.undoManger.save();});z.addListener("beforeexeccommand",x);z.addListener("afterexeccommand",x);z.addListener("reset",function(F,E){if(!E){z.undoManger.reset();}});z.commands.redo=z.commands.undo={execCommand:function(E){z.undoManger[E]();},queryCommandState:function(E){return z.undoManger["has"+(E.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1;},notNeedUndo:1};var C={16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},v=0,r;var t=false;z.addListener("ready",function(){f.on(z.body,"compositionstart",function(){t=true;});f.on(z.body,"compositionend",function(){t=false;});});z.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});z.addListener("keydown",function(F,E){var G=E.keyCode||E.which;if(!C[G]&&!E.ctrlKey&&!E.metaKey&&!E.shiftKey&&!E.altKey){if(t){return;}if(z.undoManger.list.length==0||((G==8||G==46)&&r!=G)){z.fireEvent("contentchange");z.undoManger.save(true);r=G;return;}if(z.undoManger.list.length==2&&z.undoManger.index==0&&v==0){z.undoManger.list.splice(1,1);z.undoManger.update();}r=G;v++;if(v>=y||z.undoManger.mousedown){if(z.selection.getRange().collapsed){z.fireEvent("contentchange");}z.undoManger.save();z.undoManger.mousedown=false;}}});z.addListener("mousedown",function(){z.undoManger.mousedown=true;});};(function(){function r(w){var u=this.document;if(u.getElementById("baidu_pastebin")){return;}var t=this.selection.getRange(),s=t.createBookmark(),v=u.createElement("div");v.id="baidu_pastebin";k.webkit&&v.appendChild(u.createTextNode(f.fillChar+f.fillChar));u.body.appendChild(v);s.start.style.display="";v.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+f.getXY(s.start).y+"px";t.selectNodeContents(v).select(true);setTimeout(function(){if(k.webkit){for(var x=0,y=u.querySelectorAll("#baidu_pastebin"),A;A=y[x++];){if(f.isEmptyNode(A)){f.remove(A);}else{v=A;break;}}}try{v.parentNode.removeChild(v);}catch(z){}t.moveToBookmark(s).select(true);w(v);},0);}UE.plugins.paste=function(){var y=this;var x={flag:""};var w=y.options.pasteplain===true;var s={flag:""};y.commands.pasteplain={queryCommandState:function(){return w;},execCommand:function(){w=!w|0;},notNeedUndo:1};var v,z,t;function u(J){var I;if(J.firstChild){var M=f.getElementsByTagName(J,"span");for(var P=0,D;D=M[P++];){if(D.id=="_baidu_cut_start"||D.id=="_baidu_cut_end"){f.remove(D);}}if(k.webkit){var K=J.querySelectorAll("div br");for(var P=0,B;B=K[P++];){var H=B.parentNode;if(H.tagName=="DIV"&&H.childNodes.length==1){H.innerHTML="<p><br/></p>";f.remove(H);}}var O=J.querySelectorAll("#baidu_pastebin");for(var P=0,Q;Q=O[P++];){var T=y.document.createElement("p");Q.parentNode.insertBefore(T,Q);while(Q.firstChild){T.appendChild(Q.firstChild);}f.remove(Q);}var A=J.querySelectorAll("meta");for(var P=0,G;G=A[P++];){f.remove(G);}var K=J.querySelectorAll("br");for(P=0;G=K[P++];){if(/^apple-/.test(G)){f.remove(G);}}p.each(f.getElementsByTagName(J,"span",function(U){if(U.style.cssText){U.style.cssText=U.style.cssText.replace(/white-space[^;]+;/g,"");if(!U.style.cssText){f.removeAttributes(U,"style");if(f.hasNoAttributes(U)){return 1;}}}return 0;}),function(U){f.remove(U,true);});}if(k.gecko){var L=J.querySelectorAll("[_moz_dirty]");for(P=0;G=L[P++];){G.removeAttribute("_moz_dirty");}}if(!k.ie){var F=J.querySelectorAll("span.Apple-style-span");for(var P=0,G;G=F[P++];){f.remove(G,true);}}I=J.innerHTML.replace(/>(?:(\s|&nbsp;)*?)</g,"><");var R=y.serialize;if(R){try{I=UE.filterWord(I);var N=R.transformInput(R.parseHTML(I),x);N=R.filter(N,w?{whiteList:{p:{br:1,BR:1,$:{}},br:{"$":{}},div:{br:1,BR:1,"$":{}},li:{"$":{}},tr:{td:1,"$":{}},td:{"$":{}}},blackList:{style:1,script:1,object:1}}:null,!w?s:null);if(k.webkit){var C=N.children.length,E;while((E=N.children[C-1])&&E.tag=="br"){N.children.splice(C-1,1);C=N.children.length;}}I=R.toHTML(N,w);v=R.filter(N,{whiteList:{p:{br:1,BR:1,$:{}},br:{"$":{}},div:{br:1,BR:1,"$":{},table:1,ul:1,ol:1},li:{"$":{}},ul:{li:1,"$":{}},ol:{li:1,"$":{}},tr:{td:1,"$":{}},td:{"$":{}},table:{tr:1,tbody:1,td:1,"$":{}},tbody:{tr:1,td:1,"$":{}},h1:{"$":{}},h2:{"$":{}},h3:{"$":{}},h4:{"$":{}},h5:{"$":{}},h6:{"$":{}}},blackList:{style:1,script:1,object:1}});v=R.toHTML(v,true);}catch(S){}}I={html:I,txtContent:v};y.fireEvent("beforepaste",I);if(I.html){z=I.html;t=y.selection.getRange().createAddress(true);y.execCommand("insertHtml",z,true);y.fireEvent("afterpaste");}}}y.addListener("pasteTransfer",function(D,A){if(t&&v&&z&&v!=z){var B=y.selection.getRange();B.moveToAddress(t,true).deleteContents();B.select(true);y.__hasEnterExecCommand=true;var C=z;if(A===2){C=C.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(G,F,I,H){I=I.toLowerCase();if({img:1}[I]){return G;}H=H.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(L,J,K){if({src:1,href:1,name:1}[J.toLowerCase()]){return J+"="+K+" ";}return"";});if({span:1,div:1}[I]){return"";}else{return"<"+F+I+" "+p.trim(H)+">";}});}else{if(A){C=v;}}y.execCommand("inserthtml",C,true);y.__hasEnterExecCommand=false;var E=y.selection.getRange().createAddress(true);t.endAddress=E.startAddress;}});y.addListener("ready",function(){f.on(y.body,"cut",function(){var A=y.selection.getRange();if(!A.collapsed&&y.undoManger){y.undoManger.save();}});f.on(y.body,k.ie||k.opera?"keydown":"paste",function(A){if((k.ie||k.opera)&&((!A.ctrlKey&&!A.metaKey)||A.keyCode!="86")){return;}r.call(y,function(B){u(B);});});});};})();UE.plugins.list=function(){var x=this,t={TD:1,PRE:1,BLOCKQUOTE:1};var y={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};x.setOpt({insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:3});var r=x.options.listiconpath;for(var z in y){if(!x.options.insertorderedlist.hasOwnProperty(z)&&!x.options.insertunorderedlist.hasOwnProperty(z)){delete y[z];}}x.ready(function(){var C=[];for(var B in y){if(B=="dash"||B=="dot"){C.push("li.list-"+y[B]+"{background-image:url("+r+y[B]+".gif)}");C.push("ul.custom_"+B+"{list-style:none;}ul.custom_"+B+" li{background-position:0 3px;background-repeat:no-repeat}");}else{for(var s=0;s<99;s++){C.push("li.list-"+y[B]+s+"{background-image:url("+r+"list-"+y[B]+s+".gif)}");}C.push("ol.custom_"+B+"{list-style:none;}ol.custom_"+B+" li{background-position:0 3px;background-repeat:no-repeat}");}switch(B){case"cn":C.push("li.list-"+B+"-paddingleft-1{padding-left:25px}");C.push("li.list-"+B+"-paddingleft-2{padding-left:40px}");C.push("li.list-"+B+"-paddingleft-3{padding-left:55px}");break;case"cn1":C.push("li.list-"+B+"-paddingleft-1{padding-left:30px}");C.push("li.list-"+B+"-paddingleft-2{padding-left:40px}");C.push("li.list-"+B+"-paddingleft-3{padding-left:55px}");break;case"cn2":C.push("li.list-"+B+"-paddingleft-1{padding-left:40px}");C.push("li.list-"+B+"-paddingleft-2{padding-left:55px}");C.push("li.list-"+B+"-paddingleft-3{padding-left:68px}");break;case"num":case"num1":C.push("li.list-"+B+"-paddingleft-1{padding-left:25px}");break;case"num2":C.push("li.list-"+B+"-paddingleft-1{padding-left:35px}");C.push("li.list-"+B+"-paddingleft-2{padding-left:40px}");break;case"dash":C.push("li.list-"+B+"-paddingleft{padding-left:35px}");break;case"dot":C.push("li.list-"+B+"-paddingleft{padding-left:20px}");}}C.push(".list-paddingleft-1{padding-left:0}");C.push(".list-paddingleft-2{padding-left:"+x.options.listDefaultPaddingLeft+"px}");C.push(".list-paddingleft-3{padding-left:"+x.options.listDefaultPaddingLeft*2+"px}");p.cssRule("list","ol,ul{margin:0;pading:0;"+(k.ie?"":"width:95%")+"}li{clear:both;}"+C.join("\n"),x.document);});function w(B){var s=B.className;if(f.hasClass(B,/custom_/)){return s.match(/custom_(\w+)/)[1];}return"";}x.addListener("contentchange",function(){p.each(f.getElementsByTagName(x.document,"ol ul"),function(D){if(!f.inDoc(D,x.document)){return;}var s=0,C=2,B=D.parentNode;if(f.hasClass(D,/custom_/)){if(!(/[ou]l/i.test(B.tagName)&&f.hasClass(B,/custom_/))){C=1;}}else{if(/[ou]l/i.test(B.tagName)&&f.hasClass(B,/custom_/)){C=3;}}style=f.getStyle(D,"list-style-type");D.style.cssText=style?"list-style-type:"+style:"";D.className=p.trim(D.className.replace(/list-paddingleft-\w+/,""))+" list-paddingleft-"+C;p.each(f.getElementsByTagName(D,"li"),function(E){E.style.cssText&&(E.style.cssText="");if(!E.firstChild){f.remove(E);return;}if(E.parentNode!==D){return;}s++;if(f.hasClass(D,/custom_/)){var G=1,F=w(D);if(D.tagName=="OL"){if(F){switch(F){case"cn":case"cn1":case"cn2":if(s>10&&(s%10==0||s>10&&s<20)){G=2;}else{if(s>20){G=3;}}break;case"num2":if(s>9){G=2;}}}E.className="list-"+y[F]+s+" list-"+F+"-paddingleft-"+G;}else{E.className="list-"+y[F]+" list-"+F+"-paddingleft";}}else{E.className=E.className.replace(/list-[\w\-]+/gi,"");}var H=E.getAttribute("class");if(H!==null&&!H.replace(/\s/g,"")){f.removeAttributes(E,"class");}});v(D,D.tagName.toLowerCase(),w(D)||f.getStyle(D,"list-style-type"),true);});});function v(F,B,E,D){var C=F.nextSibling;if(C&&C.nodeType==1&&C.tagName.toLowerCase()==B&&(w(C)||f.getStyle(C,"list-style-type")||(B=="ol"?"decimal":"disc"))==E){f.moveChild(C,F);if(C.childNodes.length==0){f.remove(C);}}if(C&&f.isFillChar(C)){f.remove(C);}var s=F.previousSibling;if(s&&s.nodeType==1&&s.tagName.toLowerCase()==B&&(w(s)||f.getStyle(s,"list-style-type")||(B=="ol"?"decimal":"disc"))==E){f.moveChild(F,s);}if(s&&f.isFillChar(s)){f.remove(s);}!D&&f.isEmptyBlock(F)&&f.remove(F);}function A(B,s){if(y[s]){B.className="custom_"+s;}try{f.setStyle(B,"list-style-type",s);}catch(C){}}function u(B){var s=B.previousSibling;if(s&&f.isEmptyBlock(s)){f.remove(s);}s=B.nextSibling;if(s&&f.isEmptyBlock(s)){f.remove(s);}}x.addListener("keydown",function(J,P){function F(){P.preventDefault?P.preventDefault():(P.returnValue=false);x.fireEvent("contentchange");x.undoManger&&x.undoManger.save();}function I(R,S){while(R&&!f.isBody(R)){if(S(R)){return null;}if(R.nodeType==1&&/[ou]l/i.test(R.tagName)){return R;}R=R.parentNode;}return null;}var Q=P.keyCode||P.which;if(Q==13&&!P.shiftKey){var H=x.selection.getRange(),B=I(H.startContainer,function(R){return R.tagName=="TABLE";}),E=H.collapsed?B:I(H.endContainer,function(R){return R.tagName=="TABLE";});if(B&&E&&B===E){if(!H.collapsed){B=f.findParentByTagName(H.startContainer,"li",true);E=f.findParentByTagName(H.endContainer,"li",true);if(B&&E&&B===E){H.deleteContents();N=f.findParentByTagName(H.startContainer,"li",true);if(N&&f.isEmptyBlock(N)){D=N.previousSibling;next=N.nextSibling;s=x.document.createElement("p");f.fillNode(x.document,s);L=N.parentNode;if(D&&next){H.setStart(next,0).collapse(true).select(true);f.remove(N);}else{if(!D&&!next||!D){L.parentNode.insertBefore(s,L);}else{N.parentNode.parentNode.insertBefore(s,L.nextSibling);}f.remove(N);if(!L.firstChild){f.remove(L);}H.setStart(s,0).setCursor();}F();return;}}else{var O=H.cloneRange(),C=O.collapse(false).createBookmark();H.deleteContents();O.moveToBookmark(C);var N=f.findParentByTagName(O.startContainer,"li",true);u(N);O.select();F();return;}}N=f.findParentByTagName(H.startContainer,"li",true);if(N){if(f.isEmptyBlock(N)){C=H.createBookmark();var L=N.parentNode;if(N!==L.lastChild){f.breakParent(N,L);u(N);}else{L.parentNode.insertBefore(N,L.nextSibling);if(f.isEmptyNode(L)){f.remove(L);}}if(!a.$list[N.parentNode.tagName]){if(!f.isBlockElm(N.firstChild)){s=x.document.createElement("p");N.parentNode.insertBefore(s,N);while(N.firstChild){s.appendChild(N.firstChild);}f.remove(N);}else{f.remove(N,true);}}H.moveToBookmark(C).select();}else{var G=N.firstChild;if(!G||!f.isBlockElm(G)){var s=x.document.createElement("p");!N.firstChild&&f.fillNode(x.document,s);while(N.firstChild){s.appendChild(N.firstChild);}N.appendChild(s);G=s;}var K=x.document.createElement("span");H.insertNode(K);f.breakParent(K,N);var M=K.nextSibling;G=M.firstChild;if(!G){s=x.document.createElement("p");f.fillNode(x.document,s);M.appendChild(s);G=s;}if(f.isEmptyNode(G)){G.innerHTML="";f.fillNode(x.document,G);}H.setStart(G,0).collapse(true).shrinkBoundary().select();f.remove(K);var D=M.previousSibling;if(D&&f.isEmptyBlock(D)){D.innerHTML="<p></p>";f.fillNode(x.document,D.firstChild);}}F();}}}if(Q==8){H=x.selection.getRange();if(H.collapsed&&f.isStartInblock(H)){O=H.cloneRange().trimBoundary();N=f.findParentByTagName(H.startContainer,"li",true);if(N&&f.isStartInblock(O)){B=f.findParentByTagName(H.startContainer,"p",true);if(B&&B!==N.firstChild){var L=f.findParentByTagName(B,["ol","ul"]);f.breakParent(B,L);u(B);x.fireEvent("contentchange");H.setStart(B,0).setCursor(false,true);x.fireEvent("saveScene");f.preventDefault(P);return;}if(N&&(D=N.previousSibling)){if(Q==46&&N.childNodes.length){return;}if(a.$list[D.tagName]){D=D.lastChild;}x.undoManger&&x.undoManger.save();G=N.firstChild;if(f.isBlockElm(G)){if(f.isEmptyNode(G)){D.appendChild(G);H.setStart(G,0).setCursor(false,true);while(N.firstChild){D.appendChild(N.firstChild);}}else{K=x.document.createElement("span");H.insertNode(K);if(f.isEmptyBlock(D)){D.innerHTML="";}f.moveChild(N,D);H.setStartBefore(K).collapse(true).select(true);f.remove(K);}}else{if(f.isEmptyNode(N)){var s=x.document.createElement("p");D.appendChild(s);H.setStart(s,0).setCursor();}else{H.setEnd(D,D.childNodes.length).collapse().select(true);while(N.firstChild){D.appendChild(N.firstChild);}}}f.remove(N);x.fireEvent("contentchange");x.fireEvent("saveScene");f.preventDefault(P);return;}if(N&&!N.previousSibling){var L=N.parentNode;var C=H.createBookmark();if(f.isTagNode(L.parentNode,"ol ul")){L.parentNode.insertBefore(N,L);if(f.isEmptyNode(L)){f.remove(L);}}else{while(N.firstChild){L.parentNode.insertBefore(N.firstChild,L);}f.remove(N);if(f.isEmptyNode(L)){f.remove(L);}}H.moveToBookmark(C).setCursor(false,true);x.fireEvent("contentchange");x.fireEvent("saveScene");f.preventDefault(P);return;}}}}});x.addListener("tabkeydown",function(){function M(R){var Q=[];for(var S in R){Q.push(S);}return Q;}var F=x.selection.getRange(),K={OL:M(x.options.insertorderedlist),UL:M(x.options.insertunorderedlist)};function N(Q){if(x.options.maxListLevel!=-1){var S=Q.parentNode,R=0;while(/[ou]l/i.test(S.tagName)){R++;S=S.parentNode;}if(R>=x.options.maxListLevel){return true;}}}var O=f.findParentByTagName(F.startContainer,"li",true);if(O){var D;if(F.collapsed){if(N(O)){return true;}var C=O.parentNode,J=x.document.createElement(C.tagName),G=p.indexOf(K[J.tagName],w(C)||f.getComputedStyle(C,"list-style-type"));G=G+1==K[J.tagName].length?0:G+1;var B=K[J.tagName][G];A(J,B);if(f.isStartInblock(F)){x.fireEvent("saveScene");D=F.createBookmark();C.insertBefore(J,O);J.appendChild(O);v(J,J.tagName.toLowerCase(),B);x.fireEvent("contentchange");F.moveToBookmark(D).select(true);return true;}}else{x.fireEvent("saveScene");D=F.createBookmark();for(var E=0,s,L=f.findParents(O),P;P=L[E++];){if(f.isTagNode(P,"ol ul")){s=P;break;}}var I=O;if(D.end){while(I&&!(f.getPosition(I,D.end)&f.POSITION_FOLLOWING)){if(N(I)){I=f.getNextDomNode(I,false,null,function(Q){return Q!==s;});continue;}var C=I.parentNode,J=x.document.createElement(C.tagName),G=p.indexOf(K[J.tagName],w(C)||f.getComputedStyle(C,"list-style-type"));var H=G+1==K[J.tagName].length?0:G+1;var B=K[J.tagName][H];A(J,B);C.insertBefore(J,I);while(I&&!(f.getPosition(I,D.end)&f.POSITION_FOLLOWING)){O=I.nextSibling;J.appendChild(I);if(!O||f.isTagNode(O,"ol ul")){if(O){while(O=O.firstChild){if(O.tagName=="LI"){break;}}}else{O=f.getNextDomNode(I,false,null,function(Q){return Q!==s;});}break;}I=O;}v(J,J.tagName.toLowerCase(),B);I=O;}}x.fireEvent("contentchange");F.moveToBookmark(D).select();return true;}}});x.commands.insertorderedlist=x.commands.insertunorderedlist={execCommand:function(E,V){if(!V){V=E.toLowerCase()=="insertorderedlist"?"decimal":"disc";}var ad=this,O=this.selection.getRange(),P=function(ag){return ag.nodeType==1?ag.tagName.toLowerCase()!="br":!f.isWhitespace(ag);},af=E.toLowerCase()=="insertorderedlist"?"ol":"ul",D=ad.document.createDocumentFragment();O.adjustmentBoundary().shrinkBoundary();var I=O.createBookmark(true),G=f.findParentByTagName(ad.document.getElementById(I.start),"li"),S=0,F=f.findParentByTagName(ad.document.getElementById(I.end),"li"),T=0,ab,L,W,Y;if(G||F){G&&(ab=G.parentNode);if(!I.end){F=G;}F&&(L=F.parentNode);if(ab===L){while(G!==F){Y=G;G=G.nextSibling;if(!f.isBlockElm(Y.firstChild)){var Q=ad.document.createElement("p");while(Y.firstChild){Q.appendChild(Y.firstChild);}Y.appendChild(Q);}D.appendChild(Y);}Y=ad.document.createElement("span");ab.insertBefore(Y,F);if(!f.isBlockElm(F.firstChild)){Q=ad.document.createElement("p");while(F.firstChild){Q.appendChild(F.firstChild);}F.appendChild(Q);}D.appendChild(F);f.breakParent(Y,ab);if(f.isEmptyNode(Y.previousSibling)){f.remove(Y.previousSibling);}if(f.isEmptyNode(Y.nextSibling)){f.remove(Y.nextSibling);}var H=w(ab)||f.getComputedStyle(ab,"list-style-type")||(E.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(ab.tagName.toLowerCase()==af&&H==V){for(var U=0,M,J=ad.document.createDocumentFragment();M=D.childNodes[U++];){if(f.isTagNode(M,"ol ul")){p.each(f.getElementsByTagName(M,"li"),function(ag){while(ag.firstChild){J.appendChild(ag.firstChild);}});}else{while(M.firstChild){J.appendChild(M.firstChild);}}}Y.parentNode.insertBefore(J,Y);}else{W=ad.document.createElement(af);A(W,V);W.appendChild(D);Y.parentNode.insertBefore(W,Y);}f.remove(Y);W&&v(W,af,V);O.moveToBookmark(I).select();return;}if(G){while(G){Y=G.nextSibling;if(f.isTagNode(G,"ol ul")){D.appendChild(G);}else{var B=ad.document.createDocumentFragment(),aa=0;while(G.firstChild){if(f.isBlockElm(G.firstChild)){aa=1;}B.appendChild(G.firstChild);}if(!aa){var ae=ad.document.createElement("p");ae.appendChild(B);D.appendChild(ae);}else{D.appendChild(B);}f.remove(G);}G=Y;}ab.parentNode.insertBefore(D,ab.nextSibling);if(f.isEmptyNode(ab)){O.setStartBefore(ab);f.remove(ab);}else{O.setStartAfter(ab);}S=1;}if(F&&f.inDoc(L,ad.document)){G=L.firstChild;while(G&&G!==F){Y=G.nextSibling;if(f.isTagNode(G,"ol ul")){D.appendChild(G);}else{B=ad.document.createDocumentFragment();aa=0;while(G.firstChild){if(f.isBlockElm(G.firstChild)){aa=1;}B.appendChild(G.firstChild);}if(!aa){ae=ad.document.createElement("p");ae.appendChild(B);D.appendChild(ae);}else{D.appendChild(B);}f.remove(G);}G=Y;}var s=f.createElement(ad.document,"div",{tmpDiv:1});f.moveChild(F,s);D.appendChild(s);f.remove(F);L.parentNode.insertBefore(D,L);O.setEndBefore(L);if(f.isEmptyNode(L)){f.remove(L);}T=1;}}if(!S){O.setStartBefore(ad.document.getElementById(I.start));}if(I.end&&!T){O.setEndAfter(ad.document.getElementById(I.end));}O.enlarge(true,function(ag){return t[ag.tagName];});D=ad.document.createDocumentFragment();var C=O.createBookmark(),R=f.getNextDomNode(C.start,false,P),ac=O.cloneRange(),X,K=f.isBlockElm;while(R&&R!==C.end&&(f.getPosition(R,C.end)&f.POSITION_PRECEDING)){if(R.nodeType==3||a.li[R.tagName]){if(R.nodeType==1&&a.$list[R.tagName]){while(R.firstChild){D.appendChild(R.firstChild);}X=f.getNextDomNode(R,false,P);f.remove(R);R=X;continue;}X=R;ac.setStartBefore(R);while(R&&R!==C.end&&(!K(R)||f.isBookmarkNode(R))){X=R;R=f.getNextDomNode(R,false,null,function(ag){return !t[ag.tagName];});}if(R&&K(R)){Y=f.getNextDomNode(X,false,P);if(Y&&f.isBookmarkNode(Y)){R=f.getNextDomNode(Y,false,P);X=Y;}}ac.setEndAfter(X);R=f.getNextDomNode(X,false,P);var N=O.document.createElement("li");N.appendChild(ac.extractContents());if(f.isEmptyNode(N)){var X=O.document.createElement("p");while(N.firstChild){X.appendChild(N.firstChild);}N.appendChild(X);}D.appendChild(N);}else{R=f.getNextDomNode(R,true,P);}}O.moveToBookmark(C).collapse(true);W=ad.document.createElement(af);A(W,V);W.appendChild(D);O.insertNode(W);v(W,af,V,true);for(var U=0,M,Z=f.getElementsByTagName(W,"div");M=Z[U++];){if(M.getAttribute("tmpDiv")){f.remove(M,true);}}O.moveToBookmark(I).select();},queryCommandState:function(s){return f.filterNodeList(this.selection.getStartElementPath(),s.toLowerCase()=="insertorderedlist"?"ol":"ul")?1:0;},queryCommandValue:function(B){var s=f.filterNodeList(this.selection.getStartElementPath(),B.toLowerCase()=="insertorderedlist"?"ol":"ul");return s?w(s)||f.getComputedStyle(s,"list-style-type"):null;}};};(function(){function t(w){w=w||{};this.indentChar=w.indentChar||"    ";this.breakChar=w.breakChar||"\n";this.selfClosingEnd=w.selfClosingEnd||" />";}var v=function(){var x={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function w(y){return x[y];}return function(y){y=y+"";return y?y.replace(/[<>"']/g,w):"";};}();var u=p.extend({a:1,A:1},a.$inline,true);function s(x){var y=[];for(var w in x){y.push(w+'="'+v(x[w])+'"');}return y.join(" ");}t.prototype={format:function(w){var x=UE.serialize.parseHTML(w);this.buff=[];this.indents="";this.indenting=1;this.visitNode(x);return this.buff.join("");},visitNode:function(x){if(x.type=="fragment"){this.visitChildren(x.children);}else{if(x.type=="element"){var w=a.$empty[x.tag];this.visitTag(x.tag,x.attributes,w);this.visitChildren(x.children);if(!w){this.visitEndTag(x.tag);}}else{if(x.type=="comment"){this.visitComment(x.data);}else{this.visitText(x.data,a.$notTransContent[x.parent.tag]);}}}},visitChildren:function(x){for(var w=0;w<x.length;w++){this.visitNode(x[w]);}},visitTag:function(w,y,x){if(this.indenting){this.indent();}else{if(!u[w]){this.newline();this.indent();}}this.buff.push("<",w);var z=s(y);if(z){this.buff.push(" ",z);}if(x){this.buff.push(this.selfClosingEnd);if(w=="br"){this.newline();}}else{this.buff.push(">");this.indents+=this.indentChar;}if(!u[w]){this.newline();}},indent:function(){this.buff.push(this.indents);this.indenting=0;},newline:function(){this.buff.push(this.breakChar);this.indenting=1;},visitEndTag:function(w){this.indents=this.indents.slice(0,-this.indentChar.length);if(this.indenting){this.indent();}else{if(!u[w]){this.newline();this.indent();}}this.buff.push("</",w,">");},visitText:function(x,w){if(this.indenting){this.indent();}x=x.replace(/&nbsp;/g," ");this.buff.push(x);},visitComment:function(w){if(this.indenting){this.indent();}this.buff.push("<!--",w,"-->");}};var r={textarea:function(y,x){var w=x.ownerDocument.createElement("textarea");w.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(k.ie&&k.version<8){w.style.width=x.offsetWidth+"px";w.style.height=x.offsetHeight+"px";x.onresize=function(){w.style.width=x.offsetWidth+"px";w.style.height=x.offsetHeight+"px";};}x.appendChild(w);return{setContent:function(z){w.value=z;},getContent:function(){return w.value;},select:function(){var z;if(k.ie){z=w.createTextRange();z.collapse(true);z.select();}else{w.setSelectionRange(0,0);w.focus();}},dispose:function(){x.removeChild(w);x.onresize=null;w=null;x=null;}};},codemirror:function(y,x){var w=window.CodeMirror(x,{mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true});var z=w.getWrapperElement();z.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';w.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";w.refresh();return{getCodeMirror:function(){return w;},setContent:function(A){w.setValue(A);},getContent:function(){return w.getValue();},select:function(){w.focus();},dispose:function(){x.removeChild(z);z=null;w=null;}};}};UE.plugins.source=function(){var B=this;var w=this.options;var D=new t(w.source);var A=false;var E;w.sourceEditor=k.ie?"textarea":(w.sourceEditor||"codemirror");B.setOpt({sourceEditorFirst:false});function x(G){return r[w.sourceEditor=="codemirror"&&window.CodeMirror?"codemirror":"textarea"](B,G);}var F;var C=B.getContent,z;B.commands.source={execCommand:function(){A=!A;if(A){z=B.selection.getRange().createAddress(false,true);B.undoManger&&B.undoManger.save(true);if(k.gecko){B.body.contentEditable=false;}F=B.iframe.style.cssText;B.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";var I=D.format(B.hasContents()?B.getContent():"");E=x(B.iframe.parentNode);E.setContent(I);setTimeout(function(){E.select();B.addListener("fullscreenchanged",function(){try{E.getCodeMirror().refresh();}catch(L){}});});B.getContent=function(){var L=E.getContent()||"<p>"+(k.ie?"":"<br/>")+"</p>";return L.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");};}else{B.iframe.style.cssText=F;var G=E.getContent()||"<p>"+(k.ie?"":"<br/>")+"</p>";G=G.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");B.setContent(G);E.dispose();E=null;B.getContent=C;var K=B.body.firstChild;if(!K){B.body.innerHTML="<p>"+(k.ie?"":"<br/>")+"</p>";K=B.body.firstChild;}B.undoManger&&B.undoManger.save(true);if(k.gecko){var H=document.createElement("input");H.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(H);B.body.contentEditable=false;setTimeout(function(){f.setViewportOffset(H,{left:-32768,top:0});H.focus();setTimeout(function(){B.body.contentEditable=true;B.selection.getRange().moveToAddress(z).select();f.remove(H);});});}else{try{B.selection.getRange().moveToAddress(z).select();}catch(J){}}}this.fireEvent("sourcemodechanged",A);},queryCommandState:function(){return A|0;},notNeedUndo:1};var y=B.queryCommandState;B.queryCommandState=function(G){G=G.toLowerCase();if(A){return G in {source:1,fullscreen:1}?1:-1;}return y.apply(this,arguments);};if(w.sourceEditor=="codemirror"){B.addListener("ready",function(){p.loadFile(document,{src:w.codeMirrorJsUrl||w.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",tag:"script",type:"text/javascript",defer:"defer"},function(){if(w.sourceEditorFirst){setTimeout(function(){B.execCommand("source");},0);}});p.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:w.codeMirrorCssUrl||w.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"});});}};})();UE.plugins.enterkey=function(){var s,t=this,r=t.options.enterTag;t.addListener("keyup",function(B,C){var D=C.keyCode||C.which;if(D==13){var A=t.selection.getRange(),x=A.startContainer,u;if(!k.ie){if(/h\d/i.test(s)){if(k.gecko){var z=f.findParentByTagName(x,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],true);if(!z){t.document.execCommand("formatBlock",false,"<p>");u=1;}}else{if(x.nodeType==1){var y=t.document.createTextNode(""),v;A.insertNode(y);v=f.findParentByTagName(y,"div",true);if(v){var w=t.document.createElement("p");while(v.firstChild){w.appendChild(v.firstChild);}v.parentNode.insertBefore(w,v);f.remove(v);A.setStartBefore(y).setCursor();u=1;}f.remove(y);}}if(t.undoManger&&u){t.undoManger.save();}}k.opera&&A.select();}setTimeout(function(){t.selection.getRange().scrollToView(t.autoHeightEnabled,t.autoHeightEnabled?f.getXY(t.iframe).y:0);},50);}});t.addListener("keydown",function(z,B){var D=B.keyCode||B.which;if(D==13){if(t.undoManger){t.undoManger.save();}s="";var w=t.selection.getRange();if(!w.collapsed){var u=w.startContainer,v=w.endContainer,x=f.findParentByTagName(u,"td",true),y=f.findParentByTagName(v,"td",true);if(x&&y&&x!==y||!x&&y||x&&!y){B.preventDefault?B.preventDefault():(B.returnValue=false);return;}}if(r=="p"){if(!k.ie){u=f.findParentByTagName(w.startContainer,["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],true);if(!u&&!k.opera){t.document.execCommand("formatBlock",false,"<p>");if(k.gecko){w=t.selection.getRange();u=f.findParentByTagName(w.startContainer,"p",true);u&&f.removeDirtyAttr(u);}}else{s=u.tagName;u.tagName.toLowerCase()=="p"&&k.gecko&&f.removeDirtyAttr(u);}}}else{B.preventDefault?B.preventDefault():(B.returnValue=false);if(!w.collapsed){w.deleteContents();u=w.startContainer;if(u.nodeType==1&&(u=u.childNodes[w.startOffset])){while(u.nodeType==1){if(a.$empty[u.tagName]){w.setStartBefore(u).setCursor();if(t.undoManger){t.undoManger.save();}return false;}if(!u.firstChild){var C=w.document.createElement("br");u.appendChild(C);w.setStart(u,0).setCursor();if(t.undoManger){t.undoManger.save();}return false;}u=u.firstChild;}if(u===w.startContainer.childNodes[w.startOffset]){C=w.document.createElement("br");w.insertNode(C).setCursor();}else{w.setStart(u,0).setCursor();}}else{C=w.document.createElement("br");w.insertNode(C).setStartAfter(C).setCursor();}}else{C=w.document.createElement("br");w.insertNode(C);var A=C.parentNode;if(A.lastChild===C){C.parentNode.insertBefore(C.cloneNode(true),C);w.setStartBefore(C);}else{w.setStartAfter(C);}w.setCursor();}}}});};UE.plugins.keystrokes=function(){var r=this;r.addListener("keydown",function(s,C){var x=C.keyCode||C.which,v=r.selection.getRange();if(!v.collapsed&&!(C.ctrlKey||C.metaKey||C.shiftKey||C.altKey||x==9)){var J=v.startContainer;if(f.isFillChar(J)){v.setStartBefore(J);}J=v.endContainer;if(f.isFillChar(J)){v.setEndAfter(J);}v.txtToElmBoundary();if(v.endContainer&&v.endContainer.nodeType==1){J=v.endContainer.childNodes[v.endOffset];if(J&&f.isBr(J)){v.setEndAfter(J);}}if(v.startOffset==0){J=v.startContainer;if(f.isBoundaryNode(J,"firstChild")){J=v.endContainer;if(v.endOffset==(J.nodeType==3?J.nodeValue.length:J.childNodes.length)&&f.isBoundaryNode(J,"lastChild")){r.fireEvent("saveScene");r.body.innerHTML="<p>"+(k.ie?"":"<br/>")+"</p>";v.setStart(r.body.firstChild,0).setCursor(false,true);k.ie&&r._selectionChange();f.preventDefault(C);return;}}}}if(x==8){var u,t;if(v.inFillChar()){u=v.startContainer;v.setStartBefore(u).shrinkBoundary(true).collapse(true);if(f.isFillChar(u)){f.remove(u);}else{u.nodeValue=u.nodeValue.replace(new RegExp("^"+f.fillChar),"");}}if(u=v.getClosedNode()){r.fireEvent("saveScene");v.setStartBefore(u);f.remove(u);v.setCursor();r.fireEvent("saveScene");f.preventDefault(C);return;}if(!k.ie){u=f.findParentByTagName(v.startContainer,"table",true);t=f.findParentByTagName(v.endContainer,"table",true);if(u&&!t||!u&&t||u!==t){C.preventDefault();return;}}}if(x==9){var y={ol:1,ul:1,table:1};if(r.fireEvent("tabkeydown")){f.preventDefault(C);return;}range=r.selection.getRange();r.fireEvent("saveScene");for(var I=0,A="",D=r.options.tabSize||4,G=r.options.tabNode||"&nbsp;";I<D;I++){A+=G;}var H=r.document.createElement("span");H.innerHTML=A+f.fillChar;if(range.collapsed){range.insertNode(H.cloneNode(true).firstChild).setCursor(true);}else{u=f.findParent(range.startContainer,B);t=f.findParent(range.endContainer,B);if(u&&t&&u===t){range.deleteContents();range.insertNode(H.cloneNode(true).firstChild).setCursor(true);}else{var w=range.createBookmark(),B=function(K){return f.isBlockElm(K)&&!y[K.tagName.toLowerCase()];};range.enlarge(true);var E=range.createBookmark(),F=f.getNextDomNode(E.start,false,B);while(F&&!(f.getPosition(F,E.end)&f.POSITION_FOLLOWING)){F.insertBefore(H.cloneNode(true).firstChild,F.firstChild);F=f.getNextDomNode(F,false,B);}range.moveToBookmark(E).moveToBookmark(w).select();}}f.preventDefault(C);}if(k.gecko&&x==46){range=r.selection.getRange();if(range.collapsed){u=range.startContainer;if(f.isEmptyBlock(u)){var z=u.parentNode;while(f.getChildCount(z)==1&&!f.isBody(z)){u=z;z=z.parentNode;}if(u===z.lastChild){C.preventDefault();}return;}}}});r.addListener("keyup",function(v,t){var w=t.keyCode||t.which,s;if(w==8){s=r.selection.getRange();if(s.collapsed&&f.isBody(s.startContainer)){var u=f.createElement(r.document,"p",{innerHTML:k.ie?f.fillChar:"<br/>"});s.insertNode(u).setStart(u,0).setCursor(false,true);}if(k.chrome&&s.collapsed&&s.startContainer.nodeType==1&&f.isEmptyBlock(s.startContainer)){s.select(true);}}});};UE.plugins.fiximgclick=function(){var r=this;if(k.webkit){r.addListener("click",function(t,u){if(u.target.tagName=="IMG"){var s=new h.Range(r.document);s.selectNode(u.target).select();}});}};UE.plugins.autolink=function(){var r=0;if(k.ie){return;}var s=this;s.addListener("reset",function(){r=0;});s.addListener("keydown",function(z,B){var E=B.keyCode||B.which;if(E==32||E==13){var v=s.selection.getNative(),x=v.getRangeAt(0).cloneRange(),w,D;var u=x.startContainer;while(u.nodeType==1&&x.startOffset>0){u=x.startContainer.childNodes[x.startOffset-1];if(!u){break;}x.setStart(u,u.nodeType==1?u.childNodes.length:u.nodeValue.length);x.collapse(true);u=x.startContainer;}do{if(x.startOffset==0){u=x.startContainer.previousSibling;while(u&&u.nodeType==1){u=u.lastChild;}if(!u||f.isFillChar(u)){break;}w=u.nodeValue.length;}else{u=x.startContainer;w=x.startOffset;}x.setStart(u,w-1);D=x.toString().charCodeAt(0);}while(D!=160&&D!=32);if(x.toString().replace(new RegExp(f.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){while(x.toString().length){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(x.toString())){break;}try{x.setStart(x.startContainer,x.startOffset+1);}catch(y){var u=x.startContainer;while(!(next=u.nextSibling)){if(f.isBody(u)){return;}u=u.parentNode;}x.setStart(next,0);}}if(f.findParentByTagName(x.startContainer,"a",true)){return;}var A=s.document.createElement("a"),C=s.document.createTextNode(" "),t;s.undoManger&&s.undoManger.save();A.appendChild(x.extractContents());A.href=A.innerHTML=A.innerHTML.replace(/<[^>]+>/g,"");t=A.getAttribute("href").replace(new RegExp(f.fillChar,"g"),"");t=/^(?:https?:\/\/)/ig.test(t)?t:"http://"+t;A.setAttribute("data_ue_src",p.html(t));A.href=p.html(t);x.insertNode(A);A.parentNode.insertBefore(C,A.nextSibling);x.setStart(C,0);x.collapse(true);v.removeAllRanges();v.addRange(x);s.undoManger&&s.undoManger.save();}}});};UE.plugins.autoheight=function(){var y=this;y.autoHeightEnabled=y.options.autoHeightEnabled!==false;if(!y.autoHeightEnabled){return;}var w,z,u,x=0,A=y.options,s,r;function t(){var B=this;clearTimeout(r);if(v){return;}r=setTimeout(function(){if(B.queryCommandState&&B.queryCommandState("source")!=1){if(!z){z=B.document.createElement("span");z.style.cssText="display:block;width:0;margin:0;padding:0;border:0;clear:both;";z.innerHTML=".";}u=z.cloneNode(true);B.body.appendChild(u);s=Math.max(f.getXY(u).y+u.offsetHeight,Math.max(A.minFrameHeight,A.initialFrameHeight));if(s!=x){B.setHeight(s);x=s;}f.remove(u);}},50);}var v;y.addListener("fullscreenchanged",function(C,B){v=B;});y.addListener("destroy",function(){y.removeListener("contentchange",t);y.removeListener("afterinserthtml",t);y.removeListener("keyup",t);y.removeListener("mouseup",t);});y.enableAutoHeight=function(){if(!y.autoHeightEnabled){return;}var B=y.document;y.autoHeightEnabled=true;w=B.body.style.overflowY;B.body.style.overflowY="hidden";y.addListener("contentchange",t);y.addListener("afterinserthtml",t);y.addListener("keyup",t);y.addListener("mouseup",t);setTimeout(function(){t.call(this);},k.gecko?100:0);y.fireEvent("autoheightchanged",y.autoHeightEnabled);};y.disableAutoHeight=function(){y.body.style.overflowY=w||"";y.removeListener("contentchange",t);y.removeListener("keyup",t);y.removeListener("mouseup",t);y.autoHeightEnabled=false;y.fireEvent("autoheightchanged",y.autoHeightEnabled);};y.addListener("ready",function(){y.enableAutoHeight();var B;f.on(k.ie?y.body:y.document,k.webkit?"dragover":"drop",function(){clearTimeout(B);B=setTimeout(function(){t.call(this);},100);});});};UE.plugins.autofloat=function(){var I=this,J=I.getLang();I.setOpt({topOffset:0});var D=I.options.autoFloatEnabled!==false,B=I.options.topOffset;if(!D){return;}var w=UE.ui.uiUtils,x=k.ie&&k.version<=6,C=k.quirks;function r(K){if(!K.ui){alert(J.autofloatMsg);return 0;}return 1;}function y(){var K=document.body.style;K.backgroundImage='url("about:blank")';K.backgroundAttachment="fixed";}var z,E=document.createElement("div"),u,t,H,F=true;function A(){var L=f.getXY(u),K=f.getComputedStyle(u,"position"),M=f.getComputedStyle(u,"left");u.style.width=u.offsetWidth+"px";u.style.zIndex=I.options.zIndex*1+1;u.parentNode.insertBefore(E,u);if(x||(C&&k.ie)){if(u.style.position!="absolute"){u.style.position="absolute";}u.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-t+B+"px";}else{if(k.ie7Compat&&F){F=false;u.style.left=f.getXY(u).x-document.documentElement.getBoundingClientRect().left+2+"px";}if(u.style.position!="fixed"){u.style.position="fixed";u.style.top=B+"px";((K=="absolute"||K=="relative")&&parseFloat(M))&&(u.style.left=L.x+"px");}}}function v(){F=true;if(E.parentNode){E.parentNode.removeChild(E);}u.style.cssText=z;}function s(){var K=H(I.container);if(K.top<0&&K.bottom-u.offsetHeight>0){A();}else{v();}}var G=p.defer(function(){s();},k.ie?200:100,true);I.addListener("destroy",function(){f.un(window,["scroll","resize"],s);I.removeListener("keydown",G);});I.addListener("ready",function(){if(r(I)){H=w.getClientRect;u=I.ui.getDom("toolbarbox");t=H(u).top;z=u.style.cssText;E.style.height=u.offsetHeight+"px";if(x){y();}f.on(window,["scroll","resize"],s);I.addListener("keydown",G);I.addListener("beforefullscreenchange",function(L,K){if(K){v();}});I.addListener("fullscreenchanged",function(L,K){if(!K){s();}});I.addListener("sourcemodechanged",function(L,K){setTimeout(function(){s();},0);});I.addListener("clearDoc",function(){setTimeout(function(){s();},0);});}});};UE.plugins.highlightcode=function(){var u=this;if(!/highlightcode/i.test(u.options.toolbars.join(""))){return;}u.commands.highlightcode={execCommand:function(y,z,x){var w=this.selection.getRange(),C=f.findParentByTagName(w.startContainer,"table",true),v=f.findParentByTagName(w.endContainer,"table",true);if(C&&v&&C===v&&f.hasClass(C,"syntaxhighlighter")){if(C.nextSibling){w.setStart(C.nextSibling,0);}else{if(C.previousSibling){w.setStartAtLast(C.previousSibling);}else{var B=u.document.createElement("p");f.fillNode(u.document,B);C.parentNode.insertBefore(B,C);w.setStart(B,0);}}w.setCursor(false,true);f.remove(C);}if(z&&x){u.execCommand("inserthtml",'<pre id="highlightcode_id" class="brush: '+x+';toolbar:false;">'+p.unhtml(z)+"</pre>",true);var A=u.document.getElementById("highlightcode_id");if(A){f.removeAttributes(A,"id");u.window.SyntaxHighlighter.highlight(A);}}},queryCommandState:function(){return r.call(this);}};function r(){try{var w=this.selection.getRange(),y,v;w.adjustmentBoundary();y=f.findParent(w.startContainer,function(z){return z.nodeType==1&&z.tagName=="TABLE"&&f.hasClass(z,"syntaxhighlighter");},true);v=f.findParent(w.endContainer,function(z){return z.nodeType==1&&z.tagName=="TABLE"&&f.hasClass(z,"syntaxhighlighter");},true);return y&&v&&y==v?1:0;}catch(x){return 0;}}u.notNeedHighlightQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,highlightcode:1};var t=u.queryCommandState;u.queryCommandState=function(v){if(!u.notNeedHighlightQuery[v.toLowerCase()]&&r.call(this)==1){return -1;}return t.apply(this,arguments);};u.addListener("beforeselectionchange afterselectionchange",function(v){u.highlight=/^b/.test(v)?u.queryCommandState("highlightcode"):0;});u.addListener("ready",function(){if(typeof u.XRegExp=="undefined"){p.loadFile(u.document,{id:"syntaxhighlighter_js",src:u.options.highlightJsUrl||u.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCore.js",tag:"script",type:"text/javascript",defer:"defer"},function(){s.call(u);});}if(!u.document.getElementById("syntaxhighlighter_css")){p.loadFile(u.document,{id:"syntaxhighlighter_css",tag:"link",rel:"stylesheet",type:"text/css",href:u.options.highlightCssUrl||u.options.UEDITOR_HOME_URL+"third-party/SyntaxHighlighter/shCoreDefault.css"});}});u.addListener("beforegetcontent beforegetscene",function(){p.each(f.getElementsByTagName(u.body,"table","syntaxhighlighter"),function(w){var y=[],v="";p.each(w.getElementsByTagName("code"),function(z){if(v!==z.parentNode){v=z.parentNode;y.push(p.trim(v[k.ie?"innerText":"textContent"]));}});var x=f.createElement(u.document,"pre",{"class":"brush: "+w.className.replace(/\s+/g," ").split(" ")[1]+";toolbar:false;"});x.appendChild(u.document.createTextNode(y.join("\n")));w.parentNode.replaceChild(x,w);});});u.addListener("aftergetcontent aftersetcontent aftergetscene",s);u.addListener("excludetable excludeNodeinautotype",function(v,w){if(w&&f.findParent(w,function(x){return f.hasClass(x,"syntaxhighlighter");},true)){return true;}});function s(){var v=this;if(!v.window||!v.window.SyntaxHighlighter){return;}p.each(f.getElementsByTagName(v.document,"pre"),function(w){if(f.hasClass(w,"brush")){v.window.SyntaxHighlighter.highlight(w);}});}u.addListener("getAllHtml",function(B,y){var v="";for(var x=0,w,A=f.getElementsByTagName(u.document,"table");w=A[x++];){if(f.hasClass(w,"syntaxhighlighter")){v="<script type=\"text/javascript\">window.onload = function(){SyntaxHighlighter.highlight();setTimeout(function(){    var tables = document.getElementsByTagName('table');   for(var t= 0,ti;ti=tables[t++];){       if(/SyntaxHighlighter/i.test(ti.className)){           var tds = ti.getElementsByTagName('td');           for(var i=0,li,ri;li=tds[0].childNodes[i];i++){               ri = tds[1].firstChild.childNodes[i];               if(ri){                  ri.style.height = li.style.height = ri.offsetHeight + 'px';               }           }       }   }},100)}<\/script>";break;}}if(!v){var z;if(z=u.document.getElementById("syntaxhighlighter_css")){f.remove(z);}if(z=u.document.getElementById("syntaxhighlighter_js")){f.remove(z);}}v&&y.push(v);});};UE.plugins.serialize=function(){var r=k.ie,z=k.version;function y(G){return/pt/.test(G)?G.replace(/([\d.]+)pt/g,function(H){return Math.round(parseFloat(H)*96/72)+"px";}):G;}var B=this,s=B.options.autoClearEmptyNode,v=a.$empty,E=function(){var I=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)-->)|(?:([^\s\/>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,G=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,J={checked:1,compact:1,declare:1,defer:1,disabled:1,ismap:1,multiple:1,nohref:1,noresize:1,noshade:1,nowrap:1,readonly:1,selected:1},M={script:1,style:1},H={li:{"$":"ul",ul:1,ol:1},dd:{"$":"dl",dl:1},dt:{"$":"dl",dl:1},option:{"$":"select",select:1},td:{"$":"tr",tr:1},th:{"$":"tr",tr:1},tr:{"$":"tbody",tbody:1,thead:1,tfoot:1,table:1},tbody:{"$":"table",table:1,colgroup:1},thead:{"$":"table",table:1},tfoot:{"$":"table",table:1},col:{"$":"colgroup",colgroup:1}};var K={table:"td",tbody:"td",thead:"td",tfoot:"td",colgroup:"col",ul:"li",ol:"li",dl:"dd",select:"option"};function L(Q,U){var R,S=0,O,Z;I.exec("");while((R=I.exec(Q))){var X=R.index;if(X>S){var aa=Q.slice(S,X);if(Z){Z.push(aa);}else{U.onText(aa);}}S=I.lastIndex;if((O=R[1])){O=O.toLowerCase();if(Z&&O==Z._tag_name){U.onCDATA(Z.join(""));Z=null;}if(!Z){U.onTagClose(O);continue;}}if(Z){Z.push(R[0]);continue;}if((O=R[3])){if(/="/.test(O)){continue;}O=O.toLowerCase();var Y=R[4],N,P={},W=Y&&Y.slice(-1)=="/";if(Y){G.exec("");while((N=G.exec(Y))){var V=N[1].toLowerCase(),T=N[2]||N[3]||N[4]||"";if(!T&&J[V]){T=V;}if(V=="style"){if(r&&z<=6){T=T.replace(/(?!;)\s*([\w-]+):/g,function(ab,ac){return ac.toLowerCase()+":";});}}if(T){P[V]=T.replace(/:\s*/g,":");}}}U.onTagOpen(O,P,W);if(!Z&&M[O]){Z=[];Z._tag_name=O;}continue;}if((O=R[2])){U.onComment(O);}}if(Q.length>S){U.onText(Q.slice(S,Q.length));}}return function(Q,R){var O={type:"fragment",parent:null,children:[]};var P=O;function T(U){U.parent=P;P.children.push(U);}function S(V,U){var W=V;if(H[W.tag]){while(H[P.tag]&&H[P.tag][W.tag]){P=P.parent;}if(P.tag==W.tag){P=P.parent;}while(H[W.tag]){if(H[W.tag][P.tag]){break;}W=W.parent={type:"element",tag:H[W.tag]["$"],attributes:{},children:[W]};}}if(R){while(a[W.tag]&&!(P.tag=="span"?p.extend(a.strong,{a:1,A:1}):(a[P.tag]||a.div))[W.tag]){if(N(P)){continue;}if(!P.parent){break;}P=P.parent;}}W.parent=P;P.children.push(W);if(U){P=V;}if(V.attributes.style){V.attributes.style=V.attributes.style.toLowerCase();}return V;}function N(U){var V;if(!U.children.length&&(V=K[U.tag])){S({type:"element",tag:V,attributes:{},children:[]},true);return true;}return false;}L(Q,{onText:function(U){while(!(a[P.tag]||a.div)["#"]){if(N(P)){continue;}P=P.parent;}T({type:"text",data:U});},onComment:function(U){T({type:"comment",data:U});},onCDATA:function(U){while(!(a[P.tag]||a.div)["#"]){if(N(P)){continue;}P=P.parent;}T({type:"cdata",data:U});},onTagOpen:function(U,W,V){V=V||v[U];S({type:"element",tag:U,attributes:W,closed:V,children:[]},!V);},onTagClose:function(U){var V=P;while(V&&U!=V.tag){V=V.parent;}if(V){for(var W=P;W!==V.parent;W=W.parent){N(W);}P=V.parent;}else{if(!(a.$removeEmpty[U]||a.$removeEmptyBlock[U]||U=="embed")){V={type:"element",tag:U,attributes:{},children:[]};S(V,true);N(V);P=V.parent;}}}});while(P!==O){N(P);P=P.parent;}return O;};}();var C=function(){var H={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function G(I){return H[I];}return function(I){I=I+"";return I?I.replace(/[<>"']/g,G):"";};}();var w=function(){function H(Q,P){var O=Q.children;var R=[];for(var N=0,M;M=O[N];N++){R.push(w(M,P));}return R.join("");}function J(N){var P=[];for(var M in N){var O=N[M];if(M=="style"){O=y(O);if(/rgba?\s*\([^)]*\)/.test(O)){O=O.replace(/rgba?\s*\(([^)]*)\)/g,function(Q){return p.fixColor("color",Q);});}N[M]=p.optCss(O.replace(/windowtext/g,"#000")).replace(/white-space[^;]+;/g,"");if(!N[M]){continue;}}P.push(M+'="'+C(N[M])+'"');}return P.join(" ");}function G(N,M){return M?N.data.replace(/&nbsp;/g," "):C(N.data).replace(/ /g,"&nbsp;");}var L={li:"p",h1:"p",h2:"p",h3:"p",h4:"p",h5:"p",h6:"p",tr:"p",br:"br",div:"p",p:"p"};var I={table:1,tbody:1,ol:1,ul:1,dt:1};function K(Q,P){if(Q.type=="element"&&!Q.children.length&&(a.$removeEmpty[Q.tag])&&Q.tag!="a"&&p.isEmptyObject(Q.attributes)&&s){return O;}var M=Q.tag;if(P&&M=="td"){if(!O){O="";}O+=H(Q,P)+"&nbsp;&nbsp;&nbsp;";}else{var N=J(Q.attributes);var O=P&&I[M]?"":"<"+(P&&L[M]!==undefined?L[M]:M)+(N?" "+N:"")+(v[M]?" />":">");if(!v[M]){if(M=="p"&&!Q.children.length){O+=k.ie?"&nbsp;":"<br/>";}O+=H(Q,P);O+=(P&&I[M]?"":"</"+(P&&L[M]!==undefined?L[M]:M)+">");}}return O;}return function(N,M){if(N.type=="fragment"){return H(N,M);}else{if(N.type=="element"){return K(N,M);}else{if(N.type=="text"||N.type=="cdata"){return G(N,a.$notTransContent[N.parent.tag]);}else{if(N.type=="comment"){return"<!--"+N.data+"-->";}}}}return"";};}();var F={text:"#text",comment:"#comment",cdata:"#cdata-section",fragment:"#document-fragment"};function A(J,K){var M=[0,10,12,16,18,24,32,48],L,O=p.indexOf;switch(J.tag){case"script":J.tag="div";J.attributes._ue_org_tagName="script";J.attributes._ue_div_script=1;J.attributes._ue_script_data=J.children[0]?encodeURIComponent(J.children[0].data):"";J.attributes._ue_custom_node_=1;J.children=[];break;case"style":J.tag="div";J.attributes._ue_div_style=1;J.attributes._ue_org_tagName="style";J.attributes._ue_style_data=J.children[0]?encodeURIComponent(J.children[0].data):"";J.attributes._ue_custom_node_=1;J.children=[];break;case"img":if(J.attributes.src&&/^data:/.test(J.attributes.src)){return{type:"fragment",children:[]};}if(J.attributes.src&&/^(?:file)/.test(J.attributes.src)){if(!/(gif|bmp|png|jpg|jpeg)$/.test(J.attributes.src)){return{type:"fragment",children:[]};}J.attributes.word_img=J.attributes.src;J.attributes.src=B.options.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";var N=parseInt(J.attributes.width)<128||parseInt(J.attributes.height)<43;J.attributes.style="background:url("+(N?B.options.themePath+B.options.theme+"/images/word.gif":B.options.langPath+B.options.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd";K&&(K.flag=1);}if(k.ie&&k.version<7){J.attributes.orgSrc=J.attributes.src;}J.attributes.data_ue_src=J.attributes.data_ue_src||J.attributes.src;break;case"li":var H=J.children[0];if(!H||H.type!="element"||H.tag!="p"&&a.p[H.tag]){var I={type:"element",tag:"p",attributes:{},parent:J};I.children=H?J.children:[k.ie?{type:"text",data:f.fillChar,parent:I}:{type:"element",tag:"br",attributes:{},closed:true,children:[],parent:I}];J.children=[I];}break;case"table":case"td":u(J);break;case"a":if(J.attributes.anchorname){J.tag="img";J.attributes={"class":"anchorclass",anchorname:J.attributes.name};J.closed=1;}J.attributes.href&&(J.attributes.data_ue_src=J.attributes.href);break;case"b":J.tag=J.name="strong";break;case"i":J.tag=J.name="em";break;case"u":J.tag=J.name="span";J.attributes.style=(J.attributes.style||"")+";text-decoration:underline;";break;case"s":case"del":J.tag=J.name="span";J.attributes.style=(J.attributes.style||"")+";text-decoration:line-through;";if(J.children.length==1){H=J.children[0];if(H.tag==J.tag){J.attributes.style+=";"+H.attributes.style;J.children=H.children;}}break;case"span":var G=J.attributes.style;if(G){if(!J.attributes.style||k.webkit&&G=="white-space:nowrap;"){delete J.attributes.style;}}if(k.gecko&&k.version<=10902&&J.parent){var P=J.parent;if(P.tag=="span"&&P.attributes&&P.attributes.style){J.attributes.style=P.attributes.style+";"+J.attributes.style;}}if(p.isEmptyObject(J.attributes)&&s){J.type="fragment";}break;case"font":J.tag=J.name="span";L=J.attributes;J.attributes={style:(L.size?"font-size:"+(M[L.size]||12)+"px":"")+";"+(L.color?"color:"+L.color:"")+";"+(L.face?"font-family:"+L.face:"")+";"+(L.style||"")};while(J.parent.tag==J.tag&&J.parent.children.length==1){J.attributes.style&&(J.parent.attributes.style?(J.parent.attributes.style+=";"+J.attributes.style):(J.parent.attributes.style=J.attributes.style));J.parent.children=J.children;J=J.parent;}break;case"p":if(J.attributes.align){J.attributes.style=(J.attributes.style||"")+";text-align:"+J.attributes.align+";";delete J.attributes.align;}}return J;}function u(H){if(r&&H.attributes.style){var G=H.attributes.style;H.attributes.style=G.replace(/;\s*/g,";");H.attributes.style=H.attributes.style.replace(/^\s*|\s*$/,"");}}function D(G){switch(G.tag){case"div":if(G.attributes._ue_div_script){G.tag="script";G.children=[{type:"cdata",data:G.attributes._ue_script_data?decodeURIComponent(G.attributes._ue_script_data):"",parent:G}];delete G.attributes._ue_div_script;delete G.attributes._ue_script_data;delete G.attributes._ue_custom_node_;delete G.attributes._ue_org_tagName;}if(G.attributes._ue_div_style){G.tag="style";G.children=[{type:"cdata",data:G.attributes._ue_style_data?decodeURIComponent(G.attributes._ue_style_data):"",parent:G}];delete G.attributes._ue_div_style;delete G.attributes._ue_style_data;delete G.attributes._ue_custom_node_;delete G.attributes._ue_org_tagName;}break;case"table":!G.attributes.style&&delete G.attributes.style;if(r&&G.attributes.style){u(G);}break;case"td":case"th":if(/display\s*:\s*none/i.test(G.attributes.style)){return{type:"fragment",children:[]};}if(r&&!G.children.length){var H={type:"text",data:f.fillChar,parent:G};G.children[0]=H;}if(r&&G.attributes.style){u(G);}break;case"img":if(G.attributes.anchorname){G.tag="a";G.attributes={name:G.attributes.anchorname,anchorname:1};G.closed=null;}else{if(G.attributes.data_ue_src){G.attributes.src=G.attributes.data_ue_src;delete G.attributes.data_ue_src;}}break;case"a":if(G.attributes.data_ue_src){G.attributes.href=G.attributes.data_ue_src;delete G.attributes.data_ue_src;}}return G;}function x(M,L,G){if(!M.children||!M.children.length){return M;}var K=M.children;for(var J=0;J<K.length;J++){var I=L(K[J],G);if(I.type=="fragment"){var H=[J,1];H.push.apply(H,I.children);K.splice.apply(K,H);if(!K.length){M={type:"fragment",children:[]};}J--;}else{K[J]=I;}}return M;}function t(G){this.rules=G;}t.prototype={rules:null,filter:function(I,L,K){L=L||this.rules;var H=L&&L.whiteList;var G=L&&L.blackList;function J(Q,P){Q.name=Q.type=="element"?Q.tag:F[Q.type];if(P==null){return x(Q,J,Q);}if(G&&(G[Q.name]||(Q.attributes&&Q.attributes._ue_org_tagName&&G[Q.attributes._ue_org_tagName]))){K&&(K.flag=1);return{type:"fragment",children:[]};}if(H){if(Q.type=="element"){if(P.type=="fragment"?H[Q.name]:H[Q.name]&&H[P.name][Q.name]){var O;if((O=H[Q.name].$)){var R=Q.attributes;var N={};for(var M in O){if(R[M]){N[M]=R[M];}}Q.attributes=N;}}else{K&&(K.flag=1);Q.type="fragment";Q.name=P.name;}}else{}}if(G||H){x(Q,J,Q);}return Q;}return J(I,null);},transformInput:function(H,G){function I(J){J=A(J,G);J=x(J,I,J);if(B.options.pageBreakTag&&J.type=="text"&&J.data.replace(/\s/g,"")==B.options.pageBreakTag){J.type="element";J.name=J.tag="hr";delete J.data;J.attributes={"class":"pagebreak",noshade:"noshade",size:"5",unselectable:"on",style:"moz-user-select:none;-khtml-user-select: none;"};J.children=[];}if(J.type=="text"&&!a.$notTransContent[J.parent.tag]){J.data=J.data.replace(/[\r\t\n]*/g,"");}return J;}return I(H);},transformOutput:function(G){function H(I){if(I.tag=="hr"&&I.attributes["class"]=="pagebreak"){delete I.tag;I.type="text";I.data=B.options.pageBreakTag;delete I.children;}I=D(I);I=x(I,H,I);return I;}return H(G);},toHTML:w,parseHTML:E,word:UE.filterWord};B.serialize=new t(B.options.serialize||{});UE.serialize=new t({});};UE.plugins.table=function(){var O=this,U=true;function A(ap){if(U){throw ap;}}var X=null,y=null,E="",ad=false,u=null,aa=false,x=null,ag=null;var M=false,ae=true;O.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,defaultRows:5,tdvalign:"top",cursorpath:O.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:false});O.getUETable=T;var ac={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,averagedistributecol:1,averagedistributerow:1};O.ready(function(){p.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{ background:white; padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:2px solid #BBB;background:#F7F7F7;}td p{margin:0;padding:0;}",O.document);var aq,at,ap;O.addListener("keydown",function(ay,aG){var aE=this;var aH=aG.keyCode||aG.which;if(aH==8){var az=N(aE);if(az&&az.selectedTds.length){aE.fireEvent("saveScene");if(az.isFullCol()){aE.execCommand("deletecol");}else{if(az.isFullRow()){aE.execCommand("deleterow");}else{aE.fireEvent("delcells");}}f.preventDefault(aG);}var aJ=f.findParentByTagName(aE.selection.getStart(),"caption",true),aD=aE.selection.getRange();if(aD.collapsed&&aJ&&v(aJ)){aE.fireEvent("saveScene");var aI=aJ.parentNode;f.remove(aJ);if(aI){aD.setStart(aI.rows[0].cells[0],0).setCursor(false,true);}}aE.fireEvent("saveScene");}if(aH==46){az=N(aE);if(az){aE.fireEvent("saveScene");for(var aB=0,aK;aK=az.selectedTds[aB++];){f.fillNode(aE.document,aK);}aE.fireEvent("saveScene");f.preventDefault(aG);}}if(aH==13){var aw=aE.selection.getRange(),aJ=f.findParentByTagName(aw.startContainer,"caption",true);if(aJ){var aI=f.findParentByTagName(aJ,"table");if(!aw.collapsed){aw.deleteContents();aE.fireEvent("saveScene");}else{if(aJ){aw.setStart(aI.rows[0].cells[0],0).setCursor(false,true);}}f.preventDefault(aG);return;}if(aw.collapsed){var aI=f.findParentByTagName(aw.startContainer,"table");if(aI){var aF=aI.rows[0].cells[0],ax=f.findParentByTagName(aE.selection.getStart(),["td","th"],true),aC=aI.previousSibling;if(aF===ax&&(!aC||aC.nodeType==1&&aC.tagName=="TABLE")&&f.isStartInblock(aw)){aE.execCommand("insertparagraphbeforetable");f.preventDefault(aG);}}}}if((aG.ctrlKey||aG.metaKey)&&aG.keyCode=="67"){aq=null;aI=N(aE);if(aI){var aA=aI.selectedTds;at=aI.isFullCol();ap=aI.isFullRow();aq=[[S(aA[0])]];for(var aB=1,aK;aK=aA[aB];aB++){if(aK.parentNode!==aA[aB-1].parentNode){aq.push([S(aK)]);}else{aq[aq.length-1].push(S(aK));}}}}});O.addListener("beforepaste",function(aO,aI){var aS=this;var az=aS.selection.getRange();if(f.findParentByTagName(az.startContainer,"caption",true)){var aK=aS.document.createElement("div");aK.innerHTML=aI.html;aI.html=aK[k.ie?"innerText":"textContent"];return;}var aQ=N(aS);if(aq){aS.fireEvent("saveScene");var az=aS.selection.getRange();var aA=f.findParentByTagName(az.startContainer,["td","th"],true),aR,aw;if(aA){var aB=T(aA);if(ap){var aG=aB.getCellInfo(aA).rowIndex;if(aA.tagName=="TH"){aG++;}for(var aP=0,aH;aH=aq[aP++];){var ax=aB.insertRow(aG++,"td");for(var aN=0,aF;aF=aH[aN];aN++){var ay=ax.cells[aN];if(!ay){ay=ax.insertCell(aN);}ay.innerHTML=aF.innerHTML;aF.getAttribute("width")&&ay.setAttribute("width",aF.getAttribute("width"));aF.getAttribute("vAlign")&&ay.setAttribute("vAlign",aF.getAttribute("vAlign"));aF.getAttribute("align")&&ay.setAttribute("align",aF.getAttribute("align"));aF.style.cssText&&(ay.style.cssText=aF.style.cssText);}for(var aN=0,aF;aF=ax.cells[aN];aN++){if(!aH[aN]){break;}aF.innerHTML=aH[aN].innerHTML;aH[aN].getAttribute("width")&&aF.setAttribute("width",aH[aN].getAttribute("width"));aH[aN].getAttribute("vAlign")&&aF.setAttribute("vAlign",aH[aN].getAttribute("vAlign"));aH[aN].getAttribute("align")&&aF.setAttribute("align",aH[aN].getAttribute("align"));aH[aN].style.cssText&&(aF.style.cssText=aH[aN].style.cssText);}}}else{if(at){aD=aB.getCellInfo(aA);var aE=0;for(var aN=0,aH=aq[0],aF;aF=aH[aN++];){aE+=aF.colSpan||1;}aS.__hasEnterExecCommand=true;for(aP=0;aP<aE;aP++){aS.execCommand("insertcol");}aS.__hasEnterExecCommand=false;aA=aB.table.rows[0].cells[aD.cellIndex];if(aA.tagName=="TH"){aA=aB.table.rows[1].cells[aD.cellIndex];}}for(var aP=0,aH;aH=aq[aP++];){aR=aA;for(var aN=0,aF;aF=aH[aN++];){if(aA){aA.innerHTML=aF.innerHTML;aF.getAttribute("width")&&aA.setAttribute("width",aF.getAttribute("width"));aF.getAttribute("vAlign")&&aA.setAttribute("vAlign",aF.getAttribute("vAlign"));aF.getAttribute("align")&&aA.setAttribute("align",aF.getAttribute("align"));aF.style.cssText&&(aA.style.cssText=aF.style.cssText);aw=aA;aA=aA.nextSibling;}else{var aJ=aF.cloneNode(true);f.removeAttributes(aJ,["class","rowSpan","colSpan"]);aw.parentNode.appendChild(aJ);}}aA=aB.getNextCell(aR,true,true);if(!aq[aP]){break;}if(!aA){var aD=aB.getCellInfo(aR);aB.table.insertRow(aB.table.rows.length);aB.update();aA=aB.getVSideCell(aR,true);}}}aB.update();}else{aQ=aS.document.createElement("table");for(var aP=0,aH;aH=aq[aP++];){var ax=aQ.insertRow(aQ.rows.length);for(var aN=0,aF;aF=aH[aN++];){aJ=S(aF);f.removeAttributes(aJ,["class"]);ax.appendChild(aJ);}if(aN==2&&aJ.rowSpan>1){aJ.rowSpan=1;}}var aM=w(aS),aL=aS.body.offsetWidth-(ae?parseInt(f.getComputedStyle(aS.body,"margin-left"),10)*2:0)-aM.tableBorder*2-(aS.options.offsetWidth||0);aS.execCommand("insertHTML","<table  "+(at&&ap?'width="'+aL+'"':"")+">"+aQ.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>");}aS.fireEvent("contentchange");aS.fireEvent("saveScene");aI.html="";}else{var aK=aS.document.createElement("div"),aC;aK.innerHTML=aI.html;aC=aK.getElementsByTagName("table");if(f.findParentByTagName(aS.selection.getStart(),"table")){p.each(aC,function(aT){f.remove(aT);});if(f.findParentByTagName(aS.selection.getStart(),"caption",true)){aK.innerHTML=aK[k.ie?"innerText":"textContent"];}}else{p.each(aC,function(aT){an(aT,true);f.removeAttributes(aT,["style","border"]);p.each(f.getElementsByTagName(aT,"td"),function(aU){if(v(aU)){f.fillNode(aS.document,aU);}an(aU,true);});});}aI.html=aK.innerHTML;}});O.addListener("afterpaste",function(){p.each(f.getElementsByTagName(O.body,"table"),function(ax){if(ax.offsetWidth>O.body.offsetWidth){var aw=w(O,ax);ax.style.width=O.body.offsetWidth-(ae?parseInt(f.getComputedStyle(O.body,"margin-left"),10)*2:0)-aw.tableBorder*2-(O.options.offsetWidth||0)+"px";}});});O.addListener("blur",function(){aq=null;});var av;O.addListener("keydown",function(){clearTimeout(av);av=setTimeout(function(){var ax=O.selection.getRange(),aw=f.findParentByTagName(ax.startContainer,["th","td"],true);if(aw){var ay=aw.parentNode.parentNode.parentNode;if(ay.offsetWidth>ay.getAttribute("width")){aw.style.wordBreak="break-all";}}},100);});O.addListener("selectionchange",function(){R(O,false,"",null);});O.addListener("contentchange",function(){var ax=this;H(ax);if(N(ax)){return;}var aw=ax.selection.getRange();var ay=aw.startContainer;ay=f.findParentByTagName(ay,["td","th"],true);p.each(f.getElementsByTagName(ax.document,"table"),function(az){if(ax.fireEvent("excludetable",az)===true){return;}az.ueTable=new r(az);p.each(f.getElementsByTagName(ax.document,"td"),function(aA){if(f.isEmptyBlock(aA)&&aA!==ay){f.fillNode(ax.document,aA);if(k.ie&&k.version==6){aA.innerHTML="&nbsp;";}}});p.each(f.getElementsByTagName(ax.document,"th"),function(aA){if(f.isEmptyBlock(aA)&&aA!==ay){f.fillNode(ax.document,aA);if(k.ie&&k.version==6){aA.innerHTML="&nbsp;";}}});az.onmousemove=function(){ax.options.tableDragable&&P(true,this,ax);};az.onmouseout=function(){R(ax,false,"",null);H(ax);};az.onclick=function(aG){aG=ax.window.event||aG;var aE=af(aG.target||aG.srcElement);if(!aE){return;}var aC=T(aE),aH=aC.table,aD=aC.getCellInfo(aE),aA,aB=ax.selection.getRange();if(ab(aH,aE,aG,true)){var aI=aC.getCell(aC.indexTable[aC.rowsNum-1][aD.colIndex].rowIndex,aC.indexTable[aC.rowsNum-1][aD.colIndex].cellIndex);if(aG.shiftKey&&aC.selectedTds.length){if(aC.selectedTds[0]!==aI){aA=aC.getCellsRange(aC.selectedTds[0],aI);aC.setSelected(aA);}else{aB&&aB.selectNodeContents(aI).select();}}else{if(aE!==aI){aA=aC.getCellsRange(aE,aI);aC.setSelected(aA);}else{aB&&aB.selectNodeContents(aI).select();}}return;}if(ab(aH,aE,aG)){var aF=aC.getCell(aC.indexTable[aD.rowIndex][aC.colsNum-1].rowIndex,aC.indexTable[aD.rowIndex][aC.colsNum-1].cellIndex);if(aG.shiftKey&&aC.selectedTds.length){if(aC.selectedTds[0]!==aF){aA=aC.getCellsRange(aC.selectedTds[0],aF);aC.setSelected(aA);}else{aB&&aB.selectNodeContents(aF).select();}}else{if(aE!==aF){aA=aC.getCellsRange(aE,aF);aC.setSelected(aA);}else{aB&&aB.selectNodeContents(aF).select();}}}};az.ondblclick=function(aB){aB=ax.window.event||aB;var aD=af(aB.target||aB.srcElement);if(aD){var aC;if(aC=K(aD,V(aB))){if(aC=="h1"){aC="h";if(ab(f.findParentByTagName(aD,"table"),aD,aB)){ax.execCommand("adaptbywindow");}else{aD=T(aD).getPreviewCell(aD);if(aD){var aA=ax.selection.getRange();aA.selectNodeContents(aD).setCursor(true,true);}}}aC=="h"&&ax.execCommand("adaptbytext");}}};});D(true);});if(!k.ie||(k.ie&&k.version>7)){f.on(O.document,"mousemove",G);}f.on(O.document,"mouseout",function(aw){var ax=aw.target||aw.srcElement;if(ax.tagName=="TABLE"){R(O,false,"",null);}});O.addListener("mousedown",t);O.addListener("mouseup",C);var au=0;O.addListener("mousedown",function(){au=0;});O.addListener("tabkeydown",function(){var ax=this.selection.getRange(),aA=ax.getCommonAncestor(true,true),aB=f.findParentByTagName(aA,"table");if(aB){if(f.findParentByTagName(aA,"caption",true)){var aw=f.getElementsByTagName(aB,"th td");if(aw&&aw.length){ax.setStart(aw[0],0).setCursor(false,true);}}else{var aw=f.findParentByTagName(aA,["td","th"],true),ay=T(aw);au=aw.rowSpan>1?au:ay.getCellInfo(aw).rowIndex;var az=ay.getTabNextCell(aw,au);if(az){if(v(az)){ax.setStart(az,0).setCursor(false,true);}else{ax.selectNodeContents(az).select();}}else{O.fireEvent("saveScene");O.__hasEnterExecCommand=true;this.execCommand("insertrownext");O.__hasEnterExecCommand=false;ax=this.selection.getRange();ax.setStart(aB.rows[aB.rows.length-1].cells[0],0).setCursor();O.fireEvent("saveScene");}}return true;}});k.ie&&O.addListener("selectionchange",function(){R(this,false,"",null);});O.addListener("keydown",function(ax,aw){var ay=this;var aA=aw.keyCode||aw.which;if(aA==8||aA==46){return;}var aB=!aw.ctrlKey&&!aw.metaKey&&!aw.shiftKey&&!aw.altKey;aB&&L(f.getElementsByTagName(ay.body,"td"));var az=N(ay);if(!az){return;}aB&&az.clearSelected();});O.addListener("beforegetcontent",function(){D(false);k.ie&&p.each(O.document.getElementsByTagName("caption"),function(aw){if(f.isEmptyNode(aw)){aw.innerHTML="&nbsp;";}});});O.addListener("aftergetcontent",function(){D(true);});O.addListener("getAllHtml",function(){L(O.document.getElementsByTagName("td"));});O.addListener("fullscreenchanged",function(ay,az){if(!az){var ax=this.body.offsetWidth/document.body.offsetWidth,aw=f.getElementsByTagName(this.body,"table");p.each(aw,function(aC){if(aC.offsetWidth<O.body.offsetWidth){return false;}var aB=f.getElementsByTagName(aC,"td"),aD=[];p.each(aB,function(aF){aD.push(aF.offsetWidth);});for(var aA=0,aE;aE=aB[aA];aA++){aE.setAttribute("width",Math.floor(aD[aA]*ax));}aC.setAttribute("width",Math.floor(ai(O,ae,w(O))));});}});var ar=O.execCommand;O.execCommand=function(ay){var aF=this;ay=ay.toLowerCase();var az=N(aF),aC,aD=new h.Range(aF.document),aE=aF.commands[ay]||UE.commands[ay],aI;if(!aE){return;}if(az&&!ac[ay]&&!aE.notNeedUndo&&!aF.__hasEnterExecCommand){aF.__hasEnterExecCommand=true;aF.fireEvent("beforeexeccommand",ay);aC=az.selectedTds;var aw=-2,aG=-2,aH,ax;for(var aB=0,aA;aA=aC[aB];aB++){if(v(aA)){aD.setStart(aA,0).setCursor(false,true);}else{aD.selectNodeContents(aA).select(true);}ax=aF.queryCommandState(ay);aH=aF.queryCommandValue(ay);if(ax!=-1){if(aw!==ax||aG!==aH){aF._ignoreContentChange=true;aI=ar.apply(aF,arguments);aF._ignoreContentChange=false;}aw=aF.queryCommandState(ay);aG=aF.queryCommandValue(ay);if(f.isEmptyBlock(aA)){f.fillNode(aF.document,aA);}}}aD.setStart(aC[0],0).shrinkBoundary(true).setCursor(false,true);aF.fireEvent("contentchange");aF.fireEvent("afterexeccommand",ay);aF.__hasEnterExecCommand=false;aF._selectionChange();}else{aI=ar.apply(aF,arguments);}return aI;};});function an(aq,ap){aj(aq,"width",true);aj(aq,"height",true);}function aj(ar,aq,ap){if(ar.style[aq]){ap&&ar.setAttribute(aq,parseInt(ar.style[aq],10));ar.style[aq]="";}}function af(ap){if(ap.tagName=="TD"||ap.tagName=="TH"){return ap;}var aq;if(aq=f.findParentByTagName(ap,"td",true)||f.findParentByTagName(ap,"th",true)){return aq;}return null;}function v(aq){var ap=new RegExp(f.fillChar,"g");if(aq[k.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(ap,"").length>0){return 0;}for(var ar in a.$isNotEmpty){if(aq.getElementsByTagName(ar).length){return 0;}}return 1;}function V(ap){if(ap.pageX||ap.pageY){return{x:ap.pageX,y:ap.pageY};}return{x:ap.clientX+O.document.body.scrollLeft-O.document.body.clientLeft,y:ap.clientY+O.document.body.scrollTop-O.document.body.clientTop};}function G(ap){try{var au=af(ap.target||ap.srcElement),av;if(E&&ag){O.document.body.style.webkitUserSelect="none";O.selection.getNative()[k.ie?"empty":"removeAllRanges"]();av=V(ap);R(O,true,"",av,au);if(E=="h"){x.style.left=s(ag,ap)+"px";}else{if(E=="v"){x.style.top=ao(ag,ap)+"px";}}return;}if(au){if(O.fireEvent("excludetable",au)===true){return;}av=V(ap);var ar=K(au,av),aq=f.findParentByTagName(au,"table",true);if(ab(aq,au,ap,true)){if(O.fireEvent("excludetable",aq)===true){return;}O.body.style.cursor="url("+O.options.cursorpath+"h.png),pointer";}else{if(ab(aq,au,ap)){if(O.fireEvent("excludetable",aq)===true){return;}O.body.style.cursor="url("+O.options.cursorpath+"v.png),pointer";}else{O.body.style.cursor="text";if(/\d/.test(ar)){ar=ar.replace(/\d/,"");au=T(au).getPreviewCell(au,ar=="v");}R(O,au?!!ar:false,au?ar:"",av,au);}}}else{P(false,aq,O);}}catch(at){A(at);}}var J;function P(ap,ar,aq){if(!ap){if(aa){return;}J=setTimeout(function(){!aa&&u&&u.parentNode&&u.parentNode.removeChild(u);},2000);}else{W(ar,aq);}}function W(aq,ap){var aw=f.getXY(aq),ar=aq.ownerDocument;if(u&&u.parentNode){return u;}u=ar.createElement("div");u.contentEditable=false;u.innerHTML="";u.style.cssText="width:15px;height:15px;background-image:url("+ap.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(aw.y-15)+"px;left:"+(aw.x)+"px;";f.unSelectable(u);u.onmouseover=function(ax){aa=true;};u.onmouseout=function(ax){aa=false;};f.on(u,"click",function(ay,ax){au(ax,this);});f.on(u,"dblclick",function(ay,ax){at(ax);});f.on(u,"dragstart",function(ay,ax){f.preventDefault(ax);});var av;function au(ax,ay){clearTimeout(av);av=setTimeout(function(){ap.fireEvent("tableClicked",aq,ay);},300);}function at(ay){clearTimeout(av);var aA=T(aq),aB=aq.rows[0].cells[0],ax=aA.getLastCell(),az=aA.getCellsRange(aB,ax);ap.selection.getRange().setStart(aB,0).setCursor(false,true);aA.setSelected(az);}ar.body.appendChild(u);}function ab(au,ap,ar,aw){var ax=V(ar),av=K(ap,ax);if(aw){var at=au.getElementsByTagName("caption")[0],aq=at?at.offsetHeight:0;return(av=="v1")&&((ax.y-f.getXY(au).y-aq)<8);}else{return(av=="h1")&&((ax.x-f.getXY(au).x)<8);}}function s(av,ap){var aw=T(av);if(aw){var at=aw.getSameEndPosCells(av,"x")[0],au=aw.getSameStartPosXCells(av)[0],ar=V(ap).x,ax=(at?f.getXY(at).x:f.getXY(aw.table).x)+20,aq=au?f.getXY(au).x+au.offsetWidth-20:(O.body.offsetWidth+5||parseInt(f.getComputedStyle(O.body,"width"),10));return ar<ax?ax:ar>aq?aq:ar;}}function ao(aq,ap){try{var at=f.getXY(aq).y,au=V(ap).y;return au<at?at:au;}catch(ar){A(ar);}}function R(at,au,ar,aq,ap){try{at.body.style.cursor=ar=="h"?"col-resize":ar=="v"?"row-resize":"text";if(k.ie){if(ar&&!M&&!N(at)){al(at,at.document);Z(ar,ap);}else{H(at);}}ad=au;}catch(av){A(av);}}function K(aq,ap){var ar=f.getXY(aq);if(ar.x+aq.offsetWidth-ap.x<4){return"h";}if(ap.x-ar.x<4){return"h1";}if(ar.y+aq.offsetHeight-ap.y<4){return"v";}if(ap.y-ar.y<4){return"v1";}return"";}function t(ar,aq){if(aq.button==2){var av=N(O),ap=false;if(av){var aw=Q(O,aq);p.each(av.selectedTds,function(ax){if(ax===aw){ap=true;}});if(!ap){L(f.getElementsByTagName(O.body,"td"));L(f.getElementsByTagName(O.body,"th"));av.clearSelected();}else{aw=av.selectedTds[0];setTimeout(function(){O.selection.getRange().setStart(aw,0).setCursor(false,true);},0);}}return;}if(aq.shiftKey){return;}L(f.getElementsByTagName(O.body,"td"));L(f.getElementsByTagName(O.body,"th"));p.each(O.document.getElementsByTagName("table"),function(ax){ax.ueTable=null;});X=Q(O,aq);if(!X){return;}var at=f.findParentByTagName(X,"table",true);av=T(at);av&&av.clearSelected();if(!ad){O.document.body.style.webkitUserSelect="";M=true;O.addListener("mouseover",I);}else{if(k.ie&&k.version<8){return;}var au=K(X,V(aq));if(/\d/.test(au)){au=au.replace(/\d/,"");X=T(X).getPreviewCell(X,au=="v");}H(O);al(O,O.document);Z(au,X);M=true;E=au;ag=X;}}function L(ap){p.each(ap,function(aq){f.removeClasses(aq,"selectTdClass");});}function F(ap){p.each(ap,function(aq){f.addClass(aq,"selectTdClass");});}function am(ap){if(!ap){return 0;}return parseInt(f.getComputedStyle(ap,"width"),10);}function ah(ay,at){if(Math.abs(at)<10){return;}var aq=T(ay);if(aq){var az=aq.table,au=am(az),av=w(O,az),ap=aq.getSameEndPosCells(ay,"x"),ax=am(ap[0])-av.tdPadding*2-av.tdBorder,ar=aq.getSameStartPosXCells(ay),aw=am(ar[0])-av.tdPadding*2-av.tdBorder;p.each(ap,function(aA){if(aA.style.width){aA.style.width="";}if(at<0){aA.style.wordBreak="break-all";}aA.setAttribute("width",ax+at);});p.each(ar,function(aA){if(aA.style.width){aA.style.width="";}if(at>0){aA.style.wordBreak="break-all";}aA.setAttribute("width",aw-at);});if(!ay.nextSibling){if(az.style.width){az.style.width="";}az.setAttribute("width",au+at);}}}function z(aw,au){if(Math.abs(au)<10){return;}var av=T(aw);if(av){var ar=av.getSameEndPosCells(aw,"y"),aq=ar[0]?ar[0].offsetHeight:0;for(var at=0,ap;ap=ar[at++];){ak(ap,au,aq);}}}function ak(aq,ap,ar){var at=parseInt(f.getComputedStyle(aq,"line-height"),10),au=ar+ap;ap=au<at?at:au;if(aq.style.height){aq.style.height="";}aq.rowSpan==1?aq.setAttribute("height",ap):(aq.removeAttribute&&aq.removeAttribute("height"));}function C(ay,aA){if(aA.button==2){return;}var ax=this;var av=ax.selection.getRange(),ap=f.findParentByTagName(av.startContainer,"table",true),at=f.findParentByTagName(av.endContainer,"table",true);if(ap||at){if(ap===at){ap=f.findParentByTagName(av.startContainer,["td","th","caption"],true);at=f.findParentByTagName(av.endContainer,["td","th","caption"],true);if(ap!==at){ax.selection.clearRange();}}else{ax.selection.clearRange();}}M=false;ax.document.body.style.webkitUserSelect="";if((!k.ie||(k.ie&&k.version>7))&&E&&ag){x=ax.document.getElementById("ue_tableDragLine");var ar=f.getXY(ag),au=f.getXY(x);switch(E){case"h":ah(ag,au.x-ar.x-ag.offsetWidth);break;case"v":z(ag,au.y-ar.y-ag.offsetHeight);break;default:}E="";ag=null;H(ax);return;}if(!X){var aw=f.findParentByTagName(aA.target||aA.srcElement,"td",true);if(!aw){aw=f.findParentByTagName(aA.target||aA.srcElement,"th",true);}if(aw&&(aw.tagName=="TD"||aw.tagName=="TH")){if(ax.fireEvent("excludetable",aw)===true){return;}av=new h.Range(ax.document);av.setStart(aw,0).setCursor(false,true);}}else{var aq=T(X),az=aq?aq.selectedTds[0]:null;if(az){av=new h.Range(ax.document);if(f.isEmptyBlock(az)){av.setStart(az,0).setCursor(false,true);}else{av.selectNodeContents(az).shrinkBoundary().setCursor(false,true);}}else{av=ax.selection.getRange().shrinkBoundary();if(!av.collapsed){var ap=f.findParentByTagName(av.startContainer,["td","th"],true),at=f.findParentByTagName(av.endContainer,["td","th"],true);if(ap&&!at||!ap&&at||ap&&at&&ap!==at){av.setCursor(false,true);}}}X=null;ax.removeListener("mouseover",I);}ax._selectionChange(250,aA);}function I(at,aq){var au=this,ap=aq.target||aq.srcElement;y=f.findParentByTagName(ap,"td",true)||f.findParentByTagName(ap,"th",true);if(X&&y&&((X.tagName=="TD"&&y.tagName=="TD")||(X.tagName=="TH"&&y.tagName=="TH"))&&f.findParentByTagName(X,"table")==f.findParentByTagName(y,"table")){var av=T(y);if(X!=y){au.document.body.style.webkitUserSelect="none";au.selection.getNative()[k.ie?"empty":"removeAllRanges"]();var ar=av.getCellsRange(X,y);av.setSelected(ar);}else{au.document.body.style.webkitUserSelect="";av.clearSelected();}}aq.preventDefault?aq.preventDefault():(aq.returnValue=false);}function T(aq){var ap=aq.tagName.toLowerCase();aq=(ap=="td"||ap=="th"||ap=="caption")?f.findParentByTagName(aq,"table",true):aq;if(!aq.ueTable){aq.ueTable=new r(aq);}return aq.ueTable;}function N(ap){var aq=Y(ap).table;if(aq&&aq.ueTable&&aq.ueTable.selectedTds.length){return aq.ueTable;}return null;}function al(ap,aq){if(M){return;}x=ap.document.createElement("div");f.setAttributes(x,{id:"ue_tableDragLine",unselectable:"on",contenteditable:false,onresizestart:"return false",ondragstart:"return false",onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});ap.body.appendChild(x);}function H(aq){if(M){return;}var ap;while(ap=aq.document.getElementById("ue_tableDragLine")){f.remove(ap);}}function Z(ap,au){if(!au){return;}var aw=f.findParentByTagName(au,"table"),ay=aw.getElementsByTagName("caption"),aq=aw.offsetWidth,av=aw.offsetHeight-(ay.length>0?ay[0].offsetHeight:0),at=f.getXY(aw),ax=f.getXY(au),ar;switch(ap){case"h":ar="height:"+av+"px;top:"+(at.y+(ay.length>0?ay[0].offsetHeight:0))+"px;left:"+(ax.x+au.offsetWidth-2);x.style.cssText=ar+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case"v":ar="width:"+aq+"px;left:"+at.x+"px;top:"+(ax.y+au.offsetHeight-2);x.style.cssText=ar+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)";break;default:}}function D(ap){var ar=f.getElementsByTagName(O.body,"table"),aq;for(var at=0,au;au=ar[at++];){var av=f.getElementsByTagName(au,"td");if(av[0]){if(ap){aq=(av[0].style.borderColor).replace(/\s/g,"");if(/(#ffffff)|(rgb\(255,f55,255\))/ig.test(aq)){f.addClass(au,"noBorderTable");}}else{f.removeClasses(au,"noBorderTable");}}}}function ai(ar,at,aq){var ap=ar.body;return ap.offsetWidth-(at?parseInt(f.getComputedStyle(ap,"margin-left"),10)*2:0)-aq.tableBorder*2-(ar.options.offsetWidth||0);}UE.commands.inserttable={queryCommandState:function(){return Y(this).table?-1:0;},execCommand:function(ar,aq){function ay(aD,aB,aH){var aC=[],aF=aD.numRows,aA=aD.numCols;for(var aE=0;aE<aF;aE++){aC.push("<tr>");for(var aG=0;aG<aA;aG++){aC.push('<td width="'+aH+'"  vAlign="'+aD.tdvalign+'" >'+(k.ie?f.fillChar:"<br/>")+"</td>");}aC.push("</tr>");}return'<table width="'+aB+'"   ><tbody>'+aC.join("")+"</tbody></table>";}if(!aq){aq=p.extend({},{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign});}var at=this.selection.getRange(),ap=at.startContainer,az=f.findParent(ap,function(aA){return f.isBlockElm(aA);},true);var aw=this,ax=w(aw),av=ai(aw,ae,ax)-(az?parseInt(f.getXY(az).x,10):0),au=Math.floor(av/aq.numCols-ax.tdPadding*2-ax.tdBorder);!aq.tdvalign&&(aq.tdvalign=aw.options.tdvalign);aw.execCommand("inserthtml",ay(aq,av,au));}};UE.commands.insertparagraphbeforetable={queryCommandState:function(){return Y(this).cell?0:-1;},execCommand:function(){var ap=Y(this).table;if(ap){var aq=this.document.createElement("p");aq.innerHTML=k.ie?"&nbsp;":"<br />";ap.parentNode.insertBefore(aq,ap);this.selection.getRange().setStart(aq,0).setCursor();}}};UE.commands.deletetable={queryCommandState:function(){var ap=this.selection.getRange();return f.findParentByTagName(ap.startContainer,"table",true)?0:-1;},execCommand:function(at,ar){var ap=this.selection.getRange();ar=ar||f.findParentByTagName(ap.startContainer,"table",true);if(ar){var aq=ar.nextSibling;if(!aq){aq=f.createElement(this.document,"p",{innerHTML:k.ie?f.fillChar:"<br/>"});ar.parentNode.insertBefore(aq,ar);}f.remove(ar);ap=this.selection.getRange();if(aq.nodeType==3){ap.setStartBefore(aq);}else{ap.setStart(aq,0);}ap.setCursor(false,true);R(this,false,"",null);if(u){f.remove(u);}}}};UE.commands.cellalign={queryCommandState:function(){return B(this).length?0:-1;},execCommand:function(at,au){var ap=B(this);if(ap.length){for(var ar=0,aq;aq=ap[ar++];){aq.setAttribute("align",au);}}}};UE.commands.cellvalign={queryCommandState:function(){return B(this).length?0:-1;},execCommand:function(au,at){var ap=B(this);if(ap.length){for(var ar=0,aq;aq=ap[ar++];){aq.setAttribute("vAlign",at);}}}};UE.commands.insertcaption={queryCommandState:function(){var ap=Y(this).table;if(ap){return ap.getElementsByTagName("caption").length==0?1:-1;}return -1;},execCommand:function(){var ar=Y(this).table;if(ar){var aq=this.document.createElement("caption");aq.innerHTML=k.ie?f.fillChar:"<br/>";ar.insertBefore(aq,ar.firstChild);var ap=this.selection.getRange();ap.setStart(aq,0).setCursor();}}};UE.commands.deletecaption={queryCommandState:function(){var ap=this.selection.getRange(),aq=f.findParentByTagName(ap.startContainer,"table");if(aq){return aq.getElementsByTagName("caption").length==0?-1:1;}return -1;},execCommand:function(){var ap=this.selection.getRange(),ar=f.findParentByTagName(ap.startContainer,"table");if(ar){f.remove(ar.getElementsByTagName("caption")[0]);var aq=this.selection.getRange();aq.setStart(ar.rows[0].cells[0],0).setCursor();}}};UE.commands.inserttitle={queryCommandState:function(){var ap=Y(this).table;if(ap){var aq=ap.rows[0];return aq.getElementsByTagName("th").length==0?0:-1;}return -1;},execCommand:function(){var aq=Y(this).table;if(aq){T(aq).insertRow(0,"th");}var ap=aq.getElementsByTagName("th")[0];this.selection.getRange().setStart(ap,0).setCursor(false,true);}};UE.commands.deletetitle={queryCommandState:function(){var ap=Y(this).table;if(ap){var aq=ap.rows[0];return aq.getElementsByTagName("th").length?0:-1;}return -1;},execCommand:function(){var ap=Y(this).table;if(ap){f.remove(ap.rows[0]);}var aq=ap.getElementsByTagName("td")[0];this.selection.getRange().setStart(aq,0).setCursor(false,true);}};UE.commands.mergeright={queryCommandState:function(au){var av=Y(this);if(!av.cell){return -1;}var at=T(av.table);if(at.selectedTds.length){return -1;}var ar=at.getCellInfo(av.cell),aq=ar.colIndex+ar.colSpan;if(aq>=at.colsNum){return -1;}var ap=at.indexTable[ar.rowIndex][aq];return(ap.rowIndex==ar.rowIndex&&ap.rowSpan==ar.rowSpan)?0:-1;},execCommand:function(au){var ar=this.selection.getRange(),aq=ar.createBookmark(true);var ap=Y(this).cell,at=T(ap);at.mergeRight(ap);ar.moveToBookmark(aq).select();}};UE.commands.mergedown={queryCommandState:function(au){var av=Y(this),ap=av.cell;if(!ap||ap.tagName=="TH"){return -1;}var at=T(av.table);if(at.selectedTds.length){return -1;}var aq=at.getCellInfo(av.cell),aw=aq.rowIndex+aq.rowSpan;if(aw>=at.rowsNum){return -1;}var ar=at.indexTable[aw][aq.colIndex];return(ar.colIndex==aq.colIndex&&ar.colSpan==aq.colSpan)&&av.cell.tagName!=="TH"?0:-1;},execCommand:function(){var ar=this.selection.getRange(),aq=ar.createBookmark(true);var ap=Y(this).cell,at=T(ap);at.mergeDown(ap);ar.moveToBookmark(aq).select();}};UE.commands.mergecells={queryCommandState:function(){return N(this)?0:-1;},execCommand:function(){var ar=N(this);if(ar&&ar.selectedTds.length){var ap=ar.selectedTds[0];N(this).mergeRange();var aq=this.selection.getRange();if(f.isEmptyBlock(ap)){aq.setStart(ap,0).collapse(true);}else{aq.selectNodeContents(ap);}aq.select();}}};UE.commands.insertrow={queryCommandState:function(){var aq=Y(this),ap=aq.cell;return ap&&ap.tagName=="TD"&&T(aq.table).rowsNum<this.options.maxRowNum?0:-1;},execCommand:function(){var at=this.selection.getRange(),ar=at.createBookmark(true);var aq=Y(this).cell,ax=T(aq),av=ax.getCellInfo(aq);if(!ax.selectedTds.length){ax.insertRow(av.rowIndex,aq);}else{var au=ax.cellsRange;for(var aw=0,ap=au.endRowIndex-au.beginRowIndex+1;aw<ap;aw++){ax.insertRow(au.beginRowIndex,aq);}}at.moveToBookmark(ar).select();}};UE.commands.insertrownext={queryCommandState:function(){var aq=Y(this),ap=aq.cell;return ap&&(ap.tagName=="TD")&&T(aq.table).rowsNum<this.options.maxRowNum?0:-1;},execCommand:function(){var at=this.selection.getRange(),ar=at.createBookmark(true);var aq=Y(this).cell,ax=T(aq),av=ax.getCellInfo(aq);if(!ax.selectedTds.length){ax.insertRow(av.rowIndex+av.rowSpan,aq);}else{var au=ax.cellsRange;for(var aw=0,ap=au.endRowIndex-au.beginRowIndex+1;aw<ap;aw++){ax.insertRow(au.endRowIndex+1,aq);}}at.moveToBookmark(ar).select();}};UE.commands.deleterow={queryCommandState:function(){var ap=Y(this);if(!ap.cell){return -1;}},execCommand:function(){var ay=Y(this).cell,at=T(ay),ap=at.cellsRange,au=at.getCellInfo(ay),ar=at.getVSideCell(ay),aA=at.getVSideCell(ay,true),aq=this.selection.getRange();if(p.isEmptyObject(ap)){at.deleteRow(au.rowIndex);}else{for(var ax=ap.beginRowIndex;ax<ap.endRowIndex+1;ax++){at.deleteRow(ap.beginRowIndex);}}var az=at.table;if(!az.getElementsByTagName("td").length){var av=az.nextSibling;f.remove(az);if(av){aq.setStart(av,0).setCursor(false,true);}}else{if(au.rowSpan==1||au.rowSpan==ap.endRowIndex-ap.beginRowIndex+1){if(aA||ar){aq.selectNodeContents(aA||ar).setCursor(false,true);}}else{var aw=at.getCell(au.rowIndex,at.indexTable[au.rowIndex][au.colIndex].cellIndex);if(aw){aq.selectNodeContents(aw).setCursor(false,true);}}}}};UE.commands.insertcol={queryCommandState:function(aq){var ar=Y(this),ap=ar.cell;return ap&&(ap.tagName=="TD"||ap.tagName=="TH")&&T(ar.table).colsNum<this.options.maxColNum?0:-1;},execCommand:function(aq){var ap=this.selection.getRange(),at=ap.createBookmark(true);if(this.queryCommandState(aq)==-1){return;}var ay=Y(this).cell,ar=T(ay),au=ar.getCellInfo(ay);if(!ar.selectedTds.length){ar.insertCol(au.colIndex,ay);}else{var aw=ar.cellsRange;for(var av=0,ax=aw.endColIndex-aw.beginColIndex+1;av<ax;av++){ar.insertCol(aw.beginColIndex,ay);}}ap.moveToBookmark(at).select(true);}};UE.commands.insertcolnext={queryCommandState:function(){var aq=Y(this),ap=aq.cell;return ap&&T(aq.table).colsNum<this.options.maxColNum?0:-1;},execCommand:function(){var at=this.selection.getRange(),ar=at.createBookmark(true);var aq=Y(this).cell,ax=T(aq),av=ax.getCellInfo(aq);if(!ax.selectedTds.length){ax.insertCol(av.colIndex+av.colSpan,aq);}else{var au=ax.cellsRange;for(var aw=0,ap=au.endColIndex-au.beginColIndex+1;aw<ap;aw++){ax.insertCol(au.endColIndex+1,aq);}}at.moveToBookmark(ar).select();}};UE.commands.deletecol={queryCommandState:function(){var ap=Y(this);if(!ap.cell){return -1;}},execCommand:function(){var ax=Y(this).cell,ar=T(ax),aw=ar.cellsRange,at=ar.getCellInfo(ax),aq=ar.getHSideCell(ax),az=ar.getHSideCell(ax,true);if(p.isEmptyObject(aw)){ar.deleteCol(at.colIndex);}else{for(var av=aw.beginColIndex;av<aw.endColIndex+1;av++){ar.deleteCol(aw.beginColIndex);}}var ay=ar.table,ap=this.selection.getRange();if(!ay.getElementsByTagName("td").length){var au=ay.nextSibling;f.remove(ay);if(au){ap.setStart(au,0).setCursor(false,true);}}else{if(f.inDoc(ax,this.document)){ap.setStart(ax,0).setCursor(false,true);}else{if(az&&f.inDoc(az,this.document)){ap.selectNodeContents(az).setCursor(false,true);}else{if(aq&&f.inDoc(aq,this.document)){ap.selectNodeContents(aq).setCursor(true,true);}}}}}};UE.commands.splittocells={queryCommandState:function(){var ar=Y(this),ap=ar.cell;if(!ap){return -1;}var aq=T(ar.table);if(aq.selectedTds.length>0){return -1;}return ap&&(ap.colSpan>1||ap.rowSpan>1)?0:-1;},execCommand:function(){var ar=this.selection.getRange(),aq=ar.createBookmark(true);var ap=Y(this).cell,at=T(ap);at.splitToCells(ap);ar.moveToBookmark(aq).select();}};UE.commands.splittorows={queryCommandState:function(){var ar=Y(this),ap=ar.cell;if(!ap){return -1;}var aq=T(ar.table);if(aq.selectedTds.length>0){return -1;}return ap&&ap.rowSpan>1?0:-1;},execCommand:function(){var ar=this.selection.getRange(),aq=ar.createBookmark(true);var ap=Y(this).cell,at=T(ap);at.splitToRows(ap);ar.moveToBookmark(aq).select();}};UE.commands.splittocols={queryCommandState:function(){var ar=Y(this),ap=ar.cell;if(!ap){return -1;}var aq=T(ar.table);if(aq.selectedTds.length>0){return -1;}return ap&&ap.colSpan>1?0:-1;},execCommand:function(){var ar=this.selection.getRange(),aq=ar.createBookmark(true);var ap=Y(this).cell,at=T(ap);at.splitToCols(ap);ar.moveToBookmark(aq).select();}};function w(ar,at){var ax={thin:"0px",medium:"1px",thick:"2px"},aq,av,au,ap;if(!at){at=ar.document.createElement("table");at.insertRow(0).insertCell(0).innerHTML="xxx";ar.body.appendChild(at);var aw=at.getElementsByTagName("td")[0];ap=f.getComputedStyle(at,"border-left-width");aq=parseInt(ax[ap]||ap,10);ap=f.getComputedStyle(aw,"padding-left");av=parseInt(ax[ap]||ap,10);ap=f.getComputedStyle(aw,"border-left-width");au=parseInt(ax[ap]||ap,10);f.remove(at);return{tableBorder:aq,tdPadding:av,tdBorder:au};}else{aw=at.getElementsByTagName("td")[0];ap=f.getComputedStyle(at,"border-left-width");aq=parseInt(ax[ap]||ap,10);ap=f.getComputedStyle(aw,"padding-left");av=parseInt(ax[ap]||ap,10);ap=f.getComputedStyle(aw,"border-left-width");au=parseInt(ax[ap]||ap,10);return{tableBorder:aq,tdPadding:av,tdBorder:au};}}UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return Y(this).table?0:-1;},execCommand:function(av){var aw=Y(this),au=aw.table;if(au){var at=au.getElementsByTagName("td");p.each(at,function(ax){ax.removeAttribute("width");});if(av=="adaptbywindow"){au.setAttribute("width",ai(this,ae,w(this,au)));p.each(at,function(ax){ax.setAttribute("width",ax.offsetWidth+"");});}else{au.style.width="";au.removeAttribute("width");var aq=w(O,au);var ar=au.offsetWidth,ap=O.body.offsetWidth;if(ar>ap){au.setAttribute("width",ai(O,ae,aq));}}}}};UE.commands.averagedistributecol={queryCommandState:function(){var ap=N(this);if(!ap){return -1;}return ap.isFullRow()||ap.isFullCol()?0:-1;},execCommand:function(au){var ar=this,at=N(ar);function aq(){var aA=at.table,av,ay=0,aC=0,aD=w(ar,aA);if(at.isFullRow()){ay=aA.offsetWidth;aC=at.colsNum;}else{var aw=at.cellsRange.beginColIndex,az=at.cellsRange.endColIndex,ax;for(var aB=aw;aB<=az;){ax=at.selectedTds[aB];ay+=ax.offsetWidth;aB+=ax.colSpan;aC+=1;}}av=Math.ceil(ay/aC)-aD.tdBorder*2-aD.tdPadding*2;return av;}function ap(aw){p.each(f.getElementsByTagName(at.table,"th"),function(ax){ax.setAttribute("width","");});var av=at.isFullRow()?f.getElementsByTagName(at.table,"td"):at.selectedTds;p.each(av,function(ax){if(ax.colSpan==1){ax.setAttribute("width",aw);}});}if(at&&at.selectedTds.length){ap(aq());}}};UE.commands.averagedistributerow={queryCommandState:function(){var ap=N(this);if(!ap){return -1;}if(ap.selectedTds&&/th/ig.test(ap.selectedTds[0].tagName)){return -1;}return ap.isFullRow()||ap.isFullCol()?0:-1;},execCommand:function(at){var aq=this,ar=N(aq);function ap(){var av,aG,aJ=0,aB=ar.table,aI=w(aq,aB),aw=parseInt(f.getComputedStyle(aB.getElementsByTagName("td")[0],"padding-top"));if(ar.isFullCol()){var aH=f.getElementsByTagName(aB,"caption"),ay=f.getElementsByTagName(aB,"th"),aA,aF;if(aH.length>0){aA=aH[0].offsetHeight;}if(ay.length>0){aF=ay[0].offsetHeight;}aJ=aB.offsetHeight-(aA||0)-(aF||0);aG=ay.length==0?ar.rowsNum:(ar.rowsNum-1);}else{var ax=ar.cellsRange.beginRowIndex,az=ar.cellsRange.endRowIndex,aE=0,aD=f.getElementsByTagName(aB,"tr");for(var aC=ax;aC<=az;aC++){aJ+=aD[aC].offsetHeight;aE+=1;}aG=aE;}if(k.ie&&k.version<9){av=Math.ceil(aJ/aG);}else{av=Math.ceil(aJ/aG)-aI.tdBorder*2-aw*2;}return av;}function au(aw){var av=ar.isFullCol()?f.getElementsByTagName(ar.table,"td"):ar.selectedTds;p.each(av,function(ax){if(ax.rowSpan==1){ax.setAttribute("height",aw);}});}if(ar&&ar.selectedTds.length){au(ap());}}};UE.commands.cellalignment={queryCommandState:function(){return Y(this).table?0:-1;},execCommand:function(au,at){var aq=this,ar=N(aq);if(!ar){var av=aq.selection.getStart(),ap=av&&f.findParentByTagName(av,["td","th","caption"],true);if(!/caption/ig.test(ap.tagName)){f.setAttributes(ap,at);}else{ap.style.textAlign=at.align;ap.style.verticalAlign=at.vAlign;}aq.selection.getRange().setCursor(true);}else{p.each(ar.selectedTds,function(aw){f.setAttributes(aw,at);});}}};UE.commands.tablealignment={queryCommandState:function(){return Y(this).table?0:-1;},execCommand:function(at,ar){var aq=this,av=aq.selection.getStart(),ap=av&&f.findParentByTagName(av,["table"],true);if(ap){var au={};au[ar[0]]=ar[1];ap.style[p.cssStyleToDomStyle("float")]="";ap.style.margin="";f.setStyles(ap,au);}}};UE.commands.edittable={queryCommandState:function(){return Y(this).table?0:-1;},execCommand:function(au,ar){var aq=this.selection.getRange(),at=f.findParentByTagName(aq.startContainer,"table");if(at){var ap=f.getElementsByTagName(at,"td").concat(f.getElementsByTagName(at,"th"),f.getElementsByTagName(at,"caption"));p.each(ap,function(av){av.style.borderColor=ar;});}}};UE.commands.edittd={queryCommandState:function(){return Y(this).table?0:-1;},execCommand:function(au,aq){var ar=this,at=N(ar);if(!at){var av=ar.selection.getStart(),ap=av&&f.findParentByTagName(av,["td","th","caption"],true);if(ap){ap.style.backgroundColor=aq;}}else{p.each(at.selectedTds,function(aw){aw.style.backgroundColor=aq;});}}};function r(ap){this.table=ap;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(ap);}r.prototype={getMaxRows:function(){var av=this.table.rows,ap=1;for(var at=0,aw;aw=av[at];at++){var au=1;for(var ar=0,aq;aq=aw.cells[ar++];){au=Math.max(aq.rowSpan||1,au);}ap=Math.max(au+at,ap);}return ap;},getMaxCols:function(){var ay=this.table.rows,ar=0,ap={};for(var av=0,ax;ax=ay[av];av++){var aq=0;for(var au=0,aw;aw=ax.cells[au++];){aq+=(aw.colSpan||1);if(aw.rowSpan&&aw.rowSpan>1){for(var at=1;at<aw.rowSpan;at++){if(!ap["row_"+(av+at)]){ap["row_"+(av+at)]=(aw.colSpan||1);}else{ap["row_"+(av+at)]++;}}}}aq+=ap["row_"+av]||0;ar=Math.max(aq,ar);}return ar;},getCellColIndex:function(ap){},getHSideCell:function(aq,av){try{var au=this.getCellInfo(aq),at,ax;var ap=this.selectedTds.length,ar=this.cellsRange;if((!av&&(!ap?!au.colIndex:!ar.beginColIndex))||(av&&(!ap?(au.colIndex==(this.colsNum-1)):(ar.endColIndex==this.colsNum-1)))){return null;}at=!ap?au.rowIndex:ar.beginRowIndex;ax=!av?(!ap?(au.colIndex<1?0:(au.colIndex-1)):ar.beginColIndex-1):(!ap?au.colIndex+1:ar.endColIndex+1);return this.getCell(this.indexTable[at][ax].rowIndex,this.indexTable[at][ax].cellIndex);}catch(aw){A(aw);}},getTabNextCell:function(ap,aw){var ar=this.getCellInfo(ap),av=aw||ar.rowIndex,aq=ar.colIndex+1+(ar.colSpan-1),at;try{at=this.getCell(this.indexTable[av][aq].rowIndex,this.indexTable[av][aq].cellIndex);}catch(au){try{av=av*1+1;aq=0;at=this.getCell(this.indexTable[av][aq].rowIndex,this.indexTable[av][aq].cellIndex);}catch(au){}}return at;},getVSideCell:function(ay,ap,au){try{var ar=this.getCellInfo(ay),ax,aq;var av=this.selectedTds.length&&!au,at=this.cellsRange;if((!ap&&(ar.rowIndex==0))||(ap&&(!av?(ar.rowIndex+ar.rowSpan>this.rowsNum-1):(at.endRowIndex==this.rowsNum-1)))){return null;}ax=!ap?(!av?ar.rowIndex-1:at.beginRowIndex-1):(!av?(ar.rowIndex+ar.rowSpan):at.endRowIndex+1);aq=!av?ar.colIndex:at.beginColIndex;return this.getCell(this.indexTable[ax][aq].rowIndex,this.indexTable[ax][aq].cellIndex);}catch(aw){A(aw);}},getSameEndPosCells:function(az,aq){try{var aw=(aq.toLowerCase()==="x"),ar=f.getXY(az)[aw?"x":"y"]+az["offset"+(aw?"Width":"Height")],aB=this.table.rows,aA=null,ax=[];for(var au=0;au<this.rowsNum;au++){aA=aB[au].cells;for(var at=0,ay;ay=aA[at++];){var ap=f.getXY(ay)[aw?"x":"y"]+ay["offset"+(aw?"Width":"Height")];if(ap>ar&&aw){break;}if(az==ay||ar==ap){if(ay[aw?"colSpan":"rowSpan"]==1){ax.push(ay);}if(aw){break;}}}}return ax;}catch(av){A(av);}},setCellContent:function(ap,aq){ap.innerHTML=aq||(k.ie?f.fillChar:"<br />");},cloneCell:S,getSameStartPosXCells:function(ax){try{var ap=f.getXY(ax).x+ax.offsetWidth,az=this.table.rows,ay,av=[];for(var ar=0;ar<this.rowsNum;ar++){ay=az[ar].cells;for(var aq=0,aw;aw=ay[aq++];){var at=f.getXY(aw).x;if(at>ap){break;}if(at==ap&&aw.colSpan==1){av.push(aw);break;}}}return av;}catch(au){A(au);}},update:function(aK){this.table=aK||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];var aA=this.table.rows,aL=aA.length,ar=this.getMaxCols();this.rowsNum=aL;this.colsNum=ar;for(var aH=0,aJ=aA.length;aH<aJ;aH++){this.indexTable[aH]=new Array(ar);}for(var aB=0,ax;ax=aA[aB];aB++){for(var az=0,ap,au=ax.cells;ap=au[az];az++){if(ap.rowSpan>aL){ap.rowSpan=aL;}var aD=az,av=ap.rowSpan||1,ay=ap.colSpan||1;while(this.indexTable[aB][aD]){aD++;}for(var aG=0;aG<av;aG++){for(var aE=0;aE<ay;aE++){this.indexTable[aB+aG][aD+aE]={rowIndex:aB,cellIndex:az,colIndex:aD,rowSpan:av,colSpan:ay};}}}}for(aG=0;aG<aL;aG++){for(aE=0;aE<ar;aE++){if(this.indexTable[aG][aE]===undefined){ax=aA[aG];ap=ax.cells[ax.cells.length-1];ap=ap?ap.cloneNode(true):this.table.ownerDocument.createElement("td");this.setCellContent(ap);if(ap.colSpan!==1){ap.colSpan=1;}if(ap.rowSpan!==1){ap.rowSpan=1;}ax.appendChild(ap);this.indexTable[aG][aE]={rowIndex:aG,cellIndex:ap.cellIndex,colIndex:aE,rowSpan:1,colSpan:1};}}}var aI=f.getElementsByTagName(this.table,"td"),aC=[];p.each(aI,function(aM){if(f.hasClass(aM,"selectTdClass")){aC.push(aM);}});if(aC.length){var aw=aC[0],at=aC[aC.length-1],aq=this.getCellInfo(aw),aF=this.getCellInfo(at);this.selectedTds=aC;this.cellsRange={beginRowIndex:aq.rowIndex,beginColIndex:aq.colIndex,endRowIndex:aF.rowIndex+aF.rowSpan-1,endColIndex:aF.colIndex+aF.colSpan-1};}},getCellInfo:function(ap){if(!ap){return;}var at=ap.cellIndex,aw=ap.parentNode.rowIndex,au=this.indexTable[aw],av=this.colsNum;for(var ar=at;ar<av;ar++){var aq=au[ar];if(aq.rowIndex===aw&&aq.cellIndex===at){return aq;}}},getCell:function(aq,ap){return aq<this.rowsNum&&this.table.rows[aq].cells[ap]||null;},deleteCell:function(ap,ar){ar=typeof ar=="number"?ar:ap.parentNode.rowIndex;var aq=this.table.rows[ar];aq.deleteCell(ap.cellIndex);},getCellsRange:function(aq,ap){function au(aL,aD,aE,aG){var aF=aL,aH=aD,aJ=aE,aB=aG,aC,aK,aI;if(aL>0){for(aK=aD;aK<aG;aK++){aC=az.indexTable[aL][aK];aI=aC.rowIndex;if(aI<aL){aF=Math.min(aI,aF);}}}if(aG<az.colsNum){for(aI=aL;aI<aE;aI++){aC=az.indexTable[aI][aG];aK=aC.colIndex+aC.colSpan-1;if(aK>aG){aB=Math.max(aK,aB);}}}if(aE<az.rowsNum){for(aK=aD;aK<aG;aK++){aC=az.indexTable[aE][aK];aI=aC.rowIndex+aC.rowSpan-1;if(aI>aE){aJ=Math.max(aI,aJ);}}}if(aD>0){for(aI=aL;aI<aE;aI++){aC=az.indexTable[aI][aD];aK=aC.colIndex;if(aK<aD){aH=Math.min(aC.colIndex,aH);}}}if(aF!=aL||aH!=aD||aJ!=aE||aB!=aG){return au(aF,aH,aJ,aB);}else{return{beginRowIndex:aL,beginColIndex:aD,endRowIndex:aE,endColIndex:aG};}}try{var az=this,at=az.getCellInfo(aq);if(aq===ap){return{beginRowIndex:at.rowIndex,beginColIndex:at.colIndex,endRowIndex:at.rowIndex+at.rowSpan-1,endColIndex:at.colIndex+at.colSpan-1};}var ar=az.getCellInfo(ap);var aA=Math.min(at.rowIndex,ar.rowIndex),av=Math.min(at.colIndex,ar.colIndex),aw=Math.max(at.rowIndex+at.rowSpan-1,ar.rowIndex+ar.rowSpan-1),ax=Math.max(at.colIndex+at.colSpan-1,ar.colIndex+ar.colSpan-1);return au(aA,av,aw,ax);}catch(ay){if(U){throw ay;}}},getCells:function(av){this.clearSelected();var aC=av.beginRowIndex,aq=av.beginColIndex,au=av.endRowIndex,aw=av.endColIndex,ap,ay,aB,ax={},aA=[];for(var at=aC;at<=au;at++){for(var ar=aq;ar<=aw;ar++){ap=this.indexTable[at][ar];ay=ap.rowIndex;aB=ap.colIndex;var az=ay+"|"+aB;if(ax[az]){continue;}ax[az]=1;if(ay<at||aB<ar||ay+ap.rowSpan-1>au||aB+ap.colSpan-1>aw){return null;}aA.push(this.getCell(ay,ap.cellIndex));}}return aA;},clearSelected:function(){L(this.selectedTds);this.selectedTds=[];this.cellsRange={};},setSelected:function(ap){var aq=this.getCells(ap);F(aq);this.selectedTds=aq;this.cellsRange=ap;},isFullRow:function(){var ap=this.cellsRange;return(ap.endColIndex-ap.beginColIndex+1)==this.colsNum;},isFullCol:function(){var aq=this.cellsRange,ar=this.table,ap=ar.getElementsByTagName("th"),at=aq.endRowIndex-aq.beginRowIndex+1;return !ap.length?at==this.rowsNum:at==this.rowsNum||(at==this.rowsNum-1);},getNextCell:function(ay,ap,au){try{var ar=this.getCellInfo(ay),ax,aq;var av=this.selectedTds.length&&!au,at=this.cellsRange;if((!ap&&(ar.rowIndex==0))||(ap&&(!av?(ar.rowIndex+ar.rowSpan>this.rowsNum-1):(at.endRowIndex==this.rowsNum-1)))){return null;}ax=!ap?(!av?ar.rowIndex-1:at.beginRowIndex-1):(!av?(ar.rowIndex+ar.rowSpan):at.endRowIndex+1);aq=!av?ar.colIndex:at.beginColIndex;return this.getCell(this.indexTable[ax][aq].rowIndex,this.indexTable[ax][aq].cellIndex);}catch(aw){A(aw);}},getPreviewCell:function(aq,ax){try{var au=this.getCellInfo(aq),at,aw;var ap=this.selectedTds.length,ar=this.cellsRange;if((!ax&&(!ap?!au.colIndex:!ar.beginColIndex))||(ax&&(!ap?(au.rowIndex>(this.colsNum-1)):(ar.endColIndex==this.colsNum-1)))){return null;}at=!ax?(!ap?au.rowIndex:ar.beginRowIndex):(!ap?(au.rowIndex<1?0:(au.rowIndex-1)):ar.beginRowIndex);aw=!ax?(!ap?(au.colIndex<1?0:(au.colIndex-1)):ar.beginColIndex-1):(!ap?au.colIndex:ar.endColIndex+1);return this.getCell(this.indexTable[at][aw].rowIndex,this.indexTable[at][aw].cellIndex);}catch(av){A(av);}},moveContent:function(aq,ap){if(v(ap)){return;}if(v(aq)){aq.innerHTML=ap.innerHTML;return;}var ar=aq.lastChild;if(ar.nodeType==3||!a.$block[ar.tagName]){aq.appendChild(aq.ownerDocument.createElement("br"));}while(ar=ap.firstChild){aq.appendChild(ar);}},mergeRight:function(ap){var at=this.getCellInfo(ap),ar=at.colIndex+at.colSpan,aq=this.indexTable[at.rowIndex][ar],au=this.getCell(aq.rowIndex,aq.cellIndex);ap.colSpan=at.colSpan+aq.colSpan;ap.removeAttribute("width");this.moveContent(ap,au);this.deleteCell(au,aq.rowIndex);this.update();},mergeDown:function(ap){var ar=this.getCellInfo(ap),au=ar.rowIndex+ar.rowSpan,at=this.indexTable[au][ar.colIndex],aq=this.getCell(at.rowIndex,at.cellIndex);ap.rowSpan=ar.rowSpan+at.rowSpan;ap.removeAttribute("height");this.moveContent(ap,aq);this.deleteCell(aq,at.rowIndex);this.update();},mergeRange:function(){var ar=this.cellsRange,at=this.getCell(ar.beginRowIndex,this.indexTable[ar.beginRowIndex][ar.beginColIndex].cellIndex);if(at.tagName=="TH"&&ar.endRowIndex!==ar.beginRowIndex){var au=this.indexTable,ap=this.getCellInfo(at);at=this.getCell(1,au[1][ap.colIndex].cellIndex);ar=this.getCellsRange(at,this.getCell(au[this.rowsNum-1][ap.colIndex].rowIndex,au[this.rowsNum-1][ap.colIndex].cellIndex));}var ay=this.getCells(ar),av=ay.length,ax;while(av--){ax=ay[av];if(ax!==at){this.moveContent(at,ax);this.deleteCell(ax);}}at.rowSpan=ar.endRowIndex-ar.beginRowIndex+1;at.rowSpan>1&&at.removeAttribute("height");at.colSpan=ar.endColIndex-ar.beginColIndex+1;at.colSpan>1&&at.removeAttribute("width");if(at.rowSpan==this.rowsNum&&at.colSpan!=1){at.colSpan=1;}if(at.colSpan==this.colsNum&&at.rowSpan!=1){var aw=at.parentNode.rowIndex;for(var aq=0;aq<at.rowSpan-1;aq++){var az=this.table.rows[aw+1];az.parentNode.removeChild(az);}at.rowSpan=1;}this.update();},insertRow:function(au,ay){var ar=this.colsNum,az=this.table,aA=az.insertRow(au),ax,ap=parseInt((az.offsetWidth-ar*20-ar-1)/ar,10);if(au==0||au==this.rowsNum){for(var aw=0;aw<ar;aw++){ax=this.cloneCell(ay,true);this.setCellContent(ax);ax.getAttribute("vAlign")&&ax.setAttribute("vAlign",ax.getAttribute("vAlign"));aA.appendChild(ax);}}else{var av=this.indexTable[au],at=0;for(aw=0;aw<ar;aw++){var aq=av[aw];if(aq.rowIndex<au){ax=this.getCell(aq.rowIndex,aq.cellIndex);ax.rowSpan=aq.rowSpan+1;}else{ax=this.cloneCell(ay,true);this.setCellContent(ax);aA.appendChild(ax);}}}this.update();return aA;},deleteRow:function(aD){var az=this.table.rows[aD],aA=this.indexTable[aD],av=this.colsNum,aB=0;for(var aE=0;aE<av;){var aC=aA[aE],aq=this.getCell(aC.rowIndex,aC.cellIndex);if(aq.rowSpan>1){if(aC.rowIndex==aD){var aG=aq.cloneNode(true);aG.rowSpan=aq.rowSpan-1;aG.innerHTML="";aq.rowSpan=1;var ax=aD+1,aF=this.table.rows[ax],aH,ar=this.getPreviewMergedCellsNum(ax,aE)-aB;if(ar<aE){aH=aE-ar-1;f.insertAfter(aF.cells[aH],aG);}else{if(aF.cells.length){aF.insertBefore(aG,aF.cells[0]);}}aB+=1;}}aE+=aq.colSpan||1;}var at=[],ay={};for(aE=0;aE<av;aE++){var aw=aA[aE].rowIndex,au=aA[aE].cellIndex,aI=aw+"_"+au;if(ay[aI]){continue;}ay[aI]=1;aq=this.getCell(aw,au);at.push(aq);}var ap=[];p.each(at,function(aJ){if(aJ.rowSpan==1){aJ.parentNode.removeChild(aJ);}else{ap.push(aJ);}});p.each(ap,function(aJ){aJ.rowSpan--;});az.parentNode.removeChild(az);this.update();},insertCol:function(ay,aA,aw){var ap=this.rowsNum,ax=0,ar,az,au=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10);function av(aE,aC,aB){if(aE==0){var aD=aC.nextSibling||aC.previousSibling;if(aD.tagName=="TH"){aD=aC.ownerDocument.createElement("th");aD.appendChild(aC.firstChild);aB.insertBefore(aD,aC);f.remove(aC);}}}var aq;if(ay==0||ay==this.colsNum){for(;ax<ap;ax++){ar=this.table.rows[ax];aq=ar.cells[ay==0?ay:ar.cells.length];az=this.cloneCell(aA,true);this.setCellContent(az);az.setAttribute("vAlign",az.getAttribute("vAlign"));aq&&az.setAttribute("width",aq.getAttribute("width"));if(!ay){ar.insertBefore(az,ar.cells[0]);}else{f.insertAfter(ar.cells[ar.cells.length-1],az);}av(ax,az,ar);}}else{for(;ax<ap;ax++){var at=this.indexTable[ax][ay];if(at.colIndex<ay){az=this.getCell(at.rowIndex,at.cellIndex);az.colSpan=at.colSpan+1;}else{ar=this.table.rows[ax];aq=ar.cells[at.cellIndex];az=this.cloneCell(aA,true);this.setCellContent(az);az.setAttribute("vAlign",az.getAttribute("vAlign"));aq&&az.setAttribute("width",aq.getAttribute("width"));ar.insertBefore(az,aq);}av(ax,az,ar);}}this.update();this.updateWidth(au,aw||{tdPadding:10,tdBorder:1});},updateWidth:function(at,aq){var au=this.table,ap=am(au)-aq.tdPadding*2-aq.tdBorder+at;if(ap<au.ownerDocument.body.offsetWidth){au.setAttribute("width",ap);return;}var ar=f.getElementsByTagName(this.table,"td");p.each(ar,function(av){av.setAttribute("width",at);});},deleteCol:function(az){var aq=this.indexTable,av=this.table.rows,at=this.table.getAttribute("width"),aB=0,ap=this.rowsNum,aA={};for(var au=0;au<ap;){var aw=aq[au],ar=aw[az],ay=ar.rowIndex+"_"+ar.colIndex;if(aA[ay]){continue;}aA[ay]=1;var ax=this.getCell(ar.rowIndex,ar.cellIndex);if(!aB){aB=ax&&parseInt(ax.offsetWidth/ax.colSpan,10).toFixed(0);}if(ax.colSpan>1){ax.colSpan--;}else{av[au].deleteCell(ar.cellIndex);}au+=ar.rowSpan||1;}this.table.setAttribute("width",at-aB);this.update();},splitToCells:function(ap){var ar=this,aq=this.splitToRows(ap);p.each(aq,function(at){ar.splitToCols(at);});},splitToRows:function(ay){var aq=this.getCellInfo(ay),av=aq.rowIndex,ax=aq.colIndex,at=[];ay.rowSpan=1;at.push(ay);for(var au=av,ar=av+aq.rowSpan;au<ar;au++){if(au==av){continue;}var ap=this.table.rows[au],aw=ap.insertCell(ax-this.getPreviewMergedCellsNum(au,ax));aw.colSpan=aq.colSpan;this.setCellContent(aw);aw.setAttribute("vAlign",ay.getAttribute("vAlign"));aw.setAttribute("align",ay.getAttribute("align"));if(ay.style.cssText){aw.style.cssText=ay.style.cssText;}at.push(aw);}this.update();return at;},getPreviewMergedCellsNum:function(aw,ar){var av=this.indexTable[aw],aq=0;for(var at=0;at<ar;){var au=av[at].colSpan,ap=av[at].rowIndex;aq+=(au-(ap==aw?1:0));at+=au;}return aq;},splitToCols:function(aA){var at=(aA.offsetWidth/aA.colSpan-22).toFixed(0),ar=this.getCellInfo(aA),ax=ar.rowIndex,az=ar.colIndex,av=[];aA.colSpan=1;aA.setAttribute("width",at);av.push(aA);for(var au=az,aw=az+ar.colSpan;au<aw;au++){if(au==az){continue;}var aq=this.table.rows[ax],ay=aq.insertCell(this.indexTable[ax][au].cellIndex+1);ay.rowSpan=ar.rowSpan;this.setCellContent(ay);ay.setAttribute("vAlign",aA.getAttribute("vAlign"));ay.setAttribute("align",aA.getAttribute("align"));ay.setAttribute("width",at);if(aA.style.cssText){ay.style.cssText=aA.style.cssText;}if(aA.tagName=="TH"){var ap=aA.ownerDocument.createElement("th");ap.appendChild(ay.firstChild);ap.setAttribute("vAlign",aA.getAttribute("vAlign"));ap.rowSpan=ay.rowSpan;aq.insertBefore(ap,ay);f.remove(ay);}av.push(ay);}this.update();return av;},isLastCell:function(aq,at,ap){at=at||this.rowsNum;ap=ap||this.colsNum;var ar=this.getCellInfo(aq);return((ar.rowIndex+ar.rowSpan)==at)&&((ar.colIndex+ar.colSpan)==ap);},getLastCell:function(ap){ap=ap||this.table.getElementsByTagName("td");var ax=this.getCellInfo(ap[0]);var at=this,ar=ap[0],av=ar.parentNode,aq=0,aw=0,au;p.each(ap,function(ay){if(ay.parentNode==av){aw+=ay.colSpan||1;}aq+=ay.rowSpan*ay.colSpan||1;});au=aq/aw;p.each(ap,function(ay){if(at.isLastCell(ay,au,aw)){ar=ay;return false;}});return ar;},selectRow:function(au){var ar=this.indexTable[au],at=this.getCell(ar[0].rowIndex,ar[0].cellIndex),ap=this.getCell(ar[this.colsNum-1].rowIndex,ar[this.colsNum-1].cellIndex),aq=this.getCellsRange(at,ap);this.setSelected(aq);},selectTable:function(){var aq=this.table.getElementsByTagName("td"),ap=this.getCellsRange(aq[0],aq[aq.length-1]);this.setSelected(ap);}};function B(ap){var aq=Y(ap).cell||N(ap);return aq?(aq.nodeType?[aq]:aq.selectedTds):[];}function Y(ar){var av=ar.selection.getStart(),ap=av&&f.findParentByTagName(av,["td","th"],true),au=ap&&ap.parentNode,aq=av&&f.findParentByTagName(av,"caption",true),at=aq?aq.parentNode:au&&au.parentNode.parentNode;return{cell:ap,tr:au,table:at,caption:aq};}function Q(aq,ap){var ar=f.findParentByTagName(ap.target||ap.srcElement,["td","th"],true);return ar&&!(aq.fireEvent("excludetable",ar)===true)?ar:null;}function S(ap,ar){if(!ap||p.isString(ap)){return this.table.ownerDocument.createElement(ap||"td");}var aq=f.hasClass(ap,"selectTdClass");aq&&f.removeClasses(ap,"selectTdClass");var at=ap.cloneNode(true);if(ar){at.rowSpan=at.colSpan=1;}at.style.borderLeftStyle="";at.style.borderTopStyle="";at.style.borderLeftColor=ap.style.borderRightColor;at.style.borderLeftWidth=ap.style.borderRightWidth;at.style.borderTopColor=ap.style.borderBottomColor;at.style.borderTopWidth=ap.style.borderBottomWidth;aq&&f.addClass(ap,"selectTdClass");return at;}};UE.plugins.basestyle=function(){var u={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},t=function(w,v){return f.filterNodeList(w.selection.getStartElementPath(),v);},s=this;s.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});for(var r in u){(function(w,v){s.commands[w]={execCommand:function(y){var x=s.selection.getRange(),B=t(this,v);if(x.collapsed){if(B){var A=s.document.createTextNode("");x.insertNode(A).removeInlineStyle(v);x.setStartBefore(A);f.remove(A);}else{var z=x.document.createElement(v[0]);if(y=="superscript"||y=="subscript"){A=s.document.createTextNode("");x.insertNode(A).removeInlineStyle(["sub","sup"]).setStartBefore(A).collapse(true);}x.insertNode(z).setStart(z,0);}x.collapse(true);}else{if(y=="superscript"||y=="subscript"){if(!B||B.tagName.toLowerCase()!=y){x.removeInlineStyle(["sub","sup"]);}}B?x.removeInlineStyle(v):x.applyInlineStyle(v[0]);}x.select();},queryCommandState:function(){return t(this,v)?1:0;}};})(r,u[r]);}};UE.plugins.elementpath=function(){var t,r,s=this;s.setOpt("elementPathEnabled",true);if(!s.options.elementPathEnabled){return;}s.commands.elementpath={execCommand:function(v,x){var w=r[x],u=s.selection.getRange();t=x*1;u.selectNode(w).select();},queryCommandValue:function(){var v=[].concat(this.selection.getStartElementPath()).reverse(),y=[];r=v;for(var x=0,w;w=v[x];x++){if(w.nodeType==3){continue;}var u=w.tagName.toLowerCase();if(u=="img"&&w.getAttribute("anchorname")){u="anchor";}y[x]=u;if(t==x){t=-1;break;}}return y;}};};UE.plugins.formatmatch=function(){var t=this,u=[],s,r=0;t.addListener("reset",function(){u=[];r=0;});function v(B,D){if(k.webkit){var A=D.target.tagName=="IMG"?D.target:null;}function w(F){if(E){F.selectNode(E);}return F.applyInlineStyle(u[u.length-1].tagName,null,u);}t.undoManger&&t.undoManger.save();var z=t.selection.getRange(),C=A||z.getClosedNode();if(s&&C&&C.tagName=="IMG"){C.style.cssText+=";float:"+(s.style.cssFloat||s.style.styleFloat||"none")+";display:"+(s.style.display||"inline");s=null;}else{if(!s){var y=z.collapsed;if(y){var E=t.document.createTextNode("match");z.insertNode(E).select();}t.__hasEnterExecCommand=true;var x=t.options.removeFormatAttributes;t.options.removeFormatAttributes="";t.execCommand("removeformat");t.options.removeFormatAttributes=x;t.__hasEnterExecCommand=false;z=t.selection.getRange();if(u.length){w(z);}if(E){z.setStartBefore(E).collapse(true);}z.select();E&&f.remove(E);}}t.undoManger&&t.undoManger.save();t.removeListener("mouseup",v);r=0;}t.commands.formatmatch={execCommand:function(x){if(r){r=0;u=[];t.removeListener("mouseup",v);return;}var w=t.selection.getRange();s=w.getClosedNode();if(!s||s.tagName!="IMG"){w.collapse(true).shrinkBoundary();var A=w.startContainer;u=f.findParents(A,true,function(B){return !f.isBlockElm(B)&&B.nodeType==1;});for(var z=0,y;y=u[z];z++){if(y.tagName=="A"){u.splice(z,1);break;}}}t.addListener("mouseup",v);r=1;},queryCommandState:function(){return r;},notNeedUndo:1};};UE.plugins.searchreplace=function(){var r,t,s=this;s.addListener("reset",function(){r=null;t=null;});s.commands.searchreplace={execCommand:function(F,u){var A=this,v=A.selection,y,z,x=0,u=p.extend(u,{all:false,casesensitive:false,dir:1},true);if(k.ie){while(1){var C;z=A.document.selection.createRange();C=z.duplicate();C.moveToElementText(A.document.body);if(u.all){t=0;u.dir=1;if(r){C.setEndPoint(u.dir==-1?"EndToStart":"StartToEnd",r);}C.moveToElementText(A.document.body);}else{C.setEndPoint(u.dir==-1?"EndToStart":"StartToEnd",z);if(u.hasOwnProperty("replaceStr")){C.setEndPoint(u.dir==-1?"StartToEnd":"EndToStart",z);}}z=C.duplicate();if(!C.findText(u.searchStr,u.dir,u.casesensitive?4:0)){r=null;C=A.document.selection.createRange();C.scrollIntoView();return x;}C.select();if(u.hasOwnProperty("replaceStr")){y=v.getRange();y.deleteContents().insertNode(y.document.createTextNode(u.replaceStr)).select();r=v.getNative().createRange();}x++;if(!u.all){break;}}}else{var B=A.window,E=v.getNative(),C;while(1){if(u.all){if(r){r.collapse(false);z=r;}else{z=A.document.createRange();}z.setStart(A.document.body,0);z.collapse(true);E.removeAllRanges();E.addRange(z);t=0;u.dir=1;}else{if(k.safari){A.selection.getRange().select();}z=B.getSelection().getRangeAt(0);if(u.hasOwnProperty("replaceStr")){z.collapse(u.dir==1?true:false);}}if(!t){z.collapse(u.dir<0?true:false);E.removeAllRanges();E.addRange(z);}else{E.removeAllRanges();}if(!B.find(u.searchStr,u.casesensitive,u.dir<0?true:false)){r=null;E.removeAllRanges();return x;}t=0;y=B.getSelection().getRangeAt(0);if(!y.collapsed){if(u.hasOwnProperty("replaceStr")){y.deleteContents();var D=B.document.createTextNode(u.replaceStr);y.insertNode(D);y.selectNode(D);E.addRange(y);r=y.cloneRange();}}x++;if(!u.all){break;}}}return true;}};};UE.commands.insertparagraph={execCommand:function(s,v){var u=this,r=u.selection.getRange(),x=r.startContainer,t;while(x){if(f.isBody(x)){break;}t=x;x=x.parentNode;}if(t){var w=u.document.createElement("p");if(v){t.parentNode.insertBefore(w,t);}else{t.parentNode.insertBefore(w,t.nextSibling);}f.fillNode(u.document,w);r.setStart(w,0).setCursor(false,true);}}};var c=c||{};c.editor=c.editor||{};c.editor.ui={};(function(){var u=c.editor.browser,t=c.editor.dom.domUtils;var x="$EDITORUI";var w=window[x]={};var r="ID"+x;var z=0;var s=c.editor.ui.uiUtils={uid:function(A){return(A?A[r]||(A[r]=++z):++z);},hook:function(A,C){var B;if(A&&A._callbacks){B=A;}else{B=function(){var G;if(A){G=A.apply(this,arguments);}var F=B._callbacks;var D=F.length;while(D--){var E=F[D].apply(this,arguments);if(G===undefined){G=E;}}return G;};B._callbacks=[];}B._callbacks.push(C);return B;},createElementByHtml:function(A){var B=document.createElement("div");B.innerHTML=A;B=B.firstChild;B.parentNode.removeChild(B);return B;},getViewportElement:function(){return(u.ie&&u.quirks)?document.body:document.documentElement;},getClientRect:function(A){var E;try{E=A.getBoundingClientRect();}catch(D){E={left:0,top:0,height:0,width:0};}var B={left:Math.round(E.left),top:Math.round(E.top),height:Math.round(E.bottom-E.top),width:Math.round(E.right-E.left)};var C;while((C=A.ownerDocument)!==document&&(A=t.getWindow(C).frameElement)){E=A.getBoundingClientRect();B.left+=E.left;B.top+=E.top;}B.bottom=B.top+B.height;B.right=B.left+B.width;return B;},getViewportRect:function(){var B=s.getViewportElement();var C=(window.innerWidth||B.clientWidth)|0;var A=(window.innerHeight||B.clientHeight)|0;return{left:0,top:0,height:A,width:C,bottom:A,right:C};},setViewportOffset:function(A,D){var B;var C=s.getFixedLayer();if(A.parentNode===C){A.style.left=D.left+"px";A.style.top=D.top+"px";}else{t.setViewportOffset(A,D);}},getEventOffset:function(A){var B=A.target||A.srcElement;var C=s.getClientRect(B);var D=s.getViewportOffsetByEvent(A);return{left:D.left-C.left,top:D.top-C.top};},getViewportOffsetByEvent:function(B){var C=B.target||B.srcElement;var A=t.getWindow(C).frameElement;var E={left:B.clientX,top:B.clientY};if(A&&C.ownerDocument!==document){var D=s.getClientRect(A);E.left+=D.left;E.top+=D.top;}return E;},setGlobal:function(B,A){w[B]=A;return x+'["'+B+'"]';},unsetGlobal:function(A){delete w[A];},copyAttributes:function(E,D){var B=D.attributes;var A=B.length;while(A--){var C=B[A];if(C.nodeName!="style"&&C.nodeName!="class"&&(!u.ie||C.specified)){E.setAttribute(C.nodeName,C.nodeValue);}}if(D.className){t.addClass(E,D.className);}if(D.style.cssText){E.style.cssText+=";"+D.style.cssText;}},removeStyle:function(B,A){if(B.style.removeProperty){B.style.removeProperty(A);}else{if(B.style.removeAttribute){B.style.removeAttribute(A);}else{throw"";}}},contains:function(B,A){return B&&A&&(B===A?false:(B.contains?B.contains(A):B.compareDocumentPosition(A)&16));},startDrag:function(I,E,G){var G=G||document;var D=I.clientX;var C=I.clientY;function B(K){var J=K.clientX-D;var L=K.clientY-C;E.ondragmove(J,L);if(K.stopPropagation){K.stopPropagation();}else{K.cancelBubble=true;}}if(G.addEventListener){function H(J){G.removeEventListener("mousemove",B,true);G.removeEventListener("mouseup",B,true);window.removeEventListener("mouseup",H,true);E.ondragstop();}G.addEventListener("mousemove",B,true);G.addEventListener("mouseup",H,true);window.addEventListener("mouseup",H,true);I.preventDefault();}else{var F=I.srcElement;F.setCapture();function A(){F.releaseCapture();F.detachEvent("onmousemove",B);F.detachEvent("onmouseup",A);F.detachEvent("onlosecaptrue",A);E.ondragstop();}F.attachEvent("onmousemove",B);F.attachEvent("onmouseup",A);F.attachEvent("onlosecaptrue",A);I.returnValue=false;}E.ondragstart();},getFixedLayer:function(){var A=document.getElementById("edui_fixedlayer");if(A==null){A=document.createElement("div");A.id="edui_fixedlayer";document.body.appendChild(A);if(u.ie&&u.version<=8){A.style.position="absolute";y();setTimeout(v);}else{A.style.position="fixed";}A.style.left="0";A.style.top="0";A.style.width="0";A.style.height="0";}return A;},makeUnselectable:function(B){if(u.opera||(u.ie&&u.version<9)){B.unselectable="on";if(B.hasChildNodes()){for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A].nodeType==1){s.makeUnselectable(B.childNodes[A]);}}}}else{if(B.style.MozUserSelect!==undefined){B.style.MozUserSelect="none";}else{if(B.style.WebkitUserSelect!==undefined){B.style.WebkitUserSelect="none";}else{if(B.style.KhtmlUserSelect!==undefined){B.style.KhtmlUserSelect="none";}}}}}};function v(){var A=document.getElementById("edui_fixedlayer");s.setViewportOffset(A,{left:0,top:0});}function y(A){t.on(window,"scroll",v);t.on(window,"resize",c.editor.utils.defer(v,0,true));}})();(function(){var r=c.editor.utils,s=c.editor.ui.uiUtils,t=c.editor.EventBase,u=c.editor.ui.UIBase=function(){};u.prototype={className:"",uiName:"",initOptions:function(w){var x=this;for(var v in w){x[v]=w[v];}this.id=this.id||"edui"+s.uid();},initUIBase:function(){this._globalKey=r.unhtml(s.setGlobal(this.id,this));},render:function(D){var z=this.renderHtml();var v=s.createElementByHtml(z);var B=f.getElementsByTagName(v,"*");var x="edui-"+(this.theme||this.editor.options.theme);var A=document.getElementById("edui_fixedlayer");for(var y=0,w;w=B[y++];){f.addClass(w,x);}f.addClass(v,x);if(A){A.className="";f.addClass(A,x);}var C=this.getDom();if(C!=null){C.parentNode.replaceChild(v,C);s.copyAttributes(v,C);}else{if(typeof D=="string"){D=document.getElementById(D);}D=D||s.getFixedLayer();f.addClass(D,x);D.appendChild(v);}this.postRender();},getDom:function(v){if(!v){return document.getElementById(this.id);}else{return document.getElementById(this.id+"_"+v);}},postRender:function(){this.fireEvent("postrender");},getHtmlTpl:function(){return"";},formatHtml:function(v){var w="edui-"+this.uiName;return(v.replace(/##/g,this.id).replace(/%%-/g,this.uiName?w+"-":"").replace(/%%/g,(this.uiName?w:"")+" "+this.className).replace(/\$\$/g,this._globalKey));},renderHtml:function(){return this.formatHtml(this.getHtmlTpl());},dispose:function(){var v=this.getDom();if(v){c.editor.dom.domUtils.remove(v);}s.unsetGlobal(this.id);}};r.inherits(u,t);})();(function(){var r=c.editor.utils,s=c.editor.ui.UIBase,t=c.editor.ui.Separator=function(u){this.initOptions(u);this.initSeparator();};t.prototype={uiName:"separator",initSeparator:function(){this.initUIBase();},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>';}};r.inherits(t,s);})();(function(){var s=c.editor.utils,r=c.editor.dom.domUtils,u=c.editor.ui.UIBase,t=c.editor.ui.uiUtils;var v=c.editor.ui.Mask=function(w){this.initOptions(w);this.initUIBase();};v.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onmousedown="return $$._onMouseDown(event, this);"></div>';},postRender:function(){var w=this;r.on(window,"resize",function(){setTimeout(function(){if(!w.isHidden()){w._fill();}});});},show:function(w){this._fill();this.getDom().style.display="";this.getDom().style.zIndex=w;},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex="";},isHidden:function(){return this.getDom().style.display=="none";},_onMouseDown:function(){return false;},_fill:function(){var w=this.getDom();var x=t.getViewportRect();w.style.width=x.width+"px";w.style.height=x.height+"px";}};s.inherits(v,u);})();(function(){var t=c.editor.utils,v=c.editor.ui.uiUtils,r=c.editor.dom.domUtils,y=c.editor.ui.UIBase,x=c.editor.ui.Popup=function(z){this.initOptions(z);this.initPopup();};var s=[];function w(z,C){var D=[];for(var B=0;B<s.length;B++){var A=s[B];if(!A.isHidden()){if(A.queryAutoHide(C)!==false){if(z&&/scroll/ig.test(z.type)&&A.className=="edui-wordpastepop"){return;}A.hide();}}}}x.postHide=w;var u=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];x.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,canSideUp:true,initPopup:function(){this.initUIBase();s.push(this);},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="javascript:"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>";},getContentHtmlTpl:function(){if(this.content){if(typeof this.content=="string"){return this.content;}return this.content.renderHtml();}else{return"";}},_UIBase_postRender:y.prototype.postRender,postRender:function(){if(this.content instanceof y){this.content.postRender();}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender();},_doAutoRender:function(){if(!this.getDom()&&this.autoRender){this.render();}},mesureSize:function(){var z=this.getDom("content");return v.getClientRect(z);},fitSize:function(){var z=this.getDom("body");z.style.width="";z.style.height="";var A=this.mesureSize();z.style.width=A.width+"px";z.style.height=A.height+"px";return A;},showAnchor:function(A,z){this.showAnchorRect(v.getClientRect(A),z);},showAnchorRect:function(G,D,E){this._doAutoRender();var B=v.getViewportRect();this._show();var A=this.fitSize();var H,C,z,F;if(D){H=this.canSideLeft&&(G.right+A.width>B.right&&G.left>A.width);C=this.canSideUp&&(G.top+A.height>B.bottom&&G.bottom>A.height);z=(H?G.left-A.width:G.right);F=(C?G.bottom-A.height:G.top);}else{H=this.canSideLeft&&(G.right+A.width>B.right&&G.left>A.width);C=this.canSideUp&&(G.top+A.height>B.bottom&&G.bottom>A.height);z=(H?G.right-A.width:G.left);F=(C?G.top-A.height:G.bottom);}var I=this.getDom();v.setViewportOffset(I,{left:z,top:F});r.removeClasses(I,u);I.className+=" "+u[(C?1:0)*2+(H?1:0)];if(this.editor){I.style.zIndex=this.editor.container.style.zIndex*1+10;c.editor.ui.uiUtils.getFixedLayer().style.zIndex=I.style.zIndex-1;}},showAt:function(C){var B=C.left;var A=C.top;var z={left:B,top:A,right:B,bottom:A,height:0,width:0};this.showAnchorRect(z,false,true);},_show:function(){if(this._hidden){var z=this.getDom();z.style.display="";this._hidden=false;this.fireEvent("show");}},isHidden:function(){return this._hidden;},show:function(){this._doAutoRender();this._show();},hide:function(z){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;if(!z){this.fireEvent("hide");}}},queryAutoHide:function(z){return !z||!v.contains(this.getDom(),z);}};t.inherits(x,y);r.on(document,"mousedown",function(z){var A=z.target||z.srcElement;w(z,A);});r.on(window,"scroll",function(z,A){w(z,A);});})();(function(){var r=c.editor.utils,t=c.editor.ui.UIBase,s=c.editor.ui.ColorPicker=function(w){this.initOptions(w);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase();};s.prototype={getHtmlTpl:function(){return v(this.noColorText,this.editor);},_onTableClick:function(w){var y=w.target||w.srcElement;var x=y.getAttribute("data-color");if(x){this.fireEvent("pickcolor",x);}},_onTableOver:function(w){var y=w.target||w.srcElement;var x=y.getAttribute("data-color");if(x){this.getDom("preview").style.backgroundColor=x;}},_onTableOut:function(){this.getDom("preview").style.backgroundColor="";},_onPickNoColor:function(){this.fireEvent("picknocolor");}};r.inherits(s,t);var u=("ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,").split(",");function v(w,z){var y='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+w+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+z.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var x=0;x<u.length;x++){if(x&&x%10===0){y+="</tr>"+(x==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+z.getLang("standardColor")+"</td></tr>":"")+"<tr"+(x==60?' class="edui-colorpicker-tablefirstrow"':"")+">";}y+=x<70?'<td style="padding: 0 2px;"><a hidefocus title="'+u[x]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+u[x]+'" style="background-color:#'+u[x]+";border:solid #ccc;"+(x<10||x>=60?"border-width:1px;":x>=10&&x<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':"";}y+="</tr></table></div>";return y;}})();(function(){var r=c.editor.utils,s=c.editor.ui.uiUtils,t=c.editor.ui.UIBase;var u=c.editor.ui.TablePicker=function(v){this.initOptions(v);this.initTablePicker();};u.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase();},getHtmlTpl:function(){var v=this;return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>';},_UIBase_render:t.prototype.render,render:function(v){this._UIBase_render(v);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col");},_track:function(z,y){var w=this.getDom("overlay").style;var x=this.lengthOfCellSide;w.width=z*x+"px";w.height=y*x+"px";var v=this.getDom("label");v.innerHTML=z+this.editor.getLang("t_col")+" x "+y+this.editor.getLang("t_row");this.numCols=z;this.numRows=y;},_onMouseOver:function(w,x){var v=w.relatedTarget||w.fromElement;if(!s.contains(x,v)&&x!==v){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="";}},_onMouseOut:function(w,x){var v=w.relatedTarget||w.toElement;if(!s.contains(x,v)&&x!==v){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden";}},_onMouseMove:function(v,x){var w=this.getDom("overlay").style;var B=s.getEventOffset(v);var z=this.lengthOfCellSide;var A=Math.ceil(B.left/z);var y=Math.ceil(B.top/z);this._track(A,y);},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows);}};r.inherits(u,t);})();(function(){var t=c.editor.browser,r=c.editor.dom.domUtils,s=c.editor.ui.uiUtils;var u='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(t.ie?(' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"'):(' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"'));c.editor.ui.Stateful={alwalysHoverable:false,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl;},Stateful_getHtmlTpl:function(){var v=this._Stateful_dGetHtmlTpl();return v.replace(/stateful/g,function(){return u;});},Stateful_onMouseEnter:function(v,w){this.target=w;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over");}},Stateful_onMouseLeave:function(v,w){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");this.removeState("active");this.fireEvent("out");}},Stateful_onMouseOver:function(w,x){var v=w.relatedTarget;if(!s.contains(x,v)&&x!==v){this.Stateful_onMouseEnter(w,x);}},Stateful_onMouseOut:function(w,x){var v=w.relatedTarget;if(!s.contains(x,v)&&x!==v){this.Stateful_onMouseLeave(w,x);}},Stateful_onMouseDown:function(v,w){if(!this.isDisabled()){this.addState("active");}},Stateful_onMouseUp:function(v,w){if(!this.isDisabled()){this.removeState("active");}},Stateful_postRender:function(){if(this.disabled&&!this.hasState("disabled")){this.addState("disabled");}},hasState:function(v){return r.hasClass(this.getStateDom(),"edui-state-"+v);},addState:function(v){if(!this.hasState(v)){this.getStateDom().className+=" edui-state-"+v;}},removeState:function(v){if(this.hasState(v)){r.removeClasses(this.getStateDom(),["edui-state-"+v]);}},getStateDom:function(){return this.getDom("state");},isChecked:function(){return this.hasState("checked");},setChecked:function(v){if(!this.isDisabled()&&v){this.addState("checked");}else{this.removeState("checked");}},isDisabled:function(){return this.hasState("disabled");},setDisabled:function(v){if(v){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled");}else{this.removeState("disabled");}}};})();(function(){var s=c.editor.utils,u=c.editor.ui.UIBase,t=c.editor.ui.Stateful,r=c.editor.ui.Button=function(v){this.initOptions(v);this.initButton();};r.prototype={uiName:"button",label:"",title:"",showIcon:true,showText:true,initButton:function(){this.initUIBase();this.Stateful_init();},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return false;" onclick="return $$._onClick();">'+(this.showIcon?'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>";},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled);},_onClick:function(){if(!this.isDisabled()){this.fireEvent("click");}}};s.inherits(r,u);s.extend(r.prototype,t);})();(function(){var t=c.editor.utils,v=c.editor.ui.uiUtils,r=c.editor.dom.domUtils,w=c.editor.ui.UIBase,u=c.editor.ui.Stateful,s=c.editor.ui.SplitButton=function(x){this.initOptions(x);this.initSplitButton();};s.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();var y=this;if(this.popup!=null){var x=this.popup;this.popup=null;this.setPopup(x);}},_UIBase_postRender:w.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender();},setPopup:function(x){if(this.popup===x){return;}if(this.popup!=null){this.popup.dispose();}x.addListener("show",t.bind(this._onPopupShow,this));x.addListener("hide",t.bind(this._onPopupHide,this));x.addListener("postrender",t.bind(function(){x.getDom("body").appendChild(v.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(v.getClientRect(this.getDom()).width-2)+'px"></div>'));x.getDom().className+=" "+this.className;},this));this.popup=x;},_onPopupShow:function(){this.addState("opened");},_onPopupHide:function(){this.removeState("opened");},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>';},showPopup:function(){var x=v.getClientRect(this.getDom());x.top-=this.popup.SHADOW_RADIUS;x.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(x);},_onArrowClick:function(y,x){if(!this.isDisabled()){this.showPopup();}},_onButtonClick:function(){if(!this.isDisabled()){this.fireEvent("buttonclick");}}};t.inherits(s,w);t.extend(s.prototype,u,true);})();(function(){var s=c.editor.utils,t=c.editor.ui.uiUtils,u=c.editor.ui.ColorPicker,w=c.editor.ui.Popup,r=c.editor.ui.SplitButton,v=c.editor.ui.ColorButton=function(x){this.initOptions(x);this.initColorButton();};v.prototype={initColorButton:function(){var x=this;this.popup=new w({content:new u({noColorText:x.editor.getLang("clearColor"),editor:x.editor,onpickcolor:function(z,y){x._onPickColor(y);},onpicknocolor:function(z,y){x._onPickNoColor(y);}}),editor:x.editor});this.initSplitButton();},_SplitButton_postRender:r.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(t.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));this.getDom().className+=" edui-colorbutton";},setColor:function(x){this.getDom("colorlump").style.backgroundColor=x;this.color=x;},_onPickColor:function(x){if(this.fireEvent("pickcolor",x)!==false){this.setColor(x);this.popup.hide();}},_onPickNoColor:function(x){if(this.fireEvent("picknocolor")!==false){this.popup.hide();}}};s.inherits(v,r);})();(function(){var s=c.editor.utils,t=c.editor.ui.Popup,u=c.editor.ui.TablePicker,r=c.editor.ui.SplitButton,v=c.editor.ui.TableButton=function(w){this.initOptions(w);this.initTableButton();};v.prototype={initTableButton:function(){var w=this;this.popup=new t({content:new u({editor:w.editor,onpicktable:function(x,z,y){w._onPickTable(z,y);}}),editor:w.editor});this.initSplitButton();},_onPickTable:function(x,w){if(this.fireEvent("picktable",x,w)!==false){this.popup.hide();}}};s.inherits(v,r);})();(function(){var r=c.editor.utils,s=c.editor.ui.UIBase;var t=c.editor.ui.AutoTypeSetPicker=function(u){this.initOptions(u);this.initAutoTypeSetPicker();};t.prototype={initAutoTypeSetPicker:function(){this.initUIBase();},getHtmlTpl:function(){var v=this.editor,u=v.options.autotypeset,w=v.getLang("autoTypeSet");return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap colspan="2"><input type="checkbox" name="mergeEmptyline" '+(u.mergeEmptyline?"checked":"")+">"+w.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(u.removeEmptyline?"checked":"")+">"+w.delLine+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="removeClass" '+(u.removeClass?"checked":"")+">"+w.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(u.indent?"checked":"")+">"+w.indent+'</td></tr><tr><td nowrap colspan="2"><input type="checkbox" name="textAlign" '+(u.textAlign?"checked":"")+">"+w.alignment+'</td><td colspan="2" id="textAlignValue"><input type="radio" name="textAlignValue" value="left" '+((u.textAlign&&u.textAlign=="left")?"checked":"")+">"+v.getLang("justifyleft")+'<input type="radio" name="textAlignValue" value="center" '+((u.textAlign&&u.textAlign=="center")?"checked":"")+">"+v.getLang("justifycenter")+'<input type="radio" name="textAlignValue" value="right" '+((u.textAlign&&u.textAlign=="right")?"checked":"")+">"+v.getLang("justifyright")+' </tr><tr><td nowrap colspan="2"><input type="checkbox" name="imageBlockLine" '+(u.imageBlockLine?"checked":"")+">"+w.imageFloat+'</td><td nowrap colspan="2" id="imageBlockLineValue"><input type="radio" name="imageBlockLineValue" value="none" '+((u.imageBlockLine&&u.imageBlockLine=="none")?"checked":"")+">"+v.getLang("default")+'<input type="radio" name="imageBlockLineValue" value="left" '+((u.imageBlockLine&&u.imageBlockLine=="left")?"checked":"")+">"+v.getLang("justifyleft")+'<input type="radio" name="imageBlockLineValue" value="center" '+((u.imageBlockLine&&u.imageBlockLine=="center")?"checked":"")+">"+v.getLang("justifycenter")+'<input type="radio" name="imageBlockLineValue" value="right" '+((u.imageBlockLine&&u.imageBlockLine=="right")?"checked":"")+">"+v.getLang("justifyright")+'</tr><tr><td nowrap colspan="2"><input type="checkbox" name="clearFontSize" '+(u.clearFontSize?"checked":"")+">"+w.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(u.clearFontFamily?"checked":"")+">"+w.removeFontFamily+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="removeEmptyNode" '+(u.removeEmptyNode?"checked":"")+">"+w.removeHtml+'</td></tr><tr><td nowrap colspan="4"><input type="checkbox" name="pasteFilter" '+(u.pasteFilter?"checked":"")+">"+w.pasteFilter+'</td></tr><tr><td nowrap colspan="4" align="right"><button >'+w.run+"</button></td></tr></table></div></div>";},_UIBase_render:s.prototype.render};r.inherits(t,s);})();(function(){var s=c.editor.utils,u=c.editor.ui.Popup,v=c.editor.ui.AutoTypeSetPicker,r=c.editor.ui.SplitButton,w=c.editor.ui.AutoTypeSetButton=function(x){this.initOptions(x);this.initAutoTypeSetButton();};function t(G){var y=G.editor.options.autotypeset,K=G.getDom(),E=f.getElementsByTagName(K,"input");for(var B=E.length-1,J;J=E[B--];){if(J.getAttribute("type")=="checkbox"){var H=J.getAttribute("name");y[H]&&delete y[H];if(J.checked){var C=document.getElementById(H+"Value");if(C){if(/input/ig.test(C.tagName)){y[H]=C.value;}else{var x=C.getElementsByTagName("input");for(var z=x.length-1,I;I=x[z--];){if(I.checked){y[H]=I.value;break;}}}}else{y[H]=true;}}}}var F=f.getElementsByTagName(K,"select");for(var B=0,A;A=F[B++];){var D=A.getAttribute("name");y[D]=y[D]?A.value:"";}G.editor.options.autotypeset=y;}w.prototype={initAutoTypeSetButton:function(){var y=this;this.popup=new u({content:new v({editor:y.editor}),editor:y.editor,hide:function(){if(!this._hidden&&this.getDom()){t(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide");}}});var x=0;this.popup.addListener("postRenderAfter",function(){var A=this;if(x){return;}var z=this.getDom(),B=z.getElementsByTagName("button")[0];B.onclick=function(){t(A);y.editor.execCommand("autotypeset");A.hide();};x=1;});this.initSplitButton();}};s.inherits(w,r);})();(function(){var r=c.editor.utils,v=c.editor.ui.Popup,t=c.editor.ui.Stateful,u=c.editor.ui.UIBase;var s=c.editor.ui.CellAlignPicker=function(w){this.initOptions(w);this.initCellAlignPicker();};s.prototype={initCellAlignPicker:function(){this.initUIBase();this.Stateful_init();},getHtmlTpl:function(){return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);"><tr><td index="0" stateful><div class="edui-icon edui-left"></div></td><td index="1" stateful><div class="edui-icon edui-center"></div></td><td index="2" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="3" stateful><div class="edui-icon edui-left"></div></td><td index="4" stateful><div class="edui-icon edui-center"></div></td><td index="5" stateful><div class="edui-icon edui-right"></div></td></tr><tr><td index="6" stateful><div class="edui-icon edui-left"></div></td><td index="7" stateful><div class="edui-icon edui-center"></div></td><td index="8" stateful><div class="edui-icon edui-right"></div></td></tr></table></div></div>';},getStateDom:function(){return this.target;},_onClick:function(w){var x=w.target||w.srcElement;if(/icon/.test(x.className)){this.items[x.parentNode.getAttribute("index")].onclick();v.postHide(w);}},_UIBase_render:u.prototype.render};r.inherits(s,u);r.extend(s.prototype,t,true);})();(function(){var r=c.editor.utils,t=c.editor.ui.Stateful,s=c.editor.ui.uiUtils,v=c.editor.ui.UIBase;var u=c.editor.ui.PastePicker=function(w){this.initOptions(w);this.initPastePicker();};u.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init();},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>';},getStateDom:function(){return this.target;},format:function(w){this.editor.ui._isTransfer=true;this.editor.fireEvent("pasteTransfer",w);},_onClick:function(z){var x=f.getNextDomNode(z),w=s.getViewportRect().height,y=s.getClientRect(x);if((y.top+y.height)>w){x.style.top=(-y.height-z.offsetHeight)+"px";}else{x.style.top="";}if(/hidden/ig.test(f.getComputedStyle(x,"visibility"))){x.style.visibility="visible";f.addClass(z,"edui-state-opened");}else{x.style.visibility="hidden";f.removeClasses(z,"edui-state-opened");}},_UIBase_render:v.prototype.render};r.inherits(u,v);r.extend(u.prototype,t,true);})();(function(){var r=c.editor.utils,s=c.editor.ui.uiUtils,u=c.editor.ui.UIBase,t=c.editor.ui.Toolbar=function(v){this.initOptions(v);this.initToolbar();};t.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase();},add:function(v){this.items.push(v);},getHtmlTpl:function(){var w=[];for(var v=0;v<this.items.length;v++){w[v]=this.items[v].renderHtml();}return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+w.join("")+"</div>";},postRender:function(){var w=this.getDom();for(var v=0;v<this.items.length;v++){this.items[v].postRender();}s.makeUnselectable(w);},_onMouseDown:function(){return false;}};r.inherits(t,u);})();(function(){var y=c.editor.utils,u=c.editor.dom.domUtils,s=c.editor.ui.uiUtils,t=c.editor.ui.UIBase,z=c.editor.ui.Popup,r=c.editor.ui.Stateful,A=c.editor.ui.CellAlignPicker,v=c.editor.ui.Menu=function(B){this.initOptions(B);this.initMenu();};var w={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>';},postRender:function(){},queryAutoHide:function(){return true;}};v.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems();},initItems:function(){for(var B=0;B<this.items.length;B++){var C=this.items[B];if(C=="-"){this.items[B]=this.getSeparator();}else{if(!(C instanceof x)){C.editor=this.editor;C.theme=this.editor.options.theme;this.items[B]=this.createItem(C);}}}},getSeparator:function(){return w;},createItem:function(B){return new x(B);},_Popup_getContentHtmlTpl:z.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0){return this._Popup_getContentHtmlTpl();}var D=[];for(var B=0;B<this.items.length;B++){var C=this.items[B];D[B]=C.renderHtml();}return('<div class="%%-body">'+D.join("")+"</div>");},_Popup_postRender:z.prototype.postRender,postRender:function(){var D=this;for(var B=0;B<this.items.length;B++){var C=this.items[B];C.ownerMenu=this;C.postRender();}u.on(this.getDom(),"mouseover",function(F){F=F||event;var E=F.relatedTarget||F.fromElement;var G=D.getDom();if(!s.contains(G,E)&&G!==E){D.fireEvent("over");}});this._Popup_postRender();},queryAutoHide:function(C){if(C){if(s.contains(this.getDom(),C)){return false;}for(var B=0;B<this.items.length;B++){var D=this.items[B];if(D.queryAutoHide(C)===false){return false;}}}},clearItems:function(){for(var B=0;B<this.items.length;B++){var C=this.items[B];clearTimeout(C._showingTimer);clearTimeout(C._closingTimer);if(C.subMenu){C.subMenu.destroy();}}this.items=[];},destroy:function(){if(this.getDom()){u.remove(this.getDom());}this.clearItems();},dispose:function(){this.destroy();}};y.inherits(v,z);var x=c.editor.ui.MenuItem=function(B){this.initOptions(B);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof v)){if(B.className&&B.className.indexOf("aligntd")!=-1){var C=this;this.subMenu=new z({content:new A(this.subMenu),parentMenu:C,editor:C.editor,destroy:function(){if(this.getDom()){u.remove(this.getDom());}}});this.subMenu.addListener("postRenderAfter",function(){u.on(this.getDom(),"mouseover",function(){C.addState("opened");});});}else{this.subMenu=new v(this.subMenu);}}};x.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>";},postRender:function(){var B=this;this.addListener("over",function(){B.ownerMenu.fireEvent("submenuover",B);if(B.subMenu){B.delayShowSubMenu();}});if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){B.delayHideSubMenu();});this.subMenu.addListener("over",function(){clearTimeout(B._closingTimer);B._closingTimer=null;B.addState("opened");});this.ownerMenu.addListener("hide",function(){B.hideSubMenu();});this.ownerMenu.addListener("submenuover",function(D,C){if(C!==B){B.delayHideSubMenu();}});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(C){if(C&&s.contains(B.getDom(),C)){return false;}return this._bakQueryAutoHide(C);};}this.getDom().style.tabIndex="-1";s.makeUnselectable(this.getDom());this.Stateful_postRender();},delayShowSubMenu:function(){var B=this;if(!B.isDisabled()){B.addState("opened");clearTimeout(B._showingTimer);clearTimeout(B._closingTimer);B._closingTimer=null;B._showingTimer=setTimeout(function(){B.showSubMenu();},250);}},delayHideSubMenu:function(){var B=this;if(!B.isDisabled()){B.removeState("opened");clearTimeout(B._showingTimer);if(!B._closingTimer){B._closingTimer=setTimeout(function(){if(!B.hasState("opened")){B.hideSubMenu();}B._closingTimer=null;},400);}}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>";},getStateDom:function(){return this.getDom();},queryAutoHide:function(B){if(this.subMenu&&this.hasState("opened")){return this.subMenu.queryAutoHide(B);}},_onClick:function(B,C){if(this.hasState("disabled")){return;}if(this.fireEvent("click",B,C)!==false){if(this.subMenu){this.showSubMenu();}else{z.postHide(B);}}},showSubMenu:function(){var B=s.getClientRect(this.getDom());B.right-=5;B.left+=2;B.width-=7;B.top-=4;B.bottom+=4;B.height+=8;this.subMenu.showAnchorRect(B,true,true);},hideSubMenu:function(){this.subMenu.hide();}};y.inherits(x,t);y.extend(x.prototype,r,true);})();(function(){var s=c.editor.utils,u=c.editor.ui.uiUtils,v=c.editor.ui.Menu,r=c.editor.ui.SplitButton,t=c.editor.ui.Combox=function(w){this.initOptions(w);this.initCombox();};t.prototype={uiName:"combox",initCombox:function(){var y=this;this.items=this.items||[];for(var w=0;w<this.items.length;w++){var x=this.items[w];x.uiName="listitem";x.index=w;x.onclick=function(){y.selectByIndex(this.index);};}this.popup=new v({items:this.items,uiName:"list",editor:this.editor});this.initSplitButton();},_SplitButton_postRender:r.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||"");this.setValue(this.initValue||"");},showPopup:function(){var w=u.getClientRect(this.getDom());w.top+=1;w.bottom-=1;w.height-=2;this.popup.showAnchorRect(w);},getValue:function(){return this.value;},setValue:function(x){var w=this.indexByValue(x);if(w!=-1){this.selectedIndex=w;this.setLabel(this.items[w].label);this.value=this.items[w].value;}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(x));this.value=x;}},setLabel:function(w){this.getDom("button_body").innerHTML=w;this.label=w;},getLabelForUnknowValue:function(w){return w;},indexByValue:function(x){for(var w=0;w<this.items.length;w++){if(x==this.items[w].value){return w;}}return -1;},getItem:function(w){return this.items[w];},selectByIndex:function(w){if(w<this.items.length&&this.fireEvent("select",w)!==false){this.selectedIndex=w;this.value=this.items[w].value;this.setLabel(this.items[w].label);}}};s.inherits(t,r);})();(function(){var y=c.editor.utils,u=c.editor.dom.domUtils,r=c.editor.ui.uiUtils,v=c.editor.ui.Mask,s=c.editor.ui.UIBase,w=c.editor.ui.Button,x=c.editor.ui.Dialog=function(A){this.initOptions(y.extend({autoReset:true,draggable:true,onok:function(){},oncancel:function(){},onclose:function(C,B){return B?this.onok():this.oncancel();}},A));this.initDialog();};var t;var z;x.prototype={draggable:false,uiName:"dialog",initDialog:function(){var B=this,C=this.editor.options.theme;this.initUIBase();this.modalMask=(t||(t=new v({className:"edui-dialog-modalmask",theme:C})));this.dragMask=(z||(z=new v({className:"edui-dialog-dragmask",theme:C})));this.closeButton=new w({className:"edui-dialog-closebutton",title:B.closeDialog,theme:C,onclick:function(){B.close(false);}});if(this.buttons){for(var A=0;A<this.buttons.length;A++){if(!(this.buttons[A] instanceof w)){this.buttons[A]=new w(this.buttons[A]);}}}},fitSize:function(){var A=this.getDom("body");var B=this.mesureSize();A.style.width=B.width+"px";A.style.height=B.height+"px";return B;},safeSetOffset:function(G){var C=this;var A=C.getDom();var F=r.getViewportRect();var B=r.getClientRect(A);var E=G.left;if(E+B.width>F.right){E=F.right-B.width;}var D=G.top;if(D+B.height>F.bottom){D=F.bottom-B.height;}A.style.left=Math.max(E,0)+"px";A.style.top=Math.max(D,0)+"px";},showAtCenter:function(){this.getDom().style.display="";var F=r.getViewportRect();var A=this.fitSize();var E=this.getDom("titlebar").offsetHeight|0;var D=F.width/2-A.width/2;var C=F.height/2-(A.height-E)/2-E;var B=this.getDom();this.safeSetOffset({left:Math.max(D|0,0),top:Math.max(C|0,0)});if(!u.hasClass(B,"edui-state-centered")){B.className+=" edui-state-centered";}this._show();},getContentHtml:function(){var A="";if(typeof this.content=="string"){A=this.content;}else{if(this.iframeUrl){A='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>';}}return A;},getHtmlTpl:function(){var B="";if(this.buttons){var C=[];for(var A=0;A<this.buttons.length;A++){C[A]=this.buttons[A].renderHtml();}B='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+C.join("")+"</div></div>";}return'<div id="##" class="%%"><div class="%%-wrap"><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+"</div>"+B+"</div></div></div>";},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide();}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide();}var B=this;this.addListener("show",function(){B.modalMask.show(this.getDom().style.zIndex-2);});this.addListener("hide",function(){B.modalMask.hide();});if(this.buttons){for(var A=0;A<this.buttons.length;A++){this.buttons[A].postRender();}}u.on(window,"resize",function(){setTimeout(function(){if(!B.isHidden()){B.safeSetOffset(r.getClientRect(B.getDom()));}});});this._hide();},mesureSize:function(){var A=this.getDom("body");var B=r.getClientRect(this.getDom("content")).width;var C=A.style;C.width=B;return r.getClientRect(A);},_onTitlebarMouseDown:function(A,B){if(this.draggable){var D;var E=r.getViewportRect();var C=this;r.startDrag(A,{ondragstart:function(){D=r.getClientRect(C.getDom());C.getDom("contmask").style.visibility="visible";C.dragMask.show(C.getDom().style.zIndex-1);},ondragmove:function(F,I){var H=D.left+F;var G=D.top+I;C.safeSetOffset({left:H,top:G});},ondragstop:function(){C.getDom("contmask").style.visibility="hidden";u.removeClasses(C.getDom(),["edui-state-centered"]);C.dragMask.hide();}});}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml();},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");c.editor.ui.uiUtils.getFixedLayer().style.zIndex=this.getDom().style.zIndex-4;}},isHidden:function(){return this._hidden;},_hide:function(){if(!this._hidden){this.getDom().style.display="none";this.getDom().style.zIndex="";this._hidden=true;this.fireEvent("hide");}},open:function(){if(this.autoReset){try{this.reset();}catch(B){this.render();this.open();}}this.showAtCenter();if(this.iframeUrl){try{this.getDom("iframe").focus();}catch(A){}}},_onCloseButtonClick:function(A,B){this.close(false);},close:function(A){if(this.fireEvent("close",A)!==false){this._hide();}}};y.inherits(x,s);})();(function(){var s=c.editor.utils,t=c.editor.ui.Menu,r=c.editor.ui.SplitButton,u=c.editor.ui.MenuButton=function(v){this.initOptions(v);this.initMenuButton();};u.prototype={initMenuButton:function(){var v=this;this.uiName="menubutton";this.popup=new t({items:v.items,className:v.className,editor:v.editor});this.popup.addListener("show",function(){var x=this;for(var w=0;w<x.items.length;w++){x.items[w].removeState("checked");if(x.items[w].value==v._value){x.items[w].addState("checked");this.value=v._value;}}});this.initSplitButton();},setValue:function(v){this._value=v;}};s.inherits(u,r);})();(function(){var E=c.editor.utils;var B=c.editor.ui;var w=B.Dialog;B.buttons={};B.Dialog=function(r){var I=new w(r);I.addListener("hide",function(){if(I.editor){var L=I.editor;try{if(k.gecko){var M=L.window.scrollY,J=L.window.scrollX;L.body.focus();L.window.scrollTo(J,M);}else{L.focus();}}catch(K){}}});return I;};var x={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",highlightcode:"~/dialogs/highlightcode/highlightcode.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html"};var A=["undo","redo","formatmatch","bold","italic","underline","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","preview","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow","deletecol","splittorows","splittocols","splittocells","mergecells","deletetable"];for(var y=0,H;H=A[y++];){H=H.toLowerCase();B[H]=function(r){return function(I){var J=new B.Button({className:"edui-for-"+r,title:I.options.labelMap[r]||I.getLang("labelMap."+r)||"",onclick:function(){I.execCommand(r);},theme:I.options.theme,showText:false});B.buttons[r]=J;I.addListener("selectionchange",function(L,K,N){var M=I.queryCommandState(r);if(M==-1){J.setDisabled(true);J.setChecked(false);}else{if(!N){J.setDisabled(false);J.setChecked(M);}}});return J;};}(H);}B.cleardoc=function(r){var I=new B.Button({className:"edui-for-cleardoc",title:r.options.labelMap.cleardoc||r.getLang("labelMap.cleardoc")||"",theme:r.options.theme,onclick:function(){if(confirm(r.getLang("confirmClear"))){r.execCommand("cleardoc");}}});B.buttons.cleardoc=I;r.addListener("selectionchange",function(){I.setDisabled(r.queryCommandState("cleardoc")==-1);});return I;};var D={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr","rtl"]};for(var t in D){(function(J,K){for(var I=0,r;r=K[I++];){(function(L){B[J.replace("float","")+L]=function(M){var N=new B.Button({className:"edui-for-"+J.replace("float","")+L,title:M.options.labelMap[J.replace("float","")+L]||M.getLang("labelMap."+J.replace("float","")+L)||"",theme:M.options.theme,onclick:function(){M.execCommand(J,L);}});B.buttons[J]=N;M.addListener("selectionchange",function(P,O,Q){N.setDisabled(M.queryCommandState(J)==-1);N.setChecked(M.queryCommandValue(J)==L&&!Q);});return N;};})(r);}})(t,D[t]);}for(var y=0,H;H=["backcolor","forecolor"][y++];){B[H]=function(r){return function(I){var J=new B.ColorButton({className:"edui-for-"+r,color:"default",title:I.options.labelMap[r]||I.getLang("labelMap."+r)||"",editor:I,onpickcolor:function(L,K){I.execCommand(r,K);},onpicknocolor:function(){I.execCommand(r,"default");this.setColor("transparent");this.color="default";},onbuttonclick:function(){I.execCommand(r,this.color);}});B.buttons[r]=J;I.addListener("selectionchange",function(){J.setDisabled(I.queryCommandState(r)==-1);});return J;};}(H);}var z={noOk:["searchreplace","help","spechars","webapp"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","highlightcode","insertframe","edittip","edittable","edittd","scrawl","template","music","background"]};for(var t in z){(function(J,K){for(var I=0,r;r=K[I++];){if(k.opera&&r==="searchreplace"){continue;}(function(L){B[L]=function(O,N,Q){N=N||(O.options.iframeUrlMap||{})[L]||x[L];Q=O.options.labelMap[L]||O.getLang("labelMap."+L)||"";var M;if(N){M=new B.Dialog(E.extend({iframeUrl:O.ui.mapUrl(N),editor:O,className:"edui-for-"+L,title:Q,closeDialog:O.getLang("closeDialog")},J=="ok"?{buttons:[{className:"edui-okbutton",label:O.getLang("ok"),editor:O,onclick:function(){M.close(true);}},{className:"edui-cancelbutton",label:O.getLang("cancel"),editor:O,onclick:function(){M.close(false);}}]}:{}));O.ui._dialogs[L+"Dialog"]=M;}var P=new B.Button({className:"edui-for-"+L,title:Q,onclick:function(){if(M){switch(L){case"wordimage":O.execCommand("wordimage","word_img");if(O.word_img){M.render();M.open();}break;case"scrawl":if(O.queryCommandState("scrawl")!=-1){M.render();M.open();}break;default:M.render();M.open();}}},theme:O.options.theme,disabled:L=="scrawl"&&O.queryCommandState("scrawl")==-1});B.buttons[L]=P;O.addListener("selectionchange",function(){var R={edittable:1};if(L in R){return;}var S=O.queryCommandState(L);if(P.getDom()){P.setDisabled(S==-1);P.setChecked(S);}});return P;};})(r.toLowerCase());}})(t,z[t]);}B.snapscreen=function(J,I,L){L=J.options.labelMap.snapscreen||J.getLang("labelMap.snapscreen")||"";var K=new B.Button({className:"edui-for-snapscreen",title:L,onclick:function(){J.execCommand("snapscreen");},theme:J.options.theme});B.buttons.snapscreen=K;I=I||(J.options.iframeUrlMap||{})["snapscreen"]||x.snapscreen;if(I){var r=new B.Dialog({iframeUrl:J.ui.mapUrl(I),editor:J,className:"edui-for-snapscreen",title:L,buttons:[{className:"edui-okbutton",label:J.getLang("ok"),editor:J,onclick:function(){r.close(true);}},{className:"edui-cancelbutton",label:J.getLang("cancel"),editor:J,onclick:function(){r.close(false);}}]});r.render();J.ui._dialogs.snapscreenDialog=r;}J.addListener("selectionchange",function(){K.setDisabled(J.queryCommandState("snapscreen")==-1);});return K;};B.fontfamily=function(K,M,O){M=K.options.fontfamily||[];O=K.options.labelMap.fontfamily||K.getLang("labelMap.fontfamily")||"";if(!M.length){return;}for(var J=0,I,r=[];I=M[J];J++){var N=K.getLang("fontfamily")[I.name]||"";(function(P,Q){r.push({label:P,value:Q,theme:K.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+E.unhtml(this.value)+'">'+(this.label||"")+"</div>";}});})(I.label||N,I.val);}var L=new B.Combox({editor:K,items:r,onselect:function(Q,P){K.execCommand("FontFamily",this.items[P].value);},onbuttonclick:function(){this.showPopup();},title:O,initValue:O,className:"edui-for-fontfamily",indexByValue:function(R){if(R){for(var Q=0,P;P=this.items[Q];Q++){if(P.value.indexOf(R)!=-1){return Q;}}}return -1;}});B.buttons.fontfamily=L;K.addListener("selectionchange",function(Q,P,T){if(!T){var S=K.queryCommandState("FontFamily");if(S==-1){L.setDisabled(true);}else{L.setDisabled(false);var R=K.queryCommandValue("FontFamily");R&&(R=R.replace(/['"]/g,"").split(",")[0]);L.setValue(R);}}});return L;};B.fontsize=function(K,M,N){N=K.options.labelMap.fontsize||K.getLang("labelMap.fontsize")||"";M=M||K.options.fontsize||[];if(!M.length){return;}var r=[];for(var J=0;J<M.length;J++){var I=M[J]+"px";r.push({label:I,value:I,theme:K.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>";}});}var L=new B.Combox({editor:K,items:r,title:N,initValue:N,onselect:function(P,O){K.execCommand("FontSize",this.items[O].value);},onbuttonclick:function(){this.showPopup();},className:"edui-for-fontsize"});B.buttons.fontsize=L;K.addListener("selectionchange",function(P,O,R){if(!R){var Q=K.queryCommandState("FontSize");if(Q==-1){L.setDisabled(true);}else{L.setDisabled(false);L.setValue(K.queryCommandValue("FontSize"));}}});return L;};B.paragraph=function(J,L,M){M=J.options.labelMap.paragraph||J.getLang("labelMap.paragraph")||"";L=J.options.paragraph||[];if(E.isEmptyObject(L)){return;}var r=[];for(var I in L){r.push({value:I,label:L[I]||J.getLang("paragraph")[I],theme:J.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>";}});}var K=new B.Combox({editor:J,items:r,title:M,initValue:M,className:"edui-for-paragraph",onselect:function(O,N){J.execCommand("Paragraph",this.items[N].value);},onbuttonclick:function(){this.showPopup();}});B.buttons.paragraph=K;J.addListener("selectionchange",function(P,O,S){if(!S){var R=J.queryCommandState("Paragraph");if(R==-1){K.setDisabled(true);}else{K.setDisabled(false);var Q=J.queryCommandValue("Paragraph");var N=K.indexByValue(Q);if(N!=-1){K.setValue(Q);}else{K.setValue(K.initValue);}}}});return K;};B.customstyle=function(L){var N=L.options.customstyle||[],O=L.options.labelMap.customstyle||L.getLang("labelMap.customstyle")||"";if(!N.length){return;}var K=L.getLang("customstyle");for(var J=0,r=[],I;I=N[J++];){(function(Q){var P={};P.label=Q.label?Q.label:K[Q.name];P.style=Q.style;P.className=Q.className;P.tag=Q.tag;r.push({label:P.label,value:P,theme:L.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+P.tag+" "+(P.className?' class="'+P.className+'"':"")+(P.style?' style="'+P.style+'"':"")+">"+P.label+"</"+P.tag+"></div>";}});})(I);}var M=new B.Combox({editor:L,items:r,title:O,initValue:O,className:"edui-for-customstyle",onselect:function(Q,P){L.execCommand("customstyle",this.items[P].value);},onbuttonclick:function(){this.showPopup();},indexByValue:function(R){for(var P=0,Q;Q=this.items[P++];){if(Q.label==R){return P-1;}}return -1;}});B.buttons.customstyle=M;L.addListener("selectionchange",function(R,Q,U){if(!U){var T=L.queryCommandState("customstyle");if(T==-1){M.setDisabled(true);}else{M.setDisabled(false);var S=L.queryCommandValue("customstyle");var P=M.indexByValue(S);if(P!=-1){M.setValue(S);}else{M.setValue(M.initValue);}}}});return M;};B.inserttable=function(I,r,K){K=I.options.labelMap.inserttable||I.getLang("labelMap.inserttable")||"";var J=new B.TableButton({editor:I,title:K,className:"edui-for-inserttable",onpicktable:function(L,N,M){I.execCommand("InsertTable",{numRows:M,numCols:N,border:1});},onbuttonclick:function(){this.showPopup();}});B.buttons.inserttable=J;I.addListener("selectionchange",function(){J.setDisabled(I.queryCommandState("inserttable")==-1);});return J;};B.lineheight=function(K){var M=K.options.lineheight||[];if(!M.length){return;}for(var J=0,I,r=[];I=M[J++];){r.push({label:I,value:I,theme:K.options.theme,onclick:function(){K.execCommand("lineheight",this.value);}});}var L=new B.MenuButton({editor:K,className:"edui-for-lineheight",title:K.options.labelMap.lineheight||K.getLang("labelMap.lineheight")||"",items:r,onbuttonclick:function(){var N=K.queryCommandValue("LineHeight")||this.value;K.execCommand("LineHeight",N);}});B.buttons.lineheight=L;K.addListener("selectionchange",function(){var O=K.queryCommandState("LineHeight");if(O==-1){L.setDisabled(true);}else{L.setDisabled(false);var N=K.queryCommandValue("LineHeight");N&&L.setValue((N+"").replace(/cm/,""));L.setChecked(O);}});return L;};var u=["top","bottom"];for(var s=0,C;C=u[s++];){(function(r){B["rowspacing"+r]=function(L){var N=L.options["rowspacing"+r]||[];if(!N.length){return null;}for(var K=0,J,I=[];J=N[K++];){I.push({label:J,value:J,theme:L.options.theme,onclick:function(){L.execCommand("rowspacing",this.value,r);}});}var M=new B.MenuButton({editor:L,className:"edui-for-rowspacing"+r,title:L.options.labelMap["rowspacing"+r]||L.getLang("labelMap.rowspacing"+r)||"",items:I,onbuttonclick:function(){var O=L.queryCommandValue("rowspacing",r)||this.value;L.execCommand("rowspacing",O,r);}});B.buttons[r]=M;L.addListener("selectionchange",function(){var P=L.queryCommandState("rowspacing",r);if(P==-1){M.setDisabled(true);}else{M.setDisabled(false);var O=L.queryCommandValue("rowspacing",r);O&&M.setValue((O+"").replace(/%/,""));M.setChecked(P);}});return M;};})(C);}var G=["insertorderedlist","insertunorderedlist"];for(var v=0,F;F=G[v++];){(function(r){B[r]=function(K){var M=K.options[r],N=function(){K.execCommand(r,this.value);},I=[];for(var J in M){I.push({label:M[J]||K.getLang()[r][J]||"",value:J,theme:K.options.theme,onclick:N});}var L=new B.MenuButton({editor:K,className:"edui-for-"+r,title:K.getLang("labelMap."+r)||"",items:I,onbuttonclick:function(){var O=K.queryCommandValue(r)||this.value;K.execCommand(r,O);}});B.buttons[r]=L;K.addListener("selectionchange",function(){var P=K.queryCommandState(r);if(P==-1){L.setDisabled(true);}else{L.setDisabled(false);var O=K.queryCommandValue(r);L.setValue(O);L.setChecked(P);}});return L;};})(F);}B.fullscreen=function(r,J){J=r.options.labelMap.fullscreen||r.getLang("labelMap.fullscreen")||"";var I=new B.Button({className:"edui-for-fullscreen",title:J,theme:r.options.theme,onclick:function(){if(r.ui){r.ui.setFullScreen(!r.ui.isFullScreen());}this.setChecked(r.ui.isFullScreen());}});B.buttons.fullscreen=I;r.addListener("selectionchange",function(){var K=r.queryCommandState("fullscreen");I.setDisabled(K==-1);I.setChecked(r.ui.isFullScreen());});return I;};B.emotion=function(I,r){var J=new B.MultiMenuPop({title:I.options.labelMap.emotion||I.getLang("labelMap.emotion")||"",editor:I,className:"edui-for-emotion",iframeUrl:I.ui.mapUrl(r||(I.options.iframeUrlMap||{})["emotion"]||x.emotion)});B.buttons.emotion=J;I.addListener("selectionchange",function(){J.setDisabled(I.queryCommandState("emotion")==-1);});return J;};B.autotypeset=function(r){var I=new B.AutoTypeSetButton({editor:r,title:r.options.labelMap.autotypeset||r.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){r.execCommand("autotypeset");}});B.buttons.autotypeset=I;r.addListener("selectionchange",function(){I.setDisabled(r.queryCommandState("autotypeset")==-1);});return I;};})();(function(){var s=c.editor.utils,u=c.editor.ui.uiUtils,w=c.editor.ui.UIBase,r=c.editor.dom.domUtils;var v=[];function t(y){this.initOptions(y);this.initEditorUI();}t.prototype={uiName:"editor",initEditorUI:function(){this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var A=this.editor,B=this;A.addListener("ready",function(){A.getDialog=function(G){return A.ui._dialogs[G+"Dialog"];};r.on(A.window,"scroll",function(G){c.editor.ui.Popup.postHide(G);});A.ui._actualFrameWidth=A.options.initialFrameWidth;if(A.options.elementPathEnabled){A.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+A.getLang("elementPathTip")+":</div>";}if(A.options.wordCount){function F(){C(A,B);r.un(A.document,"click",arguments.callee);}r.on(A.document,"click",F);A.ui.getDom("wordcount").innerHTML=A.getLang("wordCountTip");}A.ui._scale();if(A.options.scaleEnabled){if(A.autoHeightEnabled){A.disableAutoHeight();}B.enableScale();}else{B.disableScale();}if(!A.options.elementPathEnabled&&!A.options.wordCount&&!A.options.scaleEnabled){A.ui.getDom("elementpath").style.display="none";A.ui.getDom("wordcount").style.display="none";A.ui.getDom("scale").style.display="none";}if(!A.selection.isFocus()){return;}A.fireEvent("selectionchange",false,true);});A.addListener("mousedown",function(G,F){var H=F.target||F.srcElement;c.editor.ui.Popup.postHide(F,H);});A.addListener("delcells",function(){if(UE.ui.edittip){new UE.ui.edittip(A);}A.getDialog("edittip").open();});var z,D=false,E;A.addListener("afterpaste",function(){if(A.queryCommandState("pasteplain")){return;}z=new c.editor.ui.Popup({content:new c.editor.ui.PastePicker({editor:A}),editor:A,className:"edui-wordpastepop"});z.render();D=true;});A.addListener("afterinserthtml",function(){clearTimeout(E);E=setTimeout(function(){if(z&&(D||A.ui._isTransfer)){var G=r.createElement(A.document,"span",{style:"line-height:0px;",innerHTML:"\ufeff"}),F=A.selection.getRange();F.insertNode(G);z.showAnchor(G);r.remove(G);delete A.ui._isTransfer;D=false;}},200);});A.addListener("contextmenu",function(G,F){c.editor.ui.Popup.postHide(F);});A.addListener("keydown",function(G,F){if(z){z.dispose(F);}var H=F.keyCode||F.which;if(F.altKey&&H==90){UE.ui.buttons.fullscreen.onclick();}});A.addListener("wordcount",function(F){C(this,B);});function C(I,L){I.setOpt({wordCount:true,maximumWords:10000,wordCountMsg:I.options.wordCountMsg||I.getLang("wordCountMsg"),wordOverFlowMsg:I.options.wordOverFlowMsg||I.getLang("wordOverFlowMsg")});var G=I.options,F=G.maximumWords,M=G.wordCountMsg,K=G.wordOverFlowMsg,H=L.getDom("wordcount");if(!G.wordCount){return;}var J=I.getContentLength(true);if(J>F){H.innerHTML=K;I.fireEvent("wordcountoverflow");}else{H.innerHTML=M.replace("{#leave}",F-J).replace("{#count}",J);}}A.addListener("selectionchange",function(){if(A.options.elementPathEnabled){B[(A.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]();}if(A.options.scaleEnabled){B[(A.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]();}});var y=new c.editor.ui.Popup({editor:A,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();A.ui._dialogs.linkDialog.open();},_onImgEditButtonClick:function(F){this.hide();A.ui._dialogs[F]&&A.ui._dialogs[F].open();},_onImgSetFloat:function(F){this.hide();A.execCommand("imagefloat",F);},_setIframeAlign:function(F){var G=y.anchorEl;var H=G.cloneNode(true);switch(F){case -2:H.setAttribute("align","");break;case -1:H.setAttribute("align","left");break;case 1:H.setAttribute("align","right");break;}G.parentNode.insertBefore(H,G);r.remove(G);y.anchorEl=H;y.showAnchor(y.anchorEl);},_updateIframe:function(){A._iframe=y.anchorEl;A.ui._dialogs.insertframeDialog.open();y.hide();},_onRemoveButtonClick:function(F){A.execCommand(F);this.hide();},queryAutoHide:function(F){if(F&&F.ownerDocument==A.document){if(F.tagName.toLowerCase()=="img"||r.findParentByTagName(F,"a",true)){return F!==y.anchorEl;}}return c.editor.ui.Popup.prototype.queryAutoHide.call(this,F);}});y.render();if(A.options.imagePopup){A.addListener("mouseover",function(H,F){F=F||window.event;var I=F.target||F.srcElement;if(A.ui._dialogs.insertframeDialog&&/iframe/ig.test(I.tagName)){var G=y.formatHtml("<nobr>"+A.getLang("property")+': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+A.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+A.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+A.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+A.getLang("modify")+"</span></nobr>");if(G){y.getDom("content").innerHTML=G;y.anchorEl=I;y.showAnchor(y.anchorEl);}else{y.hide();}}});A.addListener("selectionchange",function(O,I){if(!I){return;}var L="",M="",K=A.selection.getRange().getClosedNode(),G=A.ui._dialogs;if(K&&K.tagName=="IMG"){var H="insertimageDialog";if(K.className.indexOf("edui-faked-video")!=-1){H="insertvideoDialog";}if(K.className.indexOf("edui-faked-webapp")!=-1){H="webappDialog";}if(K.src.indexOf("http://api.map.baidu.com")!=-1){H="mapDialog";}if(K.className.indexOf("edui-faked-music")!=-1){H="musicDialog";}if(K.src.indexOf("http://maps.google.com/maps/api/staticmap")!=-1){H="gmapDialog";}if(K.getAttribute("anchorname")){H="anchorDialog";L=y.formatHtml("<nobr>"+A.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+A.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+A.getLang("delete")+"</span></nobr>");}if(K.getAttribute("word_img")){A.word_img=[K.getAttribute("word_img")];H="wordimageDialog";}if(!G[H]){return;}M="<nobr>"+A.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+A.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+A.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+A.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+A.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+H+'\');" class="edui-clickable">'+A.getLang("modify")+"</span></nobr>";!L&&(L=y.formatHtml(M));}if(A.ui._dialogs.linkDialog){var N=A.queryCommandValue("link");var F;if(N&&(F=(N.getAttribute("data_ue_src")||N.getAttribute("href",2)))){var J=F;if(F.length>30){J=F.substring(0,20)+"...";}if(L){L+='<div style="height:5px;"></div>';}L+=y.formatHtml("<nobr>"+A.getLang("anthorMsg")+': <a target="_blank" href="'+F+'" title="'+F+'" >'+J+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+A.getLang("modify")+'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+A.getLang("clear")+"</span></nobr>");y.showAnchor(N);}}if(L){y.getDom("content").innerHTML=L;y.anchorEl=K||N;y.showAnchor(y.anchorEl);}else{y.hide();}});}},_initToolbars:function(){var E=this.editor;var G=this.toolbars||[];var A=[];for(var D=0;D<G.length;D++){var F=G[D];var B=new c.editor.ui.Toolbar({theme:E.options.theme});for(var C=0;C<F.length;C++){var y=F[C];var z=null;if(typeof y=="string"){y=y.toLowerCase();if(y=="|"){y="Separator";}if(c.editor.ui[y]){z=new c.editor.ui[y](E);}if(y=="fullscreen"){if(A&&A[0]){A[0].items.splice(0,0,z);}else{z&&B.items.splice(0,0,z);}continue;}}else{z=y;}if(z&&z.id){B.add(z);}}A[D]=B;}this.toolbars=A;},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>';},showWordImageDialog:function(){this.editor.execCommand("wordimage","word_img");this._dialogs.wordimageDialog.open();},renderToolbarBoxHtml:function(){var z=[];for(var y=0;y<this.toolbars.length;y++){z.push(this.toolbars[y].renderHtml());}return z.join("");},setFullScreen:function(D){var C=this.editor,A=C.container.parentNode.parentNode;if(this._fullscreen!=D){this._fullscreen=D;this.editor.fireEvent("beforefullscreenchange",D);if(c.editor.browser.gecko){var z=C.selection.getRange().createBookmark();}if(D){while(A.tagName!="BODY"){var y=c.editor.dom.domUtils.getComputedStyle(A,"position");v.push(y);A.style.position="static";A=A.parentNode;}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);if(this._bakAutoHeight){C.autoHeightEnabled=false;this.editor.disableAutoHeight();}document.documentElement.style.overflow="hidden";document.body.style.overflow="hidden";this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;this._updateFullScreen();}else{while(A.tagName!="BODY"){A.style.position=v.shift();A=A.parentNode;}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){C.autoHeightEnabled=true;this.editor.enableAutoHeight();}document.documentElement.style.overflow=this._bakHtmlOverflow;document.body.style.overflow=this._bakBodyOverflow;window.scrollTo(0,this._bakScrollTop);}if(c.editor.browser.gecko){var B=document.createElement("input");document.body.appendChild(B);C.body.contentEditable=false;setTimeout(function(){B.focus();setTimeout(function(){C.body.contentEditable=true;C.selection.getRange().moveToBookmark(z).select(true);c.editor.dom.domUtils.remove(B);D&&window.scroll(0,0);},0);},0);}this.editor.fireEvent("fullscreenchanged",D);this.triggerLayout();}},_updateFullScreen:function(){if(this._fullscreen){var y=u.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+y.width+"px;height:"+y.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);u.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(y.height-this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0));}},_updateElementPath:function(){var y=this.getDom("elementpath"),B;if(this.elementPathEnabled&&(B=this.editor.queryCommandValue("elementpath"))){var C=[];for(var A=0,z;z=B[A];A++){C[A]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+A+'&quot;);">'+z+"</span>");}y.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+this.editor.getLang("elementPathTip")+": "+C.join(" &gt; ")+"</div>";}else{y.style.display="none";}},disableElementPath:function(){var y=this.getDom("elementpath");y.innerHTML="";y.style.display="none";this.elementPathEnabled=false;},enableElementPath:function(){var y=this.getDom("elementpath");y.style.display="";this.elementPathEnabled=true;this._updateElementPath();},_scale:function(){var S=document,C=this.editor,Q=C.container,A=C.document,E=this.getDom("toolbarbox"),F=this.getDom("bottombar"),R=this.getDom("scale"),O=this.getDom("scalelayer");var I=false,P=null,D=0,M=C.options.minFrameWidth,z=0,y=0,L=0,B=0;function H(){P=r.getXY(Q);if(!D){D=C.options.minFrameHeight+E.offsetHeight+F.offsetHeight;}O.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+Q.offsetWidth+"px;height:"+Q.offsetHeight+"px;z-index:"+(C.options.zIndex+1);r.on(S,"mousemove",J);r.on(A,"mouseup",G);r.on(S,"mouseup",G);}var N=this;this.editor.addListener("fullscreenchanged",function(V,T){if(T){N.disableScale();}else{if(N.editor.options.scaleEnabled){N.enableScale();var U=N.editor.document.createElement("span");N.editor.body.appendChild(U);N.editor.body.style.height=Math.max(r.getXY(U).y,N.editor.iframe.offsetHeight-20)+"px";r.remove(U);}}});function J(T){K();var U=T||window.event;z=U.pageX||(S.documentElement.scrollLeft+U.clientX);y=U.pageY||(S.documentElement.scrollTop+U.clientY);L=z-P.x;B=y-P.y;if(L>=M){I=true;O.style.width=L+"px";}if(B>=D){I=true;O.style.height=B+"px";}}function G(){if(I){I=false;C.ui._actualFrameWidth=O.offsetWidth-2;Q.style.width=C.ui._actualFrameWidth+"px";C.setHeight(O.offsetHeight-F.offsetHeight-E.offsetHeight-2);}if(O){O.style.display="none";}K();r.un(S,"mousemove",J);r.un(A,"mouseup",G);r.un(S,"mouseup",G);}function K(){if(k.ie){S.selection.clear();}else{window.getSelection().removeAllRanges();}}this.enableScale=function(){if(C.queryCommandState("source")==1){return;}R.style.display="";this.scaleEnabled=true;r.on(R,"mousedown",H);};this.disableScale=function(){R.style.display="none";this.scaleEnabled=false;r.un(R,"mousedown",H);};},isFullScreen:function(){return this._fullscreen;},postRender:function(){w.prototype.postRender.call(this);for(var A=0;A<this.toolbars.length;A++){this.toolbars[A].postRender();}var B=this;var z,y=c.editor.dom.domUtils,C=function(){clearTimeout(z);z=setTimeout(function(){B._updateFullScreen();});};y.on(window,"resize",C);B.addListener("destroy",function(){y.un(window,"resize",C);clearTimeout(z);});},showToolbarMsg:function(A,z){this.getDom("toolbarmsg_label").innerHTML=A;this.getDom("toolbarmsg").style.display="";if(!z){var y=this.getDom("upload_dialog");y.style.display="none";}},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none";},mapUrl:function(y){return y?y.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):"";},triggerLayout:function(){var y=this.getDom();if(y.style.zoom=="1"){y.style.zoom="100%";}else{y.style.zoom="1";}}};s.inherits(t,c.editor.ui.UIBase);var x={};UE.ui.Editor=function(y){var A=new c.editor.Editor(y);A.options.editor=A;s.loadFile(document,{href:A.options.themePath+A.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var z=A.render;A.render=function(B){if(B.constructor===String){A.key=B;x[B]=A;}s.domReady(function(){A.langIsReady?C():A.addListener("langReady",C);function C(){A.setOpt({labelMap:A.options.labelMap||A.getLang("labelMap")});new t(A.options);if(B){if(B.constructor===String){B=document.getElementById(B);}B&&B.getAttribute("name")&&(A.options.textarea=B.getAttribute("name"));if(B&&/script|textarea/ig.test(B.tagName)){var F=document.createElement("div");B.parentNode.insertBefore(F,B);var D=B.value||B.innerHTML;A.options.initialContent=/^[\t\r\n ]*$/.test(D)?A.options.initialContent:D.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");B.className&&(F.className=B.className);B.style.cssText&&(F.style.cssText=B.style.cssText);if(/textarea/i.test(B.tagName)){A.textarea=B;A.textarea.style.display="none";}else{B.parentNode.removeChild(B);B.id&&(F.id=B.id);}B=F;B.innerHTML="";}}r.addClass(B,"edui-"+A.options.theme);A.ui.render(B);var E=A.ui.getDom("iframeholder");A.container=A.ui.getDom();var G=A.options.initialFrameWidth;if(!/%/g.test(G)){G+="px";}A.container.style.cssText="z-index:"+A.options.zIndex+";width:"+G;z.call(A,E);}});};return A;};UE.getEditor=function(A,y){var z=x[A];if(!z){z=x[A]=new UE.ui.Editor(y);z.render(A);}return z;};UE.delEditor=function(z){var y;if(y=x[z]){y.key&&y.destroy();delete x[z];}};})();(function(){var t=c.editor.utils,u=c.editor.ui.Popup,s=c.editor.ui.SplitButton,r=c.editor.ui.MultiMenuPop=function(v){this.initOptions(v);this.initMultiMenu();};r.prototype={initMultiMenu:function(){var v=this;this.popup=new u({content:"",editor:v.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+v.id+'_iframe" src="'+v.iframeUrl+'" frameborder="0"></iframe>';v.editor.container.style.zIndex&&(this.getDom().style.zIndex=v.editor.container.style.zIndex*1+1);}}});this.onbuttonclick=function(){this.showPopup();};this.initSplitButton();}};t.inherits(r,s);})();})();